<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PharmaFlow - Pharmacy Management System</title>
    <link rel="stylesheet" href="css/styles.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style id="auth-styles">
        .app-container { opacity: 0; }
        .auth-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(70, 130, 180, 0.1);
            backdrop-filter: blur(8px);
            -webkit-backdrop-filter: blur(8px);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 99999;
            transition: opacity 0.2s ease;
        }
        .auth-overlay.fade-out { opacity: 0; }
        .auth-spinner {
            width: 36px;
            height: 36px;
            border: 3px solid rgba(70, 130, 180, 0.3);
            border-top-color: #4682b4;
            border-radius: 50%;
            animation: auth-spin 0.7s linear infinite;
        }
        @keyframes auth-spin { to { transform: rotate(360deg); } }
        .app-container.ready { opacity: 1; transition: opacity 0.15s ease; }
    </style>
    <!-- JsBarcode Library for barcode generation -->
    <script src="https://cdn.jsdelivr.net/npm/jsbarcode@3.11.5/dist/JsBarcode.all.min.js"></script>
    <!-- SheetJS Library for Excel file parsing -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <!-- jsPDF Library for PDF generation -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <!-- jsPDF AutoTable plugin for tables in PDF -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.31/jspdf.plugin.autotable.min.js"></script>
    <!-- Auth Check Script -->
    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.0/firebase-app.js";
        import { getAuth, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/10.7.0/firebase-auth.js";
        
        const firebaseConfig = {
            apiKey: "AIzaSyB88Ttg2c9HMn1k3Me1KHtuTscYKUP4Wys",
            authDomain: "pharmaflow-8481d.firebaseapp.com",
            databaseURL: "https://pharmaflow-8481d-default-rtdb.firebaseio.com",
            projectId: "pharmaflow-8481d",
            storageBucket: "pharmaflow-8481d.firebasestorage.app",
            messagingSenderId: "327113671676",
            appId: "1:327113671676:web:da7b674de0c5b9f9a4a879",
            measurementId: "G-37H0CBXGEX"
        };
        
        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);
        
        onAuthStateChanged(auth, (user) => {
            const overlay = document.getElementById('authOverlay');
            const appContainer = document.querySelector('.app-container');
            
            if (!user) {
                window.location.replace('login.html');
            } else {
                // Quick fade out overlay and show dashboard
                if (overlay) {
                    overlay.classList.add('fade-out');
                    setTimeout(() => overlay.remove(), 200);
                }
                if (appContainer) appContainer.classList.add('ready');
            }
        });
    </script>
</head>
<body>
    <!-- Loading overlay -->
    <div class="auth-overlay" id="authOverlay">
        <div class="auth-spinner"></div>
    </div>
    
    <div class="app-container">
        <!-- Sidebar -->
        <aside class="sidebar" id="sidebar">
            <div class="sidebar-header">
                <div class="logo">
                    <i class="fas fa-pills"></i>
                    <span class="logo-text">PharmaFlow</span>
                </div>
            </div>
            
            <nav class="sidebar-nav">
                <ul class="nav-list">
                    <li class="nav-item">
                        <a href="#" class="nav-link active" data-module="dashboard">
                            <i class="fas fa-tachometer-alt"></i>
                            <span class="nav-text">Dashboard</span>
                        </a>
                    </li>
                    <li class="nav-item has-submenu">
                        <a href="#" class="nav-link" data-module="pharmacy">
                            <i class="fas fa-clinic-medical"></i>
                            <span class="nav-text">Pharmacy</span>
                            <i class="fas fa-chevron-down submenu-arrow"></i>
                        </a>
                        <ul class="submenu">
                            <li class="submenu-item">
                                <a href="#" class="submenu-link" data-module="pharmacy-pos">
                                    <i class="fas fa-cash-register"></i>
                                    <span>POS</span>
                                </a>
                            </li>
                            <li class="submenu-item">
                                <a href="#" class="submenu-link" data-module="pharmacy-sales">
                                    <i class="fas fa-receipt"></i>
                                    <span>Today's Sales</span>
                                </a>
                            </li>
                        </ul>
                    </li>
                    <li class="nav-item">
                        <a href="#" class="nav-link" data-module="all-sales">
                            <i class="fas fa-chart-line"></i>
                            <span class="nav-text">All Sales</span>
                        </a>
                    </li>
                    <li class="nav-item">
                        <a href="#" class="nav-link" data-module="prescription-generate">
                            <i class="fas fa-prescription"></i>
                            <span class="nav-text">Prescription</span>
                        </a>
                    </li>
                    <li class="nav-item has-submenu">
                        <a href="#" class="nav-link" data-module="inventory">
                            <i class="fas fa-boxes"></i>
                            <span class="nav-text">Inventory</span>
                            <i class="fas fa-chevron-down submenu-arrow"></i>
                        </a>
                        <ul class="submenu">
                            <li class="submenu-item">
                                <a href="#" class="submenu-link" data-module="inventory-view">
                                    <i class="fas fa-list"></i>
                                    <span>View Inventory</span>
                                </a>
                            </li>
                            <li class="submenu-item">
                                <a href="#" class="submenu-link" data-module="inventory-add">
                                    <i class="fas fa-plus-circle"></i>
                                    <span>Add Inventory</span>
                                </a>
                            </li>
                        </ul>
                    </li>
                    <li class="nav-item has-submenu">
                        <a href="#" class="nav-link" data-module="orders">
                            <i class="fas fa-shopping-cart"></i>
                            <span class="nav-text">My Orders</span>
                            <i class="fas fa-chevron-down submenu-arrow"></i>
                        </a>
                        <ul class="submenu">
                            <li class="submenu-item">
                                <a href="#" class="submenu-link" data-module="orders-create">
                                    <i class="fas fa-plus"></i>
                                    <span>Create Order</span>
                                </a>
                            </li>
                            <li class="submenu-item">
                                <a href="#" class="submenu-link" data-module="orders-view">
                                    <i class="fas fa-list-alt"></i>
                                    <span>Manage Orders</span>
                                </a>
                            </li>
                            <li class="submenu-item">
                                <a href="#" class="submenu-link" data-module="orders-supplier">
                                    <i class="fas fa-truck"></i>
                                    <span>Supplier</span>
                                </a>
                            </li>
                        </ul>
                    </li>
                    <li class="nav-item has-submenu">
                        <a href="#" class="nav-link" data-module="wholesale">
                            <i class="fas fa-warehouse"></i>
                            <span class="nav-text">Wholesale</span>
                            <i class="fas fa-chevron-down submenu-arrow"></i>
                        </a>
                        <ul class="submenu">
                            <li class="submenu-item">
                                <a href="#" class="submenu-link" data-module="wholesale-create">
                                    <i class="fas fa-plus"></i>
                                    <span>Create Wholesale</span>
                                </a>
                            </li>
                            <li class="submenu-item">
                                <a href="#" class="submenu-link" data-module="wholesale-manage">
                                    <i class="fas fa-tasks"></i>
                                    <span>Manage Wholesale</span>
                                </a>
                            </li>
                        </ul>
                    </li>
                    <li class="nav-item has-submenu">
                        <a href="#" class="nav-link" data-module="customers">
                            <i class="fas fa-users"></i>
                            <span class="nav-text">Customers</span>
                            <i class="fas fa-chevron-down submenu-arrow"></i>
                        </a>
                        <ul class="submenu">
                            <li class="submenu-item">
                                <a href="#" class="submenu-link" data-module="customers-add">
                                    <i class="fas fa-user-plus"></i>
                                    <span>Add Customer</span>
                                </a>
                            </li>
                            <li class="submenu-item">
                                <a href="#" class="submenu-link" data-module="customers-manage">
                                    <i class="fas fa-users-cog"></i>
                                    <span>Manage Customers</span>
                                </a>
                            </li>
                        </ul>
                    </li>
                    <li class="nav-item has-submenu">
                        <a href="#" class="nav-link" data-module="expenses">
                            <i class="fas fa-money-bill-wave"></i>
                            <span class="nav-text">Expenses</span>
                            <i class="fas fa-chevron-down submenu-arrow"></i>
                        </a>
                        <ul class="submenu">
                            <li class="submenu-item">
                                <a href="#" class="submenu-link" data-module="expenses-add">
                                    <i class="fas fa-plus-circle"></i>
                                    <span>Add Expense</span>
                                </a>
                            </li>
                            <li class="submenu-item">
                                <a href="#" class="submenu-link" data-module="expenses-manage">
                                    <i class="fas fa-file-invoice-dollar"></i>
                                    <span>Manage Expenses</span>
                                </a>
                            </li>
                        </ul>
                    </li>
                    <li class="nav-item has-submenu">
                        <a href="#" class="nav-link" data-module="reports">
                            <i class="fas fa-chart-bar"></i>
                            <span class="nav-text">Reports</span>
                            <i class="fas fa-chevron-down submenu-arrow"></i>
                        </a>
                        <ul class="submenu">
                            <li class="submenu-item">
                                <a href="#" class="submenu-link" data-module="reports-generate">
                                    <i class="fas fa-file-export"></i>
                                    <span>Generate Report</span>
                                </a>
                            </li>
                            <li class="submenu-item">
                                <a href="#" class="submenu-link" data-module="reports-accounts">
                                    <i class="fas fa-calculator"></i>
                                    <span>Accounts</span>
                                </a>
                            </li>
                        </ul>
                    </li>
                    <li class="nav-item has-submenu">
                        <a href="#" class="nav-link" data-module="admin-menu">
                            <i class="fas fa-user-shield"></i>
                            <span class="nav-text">Admin Panel</span>
                            <i class="fas fa-chevron-down submenu-arrow"></i>
                        </a>
                        <ul class="submenu">
                            <li class="submenu-item">
                                <a href="#" class="submenu-link" data-module="admin">
                                    <i class="fas fa-tachometer-alt"></i>
                                    <span>Admin Dashboard</span>
                                </a>
                            </li>
                            <li class="submenu-item">
                                <a href="#" class="submenu-link" data-module="admin-users">
                                    <i class="fas fa-users-cog"></i>
                                    <span>Manage Users</span>
                                </a>
                            </li>
                        </ul>
                    </li>
                </ul>
            </nav>
            
            <div class="sidebar-footer">
                <a href="#" class="nav-link" data-module="settings">
                    <i class="fas fa-cog"></i>
                    <span class="nav-text">Settings</span>
                </a>
            </div>
        </aside>

        <!-- Main Content Area -->
        <div class="main-wrapper">
            <!-- Top Bar -->
            <header class="topbar">
                <div class="topbar-left">
                    <button class="sidebar-toggle" id="sidebarToggle">
                        <i class="fas fa-bars"></i>
                    </button>
                    <div class="topbar-logo">
                        <i class="fas fa-pills"></i>
                        <span>PharmaFlow</span>
                    </div>
                </div>
                
                <div class="topbar-right">
                    <!-- Theme Toggle -->
                    <button class="topbar-btn theme-toggle" id="themeToggle" title="Toggle Theme">
                        <i class="fas fa-moon"></i>
                    </button>
                    
                    <!-- Notifications -->
                    <div class="notification-wrapper">
                        <button class="topbar-btn notification-btn" id="notificationBtn">
                            <i class="fas fa-bell"></i>
                            <span class="notification-badge" style="display: none;">0</span>
                        </button>
                        <div class="notification-dropdown" id="notificationDropdown">
                            <div class="dropdown-header">
                                <h4>Notifications</h4>
                                <span class="mark-read">Mark all as read</span>
                            </div>
                            <div class="dropdown-body">
                                <div class="notification-empty">
                                    <i class="fas fa-bell-slash"></i>
                                    <p>No notifications</p>
                                </div>
                            </div>
                            <div class="dropdown-footer">
                                <a href="#">View all notifications</a>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Messages -->
                    <div class="message-wrapper">
                        <button class="topbar-btn message-btn" id="messageBtn" title="Messages">
                            <i class="fas fa-envelope"></i>
                            <span class="message-badge" id="messageBadge" style="display: none;">0</span>
                        </button>
                        <div class="message-dropdown" id="messageDropdown">
                            <div class="dropdown-header">
                                <h4>Messages</h4>
                                <div class="message-header-actions">
                                    <button class="msg-action-btn" id="clearMessagesBtn" title="Clear All">
                                        <i class="fas fa-trash-alt"></i>
                                    </button>
                                    <button class="msg-action-btn msg-compose-btn" id="composeMessageBtn" title="Compose">
                                        <i class="fas fa-edit"></i>
                                    </button>
                                </div>
                            </div>
                            <div class="dropdown-body" id="messageList">
                                <div class="message-empty">
                                    <i class="fas fa-comments"></i>
                                    <p>No messages yet</p>
                                </div>
                            </div>
                            <div class="dropdown-footer">
                                <a href="#" id="viewAllMessages">View all messages</a>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Profile -->
                    <div class="profile-wrapper">
                        <button class="profile-btn" id="profileBtn">
                            <div class="profile-avatar has-image">
                                <img src="https://ui-avatars.com/api/?name=Admin&background=667eea&color=fff&size=128" alt="Profile">
                            </div>
                            <span class="profile-name">Admin</span>
                            <i class="fas fa-chevron-down"></i>
                        </button>
                        <div class="profile-dropdown" id="profileDropdown">
                            <div class="dropdown-header">
                                <div class="profile-info">
                                    <div class="profile-avatar large has-image">
                                        <img src="https://ui-avatars.com/api/?name=Admin&background=667eea&color=fff&size=128" alt="Profile">
                                    </div>
                                    <div>
                                        <h4>Administrator</h4>
                                        <p>admin@pharmaflow.com</p>
                                    </div>
                                </div>
                            </div>
                            <div class="dropdown-body">
                                <a href="#" class="dropdown-item" onclick="openSettings('profile'); return false;">
                                    <i class="fas fa-user-circle"></i>
                                    <span>My Profile</span>
                                </a>
                                <a href="#" class="dropdown-item" onclick="openSettings('account'); return false;">
                                    <i class="fas fa-cog"></i>
                                    <span>Account Settings</span>
                                </a>
                                <a href="#" class="dropdown-item" onclick="openSettings('security'); return false;">
                                    <i class="fas fa-key"></i>
                                    <span>Change Password</span>
                                </a>
                            </div>
                            <div class="dropdown-footer">
                                <a href="#" class="dropdown-item logout">
                                    <i class="fas fa-sign-out-alt"></i>
                                    <span>Logout</span>
                                </a>
                            </div>
                        </div>
                    </div>
                </div>
            </header>

            <!-- Main Content -->
            <main class="main-content">
                <!-- Dashboard Module -->
                <div class="module-content active" id="module-dashboard">
                    <div class="module-header">
                        <div class="module-header-content">
                            <div class="dashboard-header-left">
                                <h1>Dashboard</h1>
                                <div class="branch-selector-container" id="branchSelectorContainer" style="display: none;">
                                    <div class="branch-selector">
                                        <i class="fas fa-building"></i>
                                        <select id="dashboardBranchSelect" onchange="PharmaFlowDashboard.changeBranch(this.value)">
                                            <option value="all">All Branches</option>
                                        </select>
                                    </div>
                                </div>
                            </div>
                            <div class="dashboard-controls">
                                <div class="global-search-container">
                                    <div class="search-bar">
                                        <i class="fas fa-search"></i>
                                        <input type="text" id="dashboardSearch" placeholder="Global search: inventory, sales, customers, orders..." autocomplete="off">
                                        <button class="search-clear-btn" id="clearGlobalSearch" style="display: none;">
                                            <i class="fas fa-times"></i>
                                        </button>
                                    </div>
                                    <div class="global-search-results" id="globalSearchResults" style="display: none;">
                                        <div class="search-results-loading" id="searchResultsLoading" style="display: none;">
                                            <i class="fas fa-spinner fa-spin"></i>
                                            <span>Searching...</span>
                                        </div>
                                        <div class="search-results-empty" id="searchResultsEmpty" style="display: none;">
                                            <i class="fas fa-search"></i>
                                            <span>No results found</span>
                                        </div>
                                        <div class="search-results-content" id="searchResultsContent"></div>
                                    </div>
                                </div>
                                <button class="refresh-btn" id="refreshDashboard" title="Refresh all modules">
                                    <i class="fas fa-sync-alt"></i>
                                    <span>Refresh All</span>
                                </button>
                            </div>
                        </div>
                    </div>
                    <div class="module-body">

                        <!-- Dashboard Stats Grid -->
                        <div class="dashboard-stats-grid">
                            <!-- Total Sales Today -->
                            <div class="stat-card" data-stat="sales-today">
                                <div class="stat-icon success">
                                    <i class="fas fa-cash-register"></i>
                                </div>
                                <div class="stat-details">
                                    <h3 class="stat-value" id="salesToday">KSH 0.00</h3>
                                    <p class="stat-label">Total Sales Today</p>
                                </div>
                            </div>

                            <!-- Overall Sales -->
                            <div class="stat-card" data-stat="overall-sales">
                                <div class="stat-icon primary">
                                    <i class="fas fa-chart-line"></i>
                                </div>
                                <div class="stat-details">
                                    <h3 class="stat-value" id="overallSales">KSH 0.00</h3>
                                    <p class="stat-label">Overall Sales</p>
                                </div>
                            </div>

                            <!-- Total Expenses Today -->
                            <div class="stat-card" data-stat="expenses-today">
                                <div class="stat-icon danger">
                                    <i class="fas fa-money-bill-wave"></i>
                                </div>
                                <div class="stat-details">
                                    <h3 class="stat-value" id="expensesToday">KSH 0.00</h3>
                                    <p class="stat-label">Total Expenses Today</p>
                                </div>
                            </div>

                            <!-- Out of Stock Items -->
                            <div class="stat-card" data-stat="out-of-stock">
                                <div class="stat-icon warning">
                                    <i class="fas fa-exclamation-triangle"></i>
                                </div>
                                <div class="stat-details">
                                    <h3 class="stat-value" id="outOfStock">0</h3>
                                    <p class="stat-label">Out of Stock Items</p>
                                </div>
                            </div>

                            <!-- Items Expiring Soon -->
                            <div class="stat-card" data-stat="expiring-soon">
                                <div class="stat-icon danger">
                                    <i class="fas fa-calendar-times"></i>
                                </div>
                                <div class="stat-details">
                                    <h3 class="stat-value" id="expiringSoon">0</h3>
                                    <p class="stat-label">Items Expiring Soon</p>
                                </div>
                            </div>

                            <!-- Bulk Sales Today -->
                            <div class="stat-card" data-stat="bulk-sales">
                                <div class="stat-icon purple">
                                    <i class="fas fa-cubes"></i>
                                </div>
                                <div class="stat-details">
                                    <h3 class="stat-value" id="bulkSales">KSH 0.00</h3>
                                    <p class="stat-label">Bulk Sales Today</p>
                                </div>
                            </div>

                            <!-- Total Customers -->
                            <div class="stat-card" data-stat="total-customers">
                                <div class="stat-icon primary">
                                    <i class="fas fa-users"></i>
                                </div>
                                <div class="stat-details">
                                    <h3 class="stat-value" id="totalCustomers">0</h3>
                                    <p class="stat-label">Total Customers</p>
                                </div>
                            </div>

                            <!-- Total Inventory Value -->
                            <div class="stat-card" data-stat="inventory-value">
                                <div class="stat-icon success">
                                    <i class="fas fa-warehouse"></i>
                                </div>
                                <div class="stat-details">
                                    <h3 class="stat-value" id="inventoryValue">KSH 0.00</h3>
                                    <p class="stat-label">Total Inventory Value</p>
                                </div>
                            </div>
                        </div>

                        <!-- Quick Actions -->
                        <div class="quick-actions">
                            <button class="quick-action-btn btn-green" data-module="pharmacy-pos">
                                <i class="fas fa-shopping-cart"></i>
                                <span>New Sale</span>
                            </button>
                            <button class="quick-action-btn btn-blue" data-module="inventory-add">
                                <i class="fas fa-plus-circle"></i>
                                <span>Add Item</span>
                            </button>
                            <button class="quick-action-btn btn-orange" data-module="orders-create">
                                <i class="fas fa-clipboard-list"></i>
                                <span>Create Order</span>
                            </button>
                            <button class="quick-action-btn btn-purple" data-module="customers-add">
                                <i class="fas fa-user-plus"></i>
                                <span>Add Customer</span>
                            </button>
                            <button class="quick-action-btn btn-red" data-module="expenses-add">
                                <i class="fas fa-receipt"></i>
                                <span>Add Expense</span>
                            </button>
                            <button class="quick-action-btn btn-teal" data-module="reports-generate">
                                <i class="fas fa-chart-bar"></i>
                                <span>Generate Report</span>
                            </button>
                        </div>

                        <!-- Recent Activities -->
                        <div class="recent-activities">
                            <div class="section-header">
                                <h2>Recent Activities</h2>
                                <button class="view-all-btn" data-module="all-activities">
                                    <span>View All</span>
                                    <i class="fas fa-arrow-right"></i>
                                </button>
                            </div>
                            <div class="activities-table-wrapper">
                                <table class="activities-table">
                                    <thead>
                                        <tr>
                                            <th>Time</th>
                                            <th>Activity</th>
                                            <th>User</th>
                                            <th>Amount</th>
                                            <th>Status</th>
                                        </tr>
                                    </thead>
                                    <tbody id="activitiesTableBody">
                                        <!-- Activities will be populated here -->
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Pharmacy Module -->
                <div class="module-content" id="module-pharmacy">
                    <div class="module-header">
                        <h1>Pharmacy</h1>
                        <p>Manage pharmacy operations and medicines</p>
                    </div>
                    <div class="module-body">
                        <div class="placeholder-content">
                            <i class="fas fa-clinic-medical"></i>
                            <h2>Pharmacy Module</h2>
                            <p>This module is ready for future implementation.</p>
                        </div>
                    </div>
                </div>

                <!-- Pharmacy POS Module -->
                <div class="module-content" id="module-pharmacy-pos">
                    <div class="pos-container">
                        <!-- Left Section: Search & Cart -->
                        <div class="pos-left">
                            <!-- Search Section -->
                            <div class="pos-search-section">
                                <div class="pos-search-bar">
                                    <i class="fas fa-search"></i>
                                    <input type="text" id="posSearchInput" placeholder="Search inventory by name, barcode, or category..." autocomplete="off">
                                    <div class="pos-search-actions">
                                        <button class="pos-action-btn" id="posScannerBtn" title="Scan Barcode">
                                            <i class="fas fa-barcode"></i>
                                        </button>
                                        <button class="pos-action-btn" id="posManualAddBtn" title="Manual Entry">
                                            <i class="fas fa-plus"></i>
                                        </button>
                                    </div>
                                </div>
                                <!-- Search Results Dropdown -->
                                <div class="pos-search-results" id="posSearchResults">
                                    <!-- Results populated dynamically -->
                                </div>
                            </div>

                            <!-- Cart Section -->
                            <div class="pos-cart-section">
                                <div class="pos-cart-header">
                                    <h3><i class="fas fa-shopping-cart"></i> Cart Items</h3>
                                    <button class="pos-clear-cart-btn" id="posClearCartBtn">
                                        <i class="fas fa-trash-alt"></i> Clear
                                    </button>
                                </div>
                                <div class="pos-cart-table-wrapper">
                                    <table class="pos-cart-table">
                                        <thead>
                                            <tr>
                                                <th>Item</th>
                                                <th>Price</th>
                                                <th>Qty</th>
                                                <th>Total</th>
                                                <th></th>
                                            </tr>
                                        </thead>
                                        <tbody id="posCartBody">
                                            <!-- Cart items populated dynamically -->
                                        </tbody>
                                    </table>
                                </div>
                                <div class="pos-cart-empty" id="posCartEmpty">
                                    <i class="fas fa-cart-plus"></i>
                                    <p>Cart is empty</p>
                                    <span>Search and add items to begin</span>
                                </div>
                            </div>
                        </div>

                        <!-- Right Section: Checkout -->
                        <div class="pos-right">
                            <div class="pos-checkout-section">
                                <div class="pos-checkout-header">
                                    <h3><i class="fas fa-calculator"></i> Order Summary</h3>
                                    <button class="pos-view-sales-btn" id="posViewAllSalesBtn">
                                        <i class="fas fa-receipt"></i> View All Sales
                                    </button>
                                </div>

                                <!-- Calculation Summary -->
                                <div class="pos-summary">
                                    <div class="pos-summary-row">
                                        <span>Subtotal</span>
                                        <span id="posSubtotal">KSH 0.00</span>
                                    </div>
                                    <div class="pos-summary-row pos-input-row">
                                        <label for="posDiscount">Discount (KSH)</label>
                                        <input type="number" id="posDiscount" value="0" min="0" step="0.01">
                                    </div>
                                    <div class="pos-summary-row pos-input-row">
                                        <label for="posTax">Tax (%)</label>
                                        <input type="number" id="posTax" value="0" min="0" max="100" step="0.01">
                                    </div>
                                    <div class="pos-summary-row">
                                        <span>Tax Amount</span>
                                        <span id="posTaxAmount">KSH 0.00</span>
                                    </div>
                                    <div class="pos-summary-row pos-total">
                                        <span>Grand Total</span>
                                        <span id="posGrandTotal">KSH 0.00</span>
                                    </div>
                                </div>

                                <!-- Payment Section -->
                                <div class="pos-payment-section">
                                    <h4><i class="fas fa-money-bill-wave"></i> Payment</h4>
                                    <div class="pos-payment-methods">
                                        <button class="pos-payment-method active" data-method="cash">
                                            <i class="fas fa-coins"></i> Cash
                                        </button>
                                        <button class="pos-payment-method" data-method="mpesa">
                                            <i class="fas fa-mobile-alt"></i> M-Pesa
                                        </button>
                                        <button class="pos-payment-method" data-method="card">
                                            <i class="fas fa-credit-card"></i> Card
                                        </button>
                                    </div>

                                    <div class="pos-tendered-section" id="posTenderedSection">
                                        <div class="pos-input-group">
                                            <label for="posAmountTendered">Amount Tendered (KSH)</label>
                                            <input type="number" id="posAmountTendered" value="0" min="0" step="0.01">
                                        </div>
                                        <div class="pos-change-display">
                                            <span>Change</span>
                                            <span id="posChange" class="pos-change-amount">KSH 0.00</span>
                                        </div>
                                    </div>
                                </div>

                                <!-- Customer Section -->
                                <div class="pos-customer-section">
                                    <div class="pos-input-group">
                                        <label for="posCustomer"><i class="fas fa-user"></i> Customer (Optional)</label>
                                        <input type="text" id="posCustomer" placeholder="Walk-in Customer">
                                    </div>
                                </div>

                                <!-- Action Buttons -->
                                <div class="pos-checkout-actions">
                                    <button class="pos-hold-btn" id="posHoldBtn">
                                        <i class="fas fa-pause"></i> Hold
                                    </button>
                                    <button class="pos-checkout-btn" id="posCheckoutBtn">
                                        <i class="fas fa-check-circle"></i> Complete Sale
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Manual Entry Modal -->
                    <div class="pos-modal" id="posManualEntryModal">
                        <div class="pos-modal-content">
                            <div class="pos-modal-header">
                                <h3><i class="fas fa-plus-circle"></i> Add Item Manually</h3>
                                <button class="pos-modal-close" id="posManualEntryClose">&times;</button>
                            </div>
                            <div class="pos-modal-body">
                                <div class="pos-form-group">
                                    <label for="manualItemName">Item Name *</label>
                                    <input type="text" id="manualItemName" placeholder="Enter item name">
                                </div>
                                <div class="pos-form-row">
                                    <div class="pos-form-group">
                                        <label for="manualItemCostPrice">Cost Price (KSH) *</label>
                                        <input type="number" id="manualItemCostPrice" placeholder="0.00" min="0" step="0.01">
                                    </div>
                                    <div class="pos-form-group">
                                        <label for="manualItemPrice">Selling Price (KSH) *</label>
                                        <input type="number" id="manualItemPrice" placeholder="0.00" min="0" step="0.01">
                                    </div>
                                </div>
                                <div class="pos-form-row">
                                    <div class="pos-form-group">
                                        <label for="manualItemQty">Quantity *</label>
                                        <input type="number" id="manualItemQty" value="1" min="1">
                                    </div>
                                    <div class="pos-form-group">
                                        <label>Profit per Unit</label>
                                        <div class="profit-display" id="manualItemProfit">KSH 0.00</div>
                                    </div>
                                </div>
                            </div>
                            <div class="pos-modal-footer">
                                <button class="pos-modal-cancel" id="posManualEntryCancel">Cancel</button>
                                <button class="pos-modal-add" id="posManualEntryAdd">Add to Cart</button>
                            </div>
                        </div>
                    </div>

                    <!-- Scanner Modal -->
                    <div class="pos-modal" id="posScannerModal">
                        <div class="pos-modal-content">
                            <div class="pos-modal-header">
                                <h3><i class="fas fa-barcode"></i> Barcode Scanner</h3>
                                <button class="pos-modal-close" id="posScannerClose">&times;</button>
                            </div>
                            <div class="pos-modal-body">
                                <div class="pos-scanner-input">
                                    <input type="text" id="posBarcodeInput" placeholder="Scan or enter barcode..." autofocus>
                                    <p class="pos-scanner-hint">Position barcode in front of scanner or type manually</p>
                                </div>
                            </div>
                            <div class="pos-modal-footer">
                                <button class="pos-modal-cancel" id="posScannerCancel">Close</button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Pharmacy All Sales Module -->
                <div class="module-content" id="module-pharmacy-sales">
                    <div class="module-header">
                        <div class="module-header-content">
                            <div>
                                <h1>Today's Sales</h1>
                                <p>View and manage today's sales in real-time</p>
                            </div>
                            <div class="sales-header-actions">
                                <button class="btn-add-sale" id="btnAddSale" data-module="pharmacy-pos">
                                    <i class="fas fa-cash-register"></i>
                                    <span>Go to POS</span>
                                </button>
                            </div>
                        </div>
                    </div>
                    <div class="module-body">
                        <!-- Sales Stats Cards -->
                        <div class="sales-stats-grid">
                            <div class="sales-stat-card">
                                <div class="sales-stat-icon today">
                                    <i class="fas fa-shopping-cart"></i>
                                </div>
                                <div class="sales-stat-info">
                                    <span class="sales-stat-label">Total Sales</span>
                                    <h3 class="sales-stat-value" id="salesTodayCount">0</h3>
                                </div>
                            </div>
                            <div class="sales-stat-card">
                                <div class="sales-stat-icon revenue">
                                    <i class="fas fa-coins"></i>
                                </div>
                                <div class="sales-stat-info">
                                    <span class="sales-stat-label">Total Revenue</span>
                                    <h3 class="sales-stat-value" id="revenueTodayAmount">KSH 0.00</h3>
                                </div>
                            </div>
                            <div class="sales-stat-card">
                                <div class="sales-stat-icon profit">
                                    <i class="fas fa-chart-line"></i>
                                </div>
                                <div class="sales-stat-info">
                                    <span class="sales-stat-label">Total Profit</span>
                                    <h3 class="sales-stat-value" id="profitTodayAmount">KSH 0.00</h3>
                                </div>
                            </div>
                            <div class="sales-stat-card">
                                <div class="sales-stat-icon all-sales">
                                    <i class="fas fa-credit-card"></i>
                                </div>
                                <div class="sales-stat-info">
                                    <span class="sales-stat-label">Cash Sales</span>
                                    <h3 class="sales-stat-value" id="cashSalesCount">0</h3>
                                </div>
                            </div>
                            <div class="sales-stat-card">
                                <div class="sales-stat-icon total-revenue">
                                    <i class="fas fa-mobile-alt"></i>
                                </div>
                                <div class="sales-stat-info">
                                    <span class="sales-stat-label">M-Pesa Sales</span>
                                    <h3 class="sales-stat-value" id="mpesaSalesCount">0</h3>
                                </div>
                            </div>
                        </div>

                        <!-- Sales Table Section -->
                        <div class="sales-table-section">
                            <div class="sales-table-header">
                                <div class="sales-table-title">
                                    <h3><i class="fas fa-list"></i> Sales Today</h3>
                                </div>
                                <div class="sales-table-filters">
                                    <div class="sales-search-box">
                                        <i class="fas fa-search"></i>
                                        <input type="text" id="salesSearchInput" placeholder="Search by receipt, customer, or item...">
                                    </div>
                                    <div class="sales-filter-group">
                                        <select id="salesFilterPayment" class="sales-filter-select">
                                            <option value="all">All Payments</option>
                                            <option value="cash">Cash</option>
                                            <option value="mpesa">M-Pesa</option>
                                            <option value="card">Card</option>
                                        </select>
                                        <select id="salesFilterStatus" class="sales-filter-select">
                                            <option value="all">All Status</option>
                                            <option value="completed">Completed</option>
                                            <option value="pending">Pending</option>
                                            <option value="cancelled">Cancelled</option>
                                        </select>
                                    </div>
                                </div>
                            </div>
                            <div class="sales-table-wrapper">
                                <table class="sales-table" id="salesTable">
                                    <thead>
                                        <tr>
                                            <th>Receipt #</th>
                                            <th>Date & Time</th>
                                            <th>Customer</th>
                                            <th>Items</th>
                                            <th>Payment</th>
                                            <th>Total</th>
                                            <th>Status</th>
                                            <th>Actions</th>
                                        </tr>
                                    </thead>
                                    <tbody id="salesTableBody">
                                        <!-- Sales rows populated dynamically -->
                                    </tbody>
                                </table>
                            </div>
                            <div class="sales-table-empty" id="salesTableEmpty">
                                <i class="fas fa-receipt"></i>
                                <h3>No Sales Today</h3>
                                <p>Sales will appear here in real-time as they are made</p>
                            </div>
                            <div class="sales-table-loading" id="salesTableLoading">
                                <i class="fas fa-spinner fa-spin"></i>
                                <p>Loading sales...</p>
                            </div>
                        </div>
                    </div>

                    <!-- View Sale Details Modal -->
                    <div class="sales-modal" id="viewSaleModal">
                        <div class="sales-modal-content sale-details-modal">
                            <div class="sales-modal-header">
                                <h3><i class="fas fa-receipt"></i> Sale Details</h3>
                                <button class="sales-modal-close" id="closeViewSaleModal">&times;</button>
                            </div>
                            <div class="sales-modal-body" id="saleDetailsContent">
                                <!-- Sale details populated dynamically -->
                            </div>
                            <div class="sales-modal-footer">
                                <button class="btn-print-receipt" id="btnPrintReceipt">
                                    <i class="fas fa-print"></i> Print Receipt
                                </button>
                                <button class="btn-close-details" id="btnCloseDetails">Close</button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- All Sales Module -->
                <div class="module-content" id="module-all-sales">
                    <div class="module-header">
                        <div class="module-header-content">
                            <div>
                                <h1>All Sales</h1>
                                <p>Complete sales history and analytics</p>
                            </div>
                            <div class="sales-header-actions">
                                <button class="btn-export-sales" id="btnExportAllSales">
                                    <i class="fas fa-file-export"></i>
                                    <span>Export</span>
                                </button>
                            </div>
                        </div>
                    </div>
                    <div class="module-body">
                        <!-- All Sales Stats Cards -->
                        <div class="sales-stats-grid">
                            <div class="sales-stat-card">
                                <div class="sales-stat-icon today">
                                    <i class="fas fa-shopping-cart"></i>
                                </div>
                                <div class="sales-stat-info">
                                    <span class="sales-stat-label">Total Sales</span>
                                    <h3 class="sales-stat-value" id="allSalesTotalCount">0</h3>
                                </div>
                            </div>
                            <div class="sales-stat-card">
                                <div class="sales-stat-icon revenue">
                                    <i class="fas fa-coins"></i>
                                </div>
                                <div class="sales-stat-info">
                                    <span class="sales-stat-label">Total Revenue</span>
                                    <h3 class="sales-stat-value" id="allSalesRevenueAmount">KSH 0.00</h3>
                                </div>
                            </div>
                            <div class="sales-stat-card">
                                <div class="sales-stat-icon profit">
                                    <i class="fas fa-chart-line"></i>
                                </div>
                                <div class="sales-stat-info">
                                    <span class="sales-stat-label">Total Profit</span>
                                    <h3 class="sales-stat-value" id="allSalesProfitAmount">KSH 0.00</h3>
                                </div>
                            </div>
                            <div class="sales-stat-card">
                                <div class="sales-stat-icon all-sales">
                                    <i class="fas fa-credit-card"></i>
                                </div>
                                <div class="sales-stat-info">
                                    <span class="sales-stat-label">Cash Sales</span>
                                    <h3 class="sales-stat-value" id="allCashSalesCount">0</h3>
                                </div>
                            </div>
                            <div class="sales-stat-card">
                                <div class="sales-stat-icon total-revenue">
                                    <i class="fas fa-mobile-alt"></i>
                                </div>
                                <div class="sales-stat-info">
                                    <span class="sales-stat-label">M-Pesa Sales</span>
                                    <h3 class="sales-stat-value" id="allMpesaSalesCount">0</h3>
                                </div>
                            </div>
                        </div>

                        <!-- All Sales Table Section -->
                        <div class="sales-table-section">
                            <div class="sales-table-header">
                                <div class="sales-table-title">
                                    <h3><i class="fas fa-history"></i> Sales History</h3>
                                </div>
                                <div class="sales-table-filters">
                                    <div class="sales-search-box">
                                        <i class="fas fa-search"></i>
                                        <input type="text" id="allSalesSearchInput" placeholder="Search by receipt, customer, or item...">
                                    </div>
                                    <div class="sales-filter-group">
                                        <select id="allSalesFilterDate" class="sales-filter-select">
                                            <option value="all">All Time</option>
                                            <option value="today">Today</option>
                                            <option value="yesterday">Yesterday</option>
                                            <option value="week">This Week</option>
                                            <option value="month">This Month</option>
                                            <option value="year">This Year</option>
                                        </select>
                                        <select id="allSalesFilterPayment" class="sales-filter-select">
                                            <option value="all">All Payments</option>
                                            <option value="cash">Cash</option>
                                            <option value="mpesa">M-Pesa</option>
                                            <option value="card">Card</option>
                                        </select>
                                        <select id="allSalesFilterStatus" class="sales-filter-select">
                                            <option value="all">All Status</option>
                                            <option value="completed">Completed</option>
                                            <option value="approved">Approved</option>
                                            <option value="pending">Pending</option>
                                            <option value="cancelled">Cancelled</option>
                                        </select>
                                    </div>
                                </div>
                            </div>
                            <div class="sales-table-wrapper">
                                <table class="sales-table" id="allSalesTable">
                                    <thead>
                                        <tr>
                                            <th>Receipt #</th>
                                            <th>Date & Time</th>
                                            <th>Customer</th>
                                            <th>Items</th>
                                            <th>Payment</th>
                                            <th>Total</th>
                                            <th>Status</th>
                                            <th>Actions</th>
                                        </tr>
                                    </thead>
                                    <tbody id="allSalesTableBody">
                                        <!-- Sales rows populated dynamically -->
                                    </tbody>
                                </table>
                            </div>
                            <div class="sales-table-empty" id="allSalesTableEmpty">
                                <i class="fas fa-receipt"></i>
                                <h3>No Sales Found</h3>
                                <p>Sales records will appear here</p>
                            </div>
                            <div class="sales-table-loading" id="allSalesTableLoading">
                                <i class="fas fa-spinner fa-spin"></i>
                                <p>Loading sales history...</p>
                            </div>
                        </div>
                    </div>

                    <!-- View All Sale Details Modal -->
                    <div class="sales-modal" id="viewAllSaleModal">
                        <div class="sales-modal-content sale-details-modal">
                            <div class="sales-modal-header">
                                <h3><i class="fas fa-receipt"></i> Sale Details</h3>
                                <button class="sales-modal-close" id="closeViewAllSaleModal">&times;</button>
                            </div>
                            <div class="sales-modal-body" id="allSaleDetailsContent">
                                <!-- Sale details populated dynamically -->
                            </div>
                            <div class="sales-modal-footer">
                                <button class="btn-print-receipt" id="btnPrintAllReceipt">
                                    <i class="fas fa-print"></i> Print Receipt
                                </button>
                                <button class="btn-close-details" id="btnCloseAllDetails">Close</button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- All Activities Module -->
                <div class="module-content" id="module-all-activities">
                    <div class="module-header">
                        <div class="module-header-content">
                            <div>
                                <h1>All Activities</h1>
                                <p>Complete history of system activities</p>
                            </div>
                            <div class="module-header-actions">
                                <button class="btn btn-secondary" id="refreshActivitiesBtn">
                                    <i class="fas fa-sync-alt"></i>
                                    <span>Refresh</span>
                                </button>
                                <button class="btn btn-primary" id="exportActivitiesBtn">
                                    <i class="fas fa-download"></i>
                                    <span>Export</span>
                                </button>
                            </div>
                        </div>
                    </div>
                    <div class="module-body">
                        <!-- Activity Filters -->
                        <div class="activities-filters">
                            <div class="filter-group">
                                <label for="activityTypeFilter">Type</label>
                                <select id="activityTypeFilter" class="form-control">
                                    <option value="">All Types</option>
                                    <option value="sale">Sales</option>
                                    <option value="inventory">Inventory</option>
                                    <option value="order">Orders</option>
                                    <option value="expense">Expenses</option>
                                    <option value="customer">Customers</option>
                                    <option value="wholesale">Wholesale</option>
                                    <option value="prescription">Prescriptions</option>
                                    <option value="system">System</option>
                                </select>
                            </div>
                            <div class="filter-group">
                                <label for="activityStatusFilter">Status</label>
                                <select id="activityStatusFilter" class="form-control">
                                    <option value="">All Status</option>
                                    <option value="completed">Completed</option>
                                    <option value="pending">Pending</option>
                                    <option value="warning">Warning</option>
                                    <option value="failed">Failed</option>
                                </select>
                            </div>
                            <div class="filter-group">
                                <label for="activityDateFrom">From Date</label>
                                <input type="date" id="activityDateFrom" class="form-control">
                            </div>
                            <div class="filter-group">
                                <label for="activityDateTo">To Date</label>
                                <input type="date" id="activityDateTo" class="form-control">
                            </div>
                            <div class="filter-group search-group">
                                <label for="activitySearchInput">Search</label>
                                <div class="search-input-wrapper">
                                    <i class="fas fa-search"></i>
                                    <input type="text" id="activitySearchInput" class="form-control" placeholder="Search activities...">
                                </div>
                            </div>
                            <div class="filter-group filter-actions">
                                <button class="btn btn-secondary btn-sm" id="clearActivityFiltersBtn">
                                    <i class="fas fa-times"></i> Clear
                                </button>
                            </div>
                        </div>

                        <!-- Activity Stats -->
                        <div class="activity-stats-row">
                            <div class="activity-stat-card">
                                <div class="stat-icon success">
                                    <i class="fas fa-check-circle"></i>
                                </div>
                                <div class="stat-info">
                                    <span class="stat-value" id="completedActivitiesCount">0</span>
                                    <span class="stat-label">Completed</span>
                                </div>
                            </div>
                            <div class="activity-stat-card">
                                <div class="stat-icon warning">
                                    <i class="fas fa-clock"></i>
                                </div>
                                <div class="stat-info">
                                    <span class="stat-value" id="pendingActivitiesCount">0</span>
                                    <span class="stat-label">Pending</span>
                                </div>
                            </div>
                            <div class="activity-stat-card">
                                <div class="stat-icon primary">
                                    <i class="fas fa-history"></i>
                                </div>
                                <div class="stat-info">
                                    <span class="stat-value" id="todayActivitiesCount">0</span>
                                    <span class="stat-label">Today</span>
                                </div>
                            </div>
                            <div class="activity-stat-card">
                                <div class="stat-icon info">
                                    <i class="fas fa-list"></i>
                                </div>
                                <div class="stat-info">
                                    <span class="stat-value" id="totalActivitiesCount">0</span>
                                    <span class="stat-label">Total</span>
                                </div>
                            </div>
                        </div>

                        <!-- Activities Table -->
                        <div class="activities-table-container">
                            <div class="table-loading" id="activitiesLoadingState" style="display: none;">
                                <i class="fas fa-spinner fa-spin"></i>
                                <span>Loading activities...</span>
                            </div>
                            <div class="table-empty" id="activitiesEmptyState" style="display: none;">
                                <i class="fas fa-inbox"></i>
                                <h3>No Activities Found</h3>
                                <p>There are no activities matching your filters.</p>
                            </div>
                            <div class="activities-table-wrapper" id="activitiesTableWrapper">
                                <table class="activities-table" id="allActivitiesTable">
                                    <thead>
                                        <tr>
                                            <th class="sortable" data-sort="time">
                                                <span>Time</span>
                                                <i class="fas fa-sort"></i>
                                            </th>
                                            <th>Type</th>
                                            <th>Activity</th>
                                            <th>Description</th>
                                            <th>User</th>
                                            <th class="sortable" data-sort="amount">
                                                <span>Amount</span>
                                                <i class="fas fa-sort"></i>
                                            </th>
                                            <th>Status</th>
                                            <th>Actions</th>
                                        </tr>
                                    </thead>
                                    <tbody id="allActivitiesTableBody">
                                        <!-- Activities will be populated here -->
                                    </tbody>
                                </table>
                            </div>
                        </div>

                        <!-- Pagination -->
                        <div class="activities-pagination">
                            <div class="pagination-info">
                                <span>Showing <strong id="activitiesShowingFrom">0</strong> to <strong id="activitiesShowingTo">0</strong> of <strong id="activitiesTotalCount">0</strong> activities</span>
                            </div>
                            <div class="pagination-controls">
                                <button class="pagination-btn" id="activitiesPrevBtn" disabled>
                                    <i class="fas fa-chevron-left"></i>
                                </button>
                                <div class="pagination-pages" id="activitiesPaginationPages">
                                    <!-- Page numbers will be populated here -->
                                </div>
                                <button class="pagination-btn" id="activitiesNextBtn" disabled>
                                    <i class="fas fa-chevron-right"></i>
                                </button>
                            </div>
                            <div class="pagination-size">
                                <label>Per page:</label>
                                <select id="activitiesPageSize" class="form-control">
                                    <option value="10">10</option>
                                    <option value="25" selected>25</option>
                                    <option value="50">50</option>
                                    <option value="100">100</option>
                                </select>
                            </div>
                        </div>

                        <!-- Activity Details Modal -->
                        <div class="activity-modal-overlay" id="activityDetailsModal">
                            <div class="activity-modal-container">
                                <div class="activity-modal-header">
                                    <h3><i class="fas fa-info-circle"></i> Activity Details</h3>
                                    <button class="activity-modal-close" id="closeActivityDetailsModal">
                                        <i class="fas fa-times"></i>
                                    </button>
                                </div>
                                <div class="activity-modal-body" id="activityDetailsContent">
                                    <!-- Activity details will be populated here -->
                                </div>
                                <div class="activity-modal-footer">
                                    <button class="btn btn-secondary" id="closeActivityDetailsBtn">Close</button>
                                    <button class="btn btn-primary" id="goToActivityModuleBtn">
                                        <i class="fas fa-external-link-alt"></i> Go to Module
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Generate Prescription Module -->
                <div class="module-content" id="module-prescription-generate">
                    <div class="prescription-container">
                        <!-- Left Section: Prescription Form & Medications -->
                        <div class="prescription-left">
                            <!-- Patient & Doctor Information -->
                            <div class="prescription-info-section">
                                <h3><i class="fas fa-user-md"></i> Prescription Information</h3>
                                <div class="prescription-form-grid">
                                    <div class="form-group">
                                        <label for="rxPatientName">Patient Name *</label>
                                        <input type="text" id="rxPatientName" placeholder="Enter patient name" required>
                                    </div>
                                    <div class="form-group">
                                        <label for="rxPatientAge">Age</label>
                                        <input type="number" id="rxPatientAge" placeholder="Patient age">
                                    </div>
                                    <div class="form-group">
                                        <label for="rxPatientGender">Gender</label>
                                        <select id="rxPatientGender">
                                            <option value="">Select</option>
                                            <option value="Male">Male</option>
                                            <option value="Female">Female</option>
                                            <option value="Other">Other</option>
                                        </select>
                                    </div>
                                    <div class="form-group">
                                        <label for="rxPatientPhone">Phone Number</label>
                                        <input type="tel" id="rxPatientPhone" placeholder="Patient phone">
                                    </div>
                                    <div class="form-group">
                                        <label for="rxDoctorName">Doctor Name *</label>
                                        <input type="text" id="rxDoctorName" placeholder="Prescribing doctor" required>
                                    </div>
                                    <div class="form-group">
                                        <label for="rxDoctorLicense">License Number</label>
                                        <input type="text" id="rxDoctorLicense" placeholder="Doctor license">
                                    </div>
                                    <div class="form-group full-width">
                                        <label for="rxDiagnosis">Diagnosis</label>
                                        <input type="text" id="rxDiagnosis" placeholder="Patient diagnosis">
                                    </div>
                                    <div class="form-group full-width">
                                        <label for="rxNotes">Notes/Instructions</label>
                                        <textarea id="rxNotes" rows="2" placeholder="Additional notes or instructions"></textarea>
                                    </div>
                                </div>
                            </div>

                            <!-- Medication Search & Add Section -->
                            <div class="rx-medication-section">
                                <div class="rx-section-header">
                                    <div class="rx-section-title">
                                        <i class="fas fa-pills"></i>
                                        <h3>Add Medications</h3>
                                    </div>
                                    <button class="rx-btn-add-manual" id="rxManualAddBtn">
                                        <i class="fas fa-plus-circle"></i>
                                        <span>Add Manually</span>
                                    </button>
                                </div>

                                <div class="rx-search-container">
                                    <div class="rx-search-wrapper">
                                        <i class="fas fa-search rx-search-icon"></i>
                                        <input 
                                            type="text" 
                                            id="rxSearchInput" 
                                            class="rx-search-input" 
                                            placeholder="Search medications from inventory by name, category, or dosage..." 
                                            autocomplete="off"
                                        >
                                        <button class="rx-search-clear" id="rxSearchClear" style="display: none;">
                                            <i class="fas fa-times"></i>
                                        </button>
                                    </div>
                                    <!-- Search Results Dropdown -->
                                    <div class="rx-search-results" id="rxSearchResults">
                                        <!-- Populated dynamically -->
                                    </div>
                            </div>
                        </div>                            <!-- Medications List Section -->
                            <div class="rx-meds-list-section">
                                <div class="rx-meds-header">
                                    <div class="rx-meds-title">
                                        <i class="fas fa-list-ul"></i>
                                        <h3>Prescribed Medications</h3>
                                        <span class="rx-meds-count" id="rxMedsCount">0</span>
                                    </div>
                                    <button class="rx-btn-clear-all" id="rxClearMeds">
                                        <i class="fas fa-trash-alt"></i>
                                        <span>Clear All</span>
                                    </button>
                                </div>

                                <!-- Empty State -->
                                <div class="rx-meds-empty" id="rxMedsEmpty">
                                    <div class="rx-empty-icon">
                                        <i class="fas fa-prescription-bottle-alt"></i>
                                    </div>
                                    <h4>No Medications Added</h4>
                                    <p>Search from inventory or add medications manually to build the prescription</p>
                                    <button class="rx-empty-btn" id="rxEmptyAddBtn">
                                        <i class="fas fa-plus"></i> Add First Medication
                                    </button>
                                </div>

                                <!-- Medications Table -->
                                <div class="rx-meds-table-container" style="display: none;">
                                    <div class="rx-table-responsive">
                                        <table class="rx-meds-table">
                                            <thead>
                                                <tr>
                                                    <th class="rx-th-med">Medication</th>
                                                    <th class="rx-th-dosage">Dosage</th>
                                                    <th class="rx-th-frequency">Frequency</th>
                                                    <th class="rx-th-duration">Duration</th>
                                                    <th class="rx-th-qty">Qty</th>
                                                    <th class="rx-th-actions"></th>
                                                </tr>
                                            </thead>
                                            <tbody id="rxMedsBody">
                                                <!-- Medications populated dynamically -->
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Right Section: Preview & Actions -->
                        <div class="prescription-right">
                            <div class="prescription-preview-section">
                                <h3><i class="fas fa-file-medical"></i> Prescription Preview</h3>
                                <div class="prescription-preview" id="rxPreview">
                                    <!-- Preview content -->
                                    <div class="rx-preview-header">
                                        <div class="rx-preview-logo">
                                            <i class="fas fa-hospital"></i>
                                            <h2>PharmaFlow Clinic</h2>
                                        </div>
                                        <div class="rx-preview-date">
                                            Date: <span id="rxPreviewDate">--</span>
                                        </div>
                                    </div>
                                    
                                    <div class="rx-preview-title">
                                        <h3> PRESCRIPTION</h3>
                                    </div>

                                    <div class="rx-preview-patient">
                                        <div class="rx-preview-row">
                                            <strong>Patient:</strong> <span id="rxPreviewPatient">--</span>
                                        </div>
                                        <div class="rx-preview-row">
                                            <strong>Age/Gender:</strong> <span id="rxPreviewAge">--</span>
                                        </div>
                                        <div class="rx-preview-row">
                                            <strong>Diagnosis:</strong> <span id="rxPreviewDiagnosis">--</span>
                                        </div>
                                    </div>

                                    <div class="rx-preview-medications">
                                        <h4>Medications:</h4>
                                        <div id="rxPreviewMedsList">
                                            <p class="rx-preview-empty">No medications added</p>
                                        </div>
                                    </div>

                                    <div class="rx-preview-notes">
                                        <strong>Notes:</strong> <span id="rxPreviewNotes">--</span>
                                    </div>

                                    <div class="rx-preview-doctor">
                                        <div class="rx-preview-signature">
                                            <div class="rx-signature-line"></div>
                                            <div class="rx-doctor-info">
                                                <strong id="rxPreviewDoctor">Dr. --</strong><br>
                                                <small>License: <span id="rxPreviewLicense">--</span></small>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <!-- Action Buttons -->
                                <div class="prescription-actions">
                                    <button class="btn-rx-action btn-print" id="rxPrintBtn">
                                        <i class="fas fa-print"></i>
                                        <span>Print Prescription</span>
                                    </button>
                                    <button class="btn-rx-action btn-send-cart" id="rxSendCartBtn">
                                        <i class="fas fa-cart-plus"></i>
                                        <span>Send to POS</span>
                                    </button>
                                    <button class="btn-rx-action btn-save" id="rxSaveBtn">
                                        <i class="fas fa-save"></i>
                                        <span>Save Prescription</span>
                                    </button>
                                    <button class="btn-rx-action btn-clear" id="rxClearBtn">
                                        <i class="fas fa-times"></i>
                                        <span>Clear Form</span>
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Manual Medication Entry Modal -->
                <div class="rx-modal-overlay" id="rxManualMedModal">
                    <div class="rx-modal-container">
                        <div class="rx-modal-header">
                            <h3><i class="fas fa-pills"></i> Add Medication Manually</h3>
                            <button class="rx-modal-close" id="rxManualMedClose">
                                <i class="fas fa-times"></i>
                            </button>
                        </div>
                        <div class="rx-modal-body">
                            <div class="rx-modal-grid">
                                <div class="rx-form-group">
                                    <label for="rxManualMedName">
                                        <i class="fas fa-capsules"></i> Medication Name *
                                    </label>
                                    <input type="text" id="rxManualMedName" class="rx-input" placeholder="Enter medication name" required>
                                </div>
                                <div class="rx-form-group">
                                    <label for="rxManualMedDosage">
                                        <i class="fas fa-prescription-bottle"></i> Dosage *
                                    </label>
                                    <input type="text" id="rxManualMedDosage" class="rx-input" placeholder="e.g., 500mg, 10ml" required>
                                </div>
                            </div>
                            
                            <div class="rx-modal-grid">
                                <div class="rx-form-group">
                                    <label for="rxManualMedFrequency">
                                        <i class="fas fa-clock"></i> Frequency *
                                    </label>
                                    <select id="rxManualMedFrequency" class="rx-select">
                                        <option value="Once daily">Once daily</option>
                                        <option value="Twice daily">Twice daily</option>
                                        <option value="Three times daily">Three times daily</option>
                                        <option value="Four times daily">Four times daily</option>
                                        <option value="Every 4 hours">Every 4 hours</option>
                                        <option value="Every 6 hours">Every 6 hours</option>
                                        <option value="Every 8 hours">Every 8 hours</option>
                                        <option value="As needed">As needed (PRN)</option>
                                        <option value="Before meals">Before meals</option>
                                        <option value="After meals">After meals</option>
                                    </select>
                                </div>
                                <div class="rx-form-group">
                                    <label for="rxManualMedDuration">
                                        <i class="fas fa-calendar-alt"></i> Duration *
                                    </label>
                                    <input type="text" id="rxManualMedDuration" class="rx-input" placeholder="e.g., 7 days, 2 weeks" required>
                                </div>
                            </div>

                            <div class="rx-form-group">
                                <label for="rxManualMedQuantity">
                                    <i class="fas fa-sort-numeric-up"></i> Quantity
                                </label>
                                <input type="number" id="rxManualMedQuantity" class="rx-input" value="1" min="1">
                            </div>

                            <div class="rx-form-group">
                                <label for="rxManualMedInstructions">
                                    <i class="fas fa-notes-medical"></i> Special Instructions
                                </label>
                                <textarea id="rxManualMedInstructions" class="rx-textarea" rows="3" placeholder="Additional instructions or notes..."></textarea>
                            </div>
                        </div>
                        <div class="rx-modal-footer">
                            <button class="rx-btn rx-btn-cancel" id="rxManualMedCancel">
                                <i class="fas fa-times"></i> Cancel
                            </button>
                            <button class="rx-btn rx-btn-add" id="rxManualMedAdd">
                                <i class="fas fa-plus"></i> Add Medication
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Inventory Module -->
                <div class="module-content" id="module-inventory">
                    <div class="module-header">
                        <h1>Inventory</h1>
                        <p>Manage your stock and supplies</p>
                    </div>
                    <div class="module-body">
                        <div class="placeholder-content">
                            <i class="fas fa-boxes"></i>
                            <h2>Inventory Module</h2>
                            <p>This module is ready for future implementation.</p>
                        </div>
                    </div>
                </div>

                <!-- View Inventory Module -->
                <div class="module-content" id="module-inventory-view">
                    <div class="module-header">
                        <div class="module-header-content">
                            <div>
                                <h1>View Inventory</h1>
                                <p>Browse and manage existing inventory items</p>
                            </div>
                            <div class="header-btn-group">
                                <button class="add-inventory-btn" id="goToAddInventory">
                                    <i class="fas fa-plus"></i>
                                    Add New Item
                                </button>
                            </div>
                        </div>
                    </div>
                    <div class="module-body">
                        <!-- Stats Cards -->
                        <div class="inventory-stats">
                            <div class="stat-card total">
                                <div class="stat-icon">
                                    <i class="fas fa-boxes"></i>
                                </div>
                                <div class="stat-info">
                                    <span class="stat-value" id="statTotalItems">0</span>
                                    <span class="stat-label">Total Items</span>
                                </div>
                            </div>
                            <div class="stat-card in-stock">
                                <div class="stat-icon">
                                    <i class="fas fa-check-circle"></i>
                                </div>
                                <div class="stat-info">
                                    <span class="stat-value" id="statInStock">0</span>
                                    <span class="stat-label">In Stock</span>
                                </div>
                            </div>
                            <div class="stat-card low-stock">
                                <div class="stat-icon">
                                    <i class="fas fa-exclamation-triangle"></i>
                                </div>
                                <div class="stat-info">
                                    <span class="stat-value" id="statLowStock">0</span>
                                    <span class="stat-label">Low Stock</span>
                                </div>
                            </div>
                            <div class="stat-card out-of-stock">
                                <div class="stat-icon">
                                    <i class="fas fa-times-circle"></i>
                                </div>
                                <div class="stat-info">
                                    <span class="stat-value" id="statOutOfStock">0</span>
                                    <span class="stat-label">Out of Stock</span>
                                </div>
                            </div>
                            <div class="stat-card expiring">
                                <div class="stat-icon">
                                    <i class="fas fa-clock"></i>
                                </div>
                                <div class="stat-info">
                                    <span class="stat-value" id="statExpiring">0</span>
                                    <span class="stat-label">Expiring Soon</span>
                                </div>
                            </div>
                            <div class="stat-card value">
                                <div class="stat-icon">
                                    <i class="fas fa-money-bill-wave"></i>
                                </div>
                                <div class="stat-info">
                                    <span class="stat-value" id="statTotalValue">KSH 0</span>
                                    <span class="stat-label">Total Value</span>
                                </div>
                            </div>
                        </div>

                        <!-- Search and Filters -->
                        <div class="inventory-toolbar">
                            <div class="search-box">
                                <i class="fas fa-search"></i>
                                <input type="text" id="inventorySearch" placeholder="Search by name, barcode, category...">
                                <button class="clear-search" id="clearSearch" style="display: none;">
                                    <i class="fas fa-times"></i>
                                </button>
                            </div>
                            <div class="filter-group">
                                <select id="filterCategory">
                                    <option value="">All Categories</option>
                                    <option value="tablets">Tablets</option>
                                    <option value="capsules">Capsules</option>
                                    <option value="syrups">Syrups</option>
                                    <option value="injections">Injections</option>
                                    <option value="ointments">Ointments</option>
                                    <option value="drops">Drops</option>
                                    <option value="medical-devices">Medical Devices</option>
                                    <option value="supplements">Supplements</option>
                                    <option value="first-aid">First Aid</option>
                                    <option value="personal-care">Personal Care</option>
                                    <option value="baby-care">Baby Care</option>
                                    <option value="other">Other</option>
                                </select>
                                <select id="filterStatus">
                                    <option value="">All Status</option>
                                    <option value="in-stock">In Stock</option>
                                    <option value="low-stock">Low Stock</option>
                                    <option value="out-of-stock">Out of Stock</option>
                                    <option value="near-expiry">Near Expiry</option>
                                    <option value="expired">Expired</option>
                                </select>
                                <select id="sortBy">
                                    <option value="name-asc">Name (A-Z)</option>
                                    <option value="name-desc">Name (Z-A)</option>
                                    <option value="quantity-asc">Quantity (Low-High)</option>
                                    <option value="quantity-desc">Quantity (High-Low)</option>
                                    <option value="expiry-asc">Expiry (Soonest)</option>
                                    <option value="expiry-desc">Expiry (Latest)</option>
                                    <option value="price-asc">Price (Low-High)</option>
                                    <option value="price-desc">Price (High-Low)</option>
                                </select>
                            </div>
                            <div class="toolbar-actions">
                                <button class="toolbar-btn-text" id="bulkImportInventory">
                                    <i class="fas fa-upload"></i>
                                    Bulk Import
                                </button>
                                <button class="toolbar-btn" id="exportInventory" title="Export to CSV">
                                    <i class="fas fa-download"></i>
                                </button>
                                <button class="toolbar-btn" id="refreshInventory" title="Refresh">
                                    <i class="fas fa-sync-alt" id="refreshIcon"></i>
                                </button>
                            </div>
                        </div>

                        <!-- Inventory Table -->
                        <div class="inventory-table-container">
                            <table class="inventory-table" id="inventoryTable">
                                <thead>
                                    <tr>
                                        <th class="col-name">Product Name</th>
                                        <th class="col-category">Category</th>
                                        <th class="col-barcode">Barcode</th>
                                        <th class="col-quantity">Quantity</th>
                                        <th class="col-price">Price</th>
                                        <th class="col-expiry">Expiry Date</th>
                                        <th class="col-status">Status</th>
                                        <th class="col-actions">Actions</th>
                                    </tr>
                                </thead>
                                <tbody id="inventoryTableBody">
                                    <!-- Dynamic rows will be inserted here -->
                                </tbody>
                            </table>
                            <div class="table-empty" id="tableEmpty" style="display: none;">
                                <i class="fas fa-inbox"></i>
                                <h3>No Items Found</h3>
                                <p>No inventory items match your search criteria.</p>
                            </div>
                            <div class="table-loading" id="tableLoading">
                                <i class="fas fa-spinner fa-spin"></i>
                                <p>Loading inventory...</p>
                            </div>
                        </div>

                        <!-- Pagination -->
                        <div class="inventory-pagination">
                            <div class="pagination-info">
                                <span id="paginationInfo">Showing 0 of 0 items</span>
                            </div>
                            <div class="pagination-controls">
                                <select id="itemsPerPage">
                                    <option value="25">25 per page</option>
                                    <option value="50" selected>50 per page</option>
                                    <option value="100">100 per page</option>
                                    <option value="250">250 per page</option>
                                </select>
                                <div class="pagination-buttons">
                                    <button id="prevPage" disabled><i class="fas fa-chevron-left"></i></button>
                                    <span id="pageNumbers"></span>
                                    <button id="nextPage" disabled><i class="fas fa-chevron-right"></i></button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Add Inventory Module -->
                <div class="module-content" id="module-inventory-add">
                    <div class="module-header">
                        <div class="module-header-content">
                            <div>
                                <h1>Add Inventory</h1>
                                <p>Add new drugs and products to your inventory</p>
                            </div>
                            <div class="header-btn-group">
                                <button class="scan-inventory-btn" id="scanInventoryBtn">
                                    <i class="fas fa-barcode"></i>
                                    Scan to Add
                                </button>
                                <button class="view-inventory-btn" id="viewInventoryBtn">
                                    View Inventory
                                </button>
                            </div>
                        </div>
                    </div>
                    <div class="module-body">
                        <div class="inventory-form-container">
                            <form id="addInventoryForm" class="clean-form">
                                <!-- Basic Information -->
                                <div class="clean-form-section">
                                    <h3 class="clean-section-title">Basic Information</h3>
                                    <div class="clean-form-row">
                                        <div class="clean-form-group">
                                            <label for="invItemName">Drug/Product Name *</label>
                                            <input type="text" id="invItemName" placeholder="Enter drug or product name" required>
                                        </div>
                                        <div class="clean-form-group">
                                            <label for="invGenericName">Generic Name</label>
                                            <input type="text" id="invGenericName" placeholder="Enter generic name">
                                        </div>
                                        <div class="clean-form-group">
                                            <label for="invManufacturer">Manufacturer</label>
                                            <input type="text" id="invManufacturer" placeholder="Enter manufacturer name">
                                        </div>
                                    </div>
                                    <div class="clean-form-row">
                                        <div class="clean-form-group">
                                            <label for="invCategory">Category *</label>
                                            <select id="invCategory" required>
                                                <option value="">Select Category</option>
                                                <option value="antibiotics">Antibiotics</option>
                                                <option value="painkillers">Pain Relief / Analgesics</option>
                                                <option value="antacids">Antacids & Digestive</option>
                                                <option value="cardiovascular">Cardiovascular</option>
                                                <option value="diabetes">Diabetes</option>
                                                <option value="respiratory">Respiratory</option>
                                                <option value="allergy">Allergy & Antihistamines</option>
                                                <option value="supplements">Vitamins & Supplements</option>
                                                <option value="skincare">Skincare & Dermatology</option>
                                                <option value="first-aid">First Aid</option>
                                                <option value="other">Other</option>
                                            </select>
                                        </div>
                                        <div class="clean-form-group">
                                            <label for="invDosageForm">Dosage Form *</label>
                                            <select id="invDosageForm" required>
                                                <option value="">Select Form</option>
                                                <option value="tablet">Tablet</option>
                                                <option value="capsule">Capsule</option>
                                                <option value="syrup">Syrup</option>
                                                <option value="injection">Injection</option>
                                                <option value="cream">Cream/Ointment</option>
                                                <option value="drops">Drops</option>
                                                <option value="inhaler">Inhaler</option>
                                                <option value="powder">Powder</option>
                                                <option value="other">Other</option>
                                            </select>
                                        </div>
                                        <div class="clean-form-group">
                                            <label for="invStrength">Strength/Dosage</label>
                                            <input type="text" id="invStrength" placeholder="e.g., 500mg, 10ml">
                                        </div>
                                    </div>
                                </div>

                                <!-- Stock & Pricing -->
                                <div class="clean-form-section">
                                    <h3 class="clean-section-title">Stock & Pricing</h3>
                                    <div class="clean-form-row">
                                        <div class="clean-form-group">
                                            <label for="invQuantity">Quantity in Stock *</label>
                                            <input type="number" id="invQuantity" placeholder="0" min="0" required>
                                        </div>
                                        <div class="clean-form-group">
                                            <label for="invUnit">Unit of Measure</label>
                                            <select id="invUnit">
                                                <option value="pieces">Pieces</option>
                                                <option value="strips">Strips</option>
                                                <option value="bottles">Bottles</option>
                                                <option value="boxes">Boxes</option>
                                                <option value="packs">Packs</option>
                                            </select>
                                        </div>
                                        <div class="clean-form-group">
                                            <label for="invReorderLevel">Reorder Level</label>
                                            <input type="number" id="invReorderLevel" placeholder="10" min="0" value="10">
                                        </div>
                                    </div>
                                    <div class="clean-form-row">
                                        <div class="clean-form-group">
                                            <label for="invCostPrice">Cost Price (KSH) *</label>
                                            <input type="number" id="invCostPrice" placeholder="0.00" min="0" step="0.01" required>
                                        </div>
                                        <div class="clean-form-group">
                                            <label for="invSellingPrice">Selling Price (KSH) *</label>
                                            <input type="number" id="invSellingPrice" placeholder="0.00" min="0" step="0.01" required>
                                        </div>
                                        <div class="clean-form-group">
                                            <label>Profit Margin</label>
                                            <div class="clean-profit-display" id="invProfitMargin">
                                                <span class="margin-value">0%</span>
                                                <span class="margin-amount">KSH 0.00</span>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <!-- Batch & Barcode -->
                                <div class="clean-form-section">
                                    <h3 class="clean-section-title">Batch & Barcode</h3>
                                    <div class="clean-form-row">
                                        <div class="clean-form-group">
                                            <label for="invBatchNumber">Batch Number</label>
                                            <input type="text" id="invBatchNumber" placeholder="e.g., BTH-2024-001">
                                        </div>
                                        <div class="clean-form-group">
                                            <label for="invBarcode">Barcode/SKU</label>
                                            <div class="clean-barcode-input">
                                                <input type="text" id="invBarcode" readonly placeholder="Auto-generated">
                                                <button type="button" class="clean-icon-btn" id="generateBarcodeBtn" title="Generate">
                                                    <i class="fas fa-sync-alt"></i>
                                                </button>
                                                <button type="button" class="clean-icon-btn" id="printBarcodeBtn" title="Print">
                                                    <i class="fas fa-print"></i>
                                                </button>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="clean-form-row">
                                        <div class="clean-form-group">
                                            <label for="invExpiryDate">Expiry Date *</label>
                                            <input type="date" id="invExpiryDate" required>
                                        </div>
                                        <div class="clean-form-group">
                                            <label for="invManufactureDate">Manufacture Date</label>
                                            <input type="date" id="invManufactureDate">
                                        </div>
                                    </div>
                                </div>

                                <!-- Additional Info -->
                                <div class="clean-form-section">
                                    <h3 class="clean-section-title">Additional Info</h3>
                                    <div class="clean-form-row">
                                        <div class="clean-form-group">
                                            <label for="invLocation">Storage Location</label>
                                            <input type="text" id="invLocation" placeholder="e.g., Shelf A, Row 2">
                                        </div>
                                        <div class="clean-form-group">
                                            <label for="invSupplier">Supplier</label>
                                            <input type="text" id="invSupplier" placeholder="Supplier name">
                                        </div>
                                    </div>
                                    <div class="clean-form-row">
                                        <div class="clean-form-group full-width">
                                            <label for="invDescription">Description/Notes</label>
                                            <textarea id="invDescription" rows="2" placeholder="Additional notes..."></textarea>
                                        </div>
                                    </div>
                                    <div class="clean-form-row">
                                        <div class="clean-form-group">
                                            <label class="clean-checkbox">
                                                <input type="checkbox" id="invPrescriptionRequired">
                                                <span class="checkmark"></span>
                                                Prescription Required
                                            </label>
                                        </div>
                                    </div>
                                </div>

                                <!-- Form Actions -->
                                <div class="clean-form-actions">
                                    <button type="button" class="clean-btn clean-btn-secondary" id="invCancelBtn">
                                        Cancel
                                    </button>
                                    <button type="button" class="clean-btn clean-btn-outline" id="invSaveDraftBtn">
                                        Save Draft
                                    </button>
                                    <button type="submit" class="clean-btn clean-btn-primary" id="invSubmitBtn">
                                        Add to Inventory
                                    </button>
                                </div>
                            </form>
                        </div>
                    </div>
                </div>

                <!-- My Orders Module -->
                <div class="module-content" id="module-orders">
                    <div class="module-header">
                        <h1>My Orders</h1>
                        <p>View and manage customer orders</p>
                    </div>
                    <div class="module-body">
                        <div class="placeholder-content">
                            <i class="fas fa-shopping-cart"></i>
                            <h2>My Orders Module</h2>
                            <p>This module is ready for future implementation.</p>
                        </div>
                    </div>
                </div>

                <!-- Create Order Module -->
                <div class="module-content" id="module-orders-create">
                    <div class="module-header">
                        <div>
                            <h1>Create Order</h1>
                            <p>Create a new order from supplier</p>
                        </div>
                        <div class="module-header-actions">
                            <button class="btn-module-action btn-view-orders" data-module="orders-view">
                                <i class="fas fa-list"></i> Manage Orders
                            </button>
                            <button class="btn-module-action btn-view-suppliers" data-module="orders-supplier">
                                <i class="fas fa-truck"></i> Suppliers
                            </button>
                        </div>
                    </div>
                    <div class="module-body">
                        <div class="order-create-container">
                            <!-- Left Section: Supplier & Items -->
                            <div class="order-left-section">
                                <!-- Supplier Selection -->
                                <div class="order-section">
                                    <h2 class="section-title">Supplier Information</h2>
                                    <div class="supplier-dropdown-box">
                                        <label for="supplierDropdown">Select Supplier *</label>
                                        <select id="supplierDropdown">
                                            <option value="">-- Select Supplier --</option>
                                        </select>
                                    </div>
                                    <div class="selected-supplier" id="selectedSupplierCard" style="display: none;">
                                        <div class="supplier-info">
                                            <h3 id="selectedSupplierName"></h3>
                                            <p id="selectedSupplierContact"></p>
                                            <p id="selectedSupplierPhone"></p>
                                        </div>
                                    </div>
                                </div>

                                <!-- Add Items Section -->
                                <div class="order-section">
                                    <h2 class="section-title">Add Items</h2>
                                    
                                    <!-- Search Inventory -->
                                    <div class="search-inventory-section">
                                        <input type="text" id="orderItemSearch" placeholder="Type to search inventory items..." autocomplete="off">
                                        <div id="orderSearchResults" class="search-results"></div>
                                    </div>

                                    <!-- Manual Add Form -->
                                    <div class="manual-add-form">
                                        <h3>Or Add Manually</h3>
                                        <div class="form-row">
                                            <input type="text" id="manualItemName" placeholder="Item name">
                                            <input type="text" id="manualItemDosage" placeholder="Dosage">
                                        </div>
                                        <div class="form-row">
                                            <input type="number" id="manualItemQuantity" placeholder="Quantity" min="1">
                                            <input type="number" id="manualItemPrice" placeholder="Unit Price" step="0.01" min="0">
                                        </div>
                                        <button class="btn-primary" id="addManualItemBtn">
                                            <i class="fas fa-plus"></i> Add Item
                                        </button>
                                    </div>
                                </div>

                                <!-- Inventory Browser -->
                                <div class="order-section">
                                    <h2 class="section-title">
                                        Inventory Status
                                        <button class="btn-refresh" id="refreshInventoryBtn">
                                            <i class="fas fa-sync-alt"></i>
                                        </button>
                                    </h2>
                                    <div class="inventory-filters">
                                        <button class="filter-btn active" data-filter="all">All</button>
                                        <button class="filter-btn" data-filter="low">Low Stock</button>
                                        <button class="filter-btn" data-filter="out">Out of Stock</button>
                                    </div>
                                    <div class="inventory-list" id="inventoryList">
                                        <div class="loading-state">
                                            <i class="fas fa-spinner fa-spin"></i>
                                            <p>Loading inventory...</p>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- Right Section: Preview -->
                            <div class="order-right-section">
                                <div class="order-preview">
                                    <h2 class="section-title">Order Preview</h2>
                                    
                                    <div class="order-items-list" id="orderItemsList">
                                        <div class="empty-order">
                                            <i class="fas fa-shopping-cart"></i>
                                            <p>No items added yet</p>
                                        </div>
                                    </div>

                                    <div class="order-summary">
                                        <div class="summary-row">
                                            <span>Total Items:</span>
                                            <span id="totalItems">0</span>
                                        </div>
                                        <div class="summary-row">
                                            <span>Total Quantity:</span>
                                            <span id="totalQuantity">0</span>
                                        </div>
                                        <div class="summary-row total-row">
                                            <span>Total Amount:</span>
                                            <span id="totalAmount">KSH 0.00</span>
                                        </div>
                                    </div>

                                    <div class="order-notes">
                                        <label for="orderNotes">Order Notes</label>
                                        <textarea id="orderNotes" placeholder="Add any additional notes..." rows="3"></textarea>
                                    </div>

                                    <div class="order-actions">
                                        <button class="btn-primary" id="createOrderBtn" disabled>
                                            <i class="fas fa-check"></i> Create Order
                                        </button>
                                        <button class="btn-secondary" id="clearOrderBtn">
                                            <i class="fas fa-times"></i> Clear All
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Manage Orders Module -->
                <div class="module-content" id="module-orders-view">
                    <div class="module-header">
                        <div>
                            <h1>Manage Orders</h1>
                            <p>Track and manage all purchase orders</p>
                        </div>
                        <div class="module-header-actions">
                            <button class="btn-module-action btn-create-order" data-module="orders-create">
                                <i class="fas fa-plus-circle"></i> Create Order
                            </button>
                            <button class="btn-module-action btn-view-suppliers" data-module="orders-supplier">
                                <i class="fas fa-truck"></i> Suppliers
                            </button>
                            <button class="btn-module-action btn-mark-completed" id="moMarkCompleted">
                                <i class="fas fa-check-circle"></i> Mark Completed
                            </button>
                            <button class="btn-module-action btn-print-invoice" id="moPrintInvoice">
                                <i class="fas fa-print"></i> Print Invoice
                            </button>
                            <button class="btn-module-action btn-delete-order" id="moDeleteOrder">
                                <i class="fas fa-trash-alt"></i> Delete
                            </button>
                        </div>
                    </div>
                    <div class="module-body">
                        <!-- Stats Cards -->
                        <div class="manage-orders-stats">
                            <div class="mo-stat-card">
                                <div class="mo-stat-icon">
                                    <i class="fas fa-shopping-cart"></i>
                                </div>
                                <div class="mo-stat-content">
                                    <div class="mo-stat-value" id="moTotalOrders">0</div>
                                    <div class="mo-stat-label">Total Orders</div>
                                </div>
                            </div>
                            <div class="mo-stat-card">
                                <div class="mo-stat-icon">
                                    <i class="fas fa-clock"></i>
                                </div>
                                <div class="mo-stat-content">
                                    <div class="mo-stat-value" id="moPendingOrders">0</div>
                                    <div class="mo-stat-label">Pending</div>
                                </div>
                            </div>
                            <div class="mo-stat-card">
                                <div class="mo-stat-icon">
                                    <i class="fas fa-money-bill-wave"></i>
                                </div>
                                <div class="mo-stat-content">
                                    <div class="mo-stat-value" id="moTotalValue">KSH 0</div>
                                    <div class="mo-stat-label">Total Value</div>
                                </div>
                            </div>
                            <div class="mo-stat-card">
                                <div class="mo-stat-icon">
                                    <i class="fas fa-check-circle"></i>
                                </div>
                                <div class="mo-stat-content">
                                    <div class="mo-stat-value" id="moCompletedOrders">0</div>
                                    <div class="mo-stat-label">Completed</div>
                                </div>
                            </div>
                        </div>

                        <!-- Controls -->
                        <div class="manage-orders-controls">
                            <div class="mo-controls-left">
                                <select id="moStatusFilter" class="mo-select">
                                    <option value="all">All Orders</option>
                                    <option value="pending">Pending</option>
                                    <option value="processing">Processing</option>
                                    <option value="completed">Completed</option>
                                    <option value="cancelled">Cancelled</option>
                                </select>
                                <input type="text" id="moSearchInput" class="mo-search" placeholder="Search by order number or supplier...">
                            </div>
                            <div class="mo-controls-right">
                                <button class="mo-btn mo-btn-secondary" id="moExportExcel">
                                    <i class="fas fa-file-excel"></i> Export Excel
                                </button>
                                <button class="mo-btn mo-btn-secondary" id="moExportPDF">
                                    <i class="fas fa-file-pdf"></i> Export PDF
                                </button>
                                <button class="mo-btn mo-btn-secondary" id="moRefreshBtn">
                                    <i class="fas fa-sync-alt"></i> Refresh
                                </button>
                                <button class="mo-btn mo-btn-primary" data-module="orders-create">
                                    <i class="fas fa-plus"></i> New Order
                                </button>
                            </div>
                        </div>

                        <!-- Orders Table -->
                        <div class="manage-orders-table-wrapper">
                            <div class="mo-loading" id="moLoading">
                                <i class="fas fa-spinner fa-spin"></i>
                                <p>Loading orders...</p>
                            </div>
                            <div class="mo-empty" id="moEmpty" style="display: none;">
                                <i class="fas fa-inbox"></i>
                                <h3>No Orders Yet</h3>
                                <p>Create your first order to get started</p>
                                <button class="mo-btn mo-btn-primary" data-module="orders-create">
                                    <i class="fas fa-plus"></i> Create Order
                                </button>
                            </div>
                            <table class="manage-orders-table" id="moTable" style="display: none;">
                                <thead>
                                    <tr>
                                        <th><input type="checkbox" id="moSelectAll" title="Select All"></th>
                                        <th>Order #</th>
                                        <th>Date</th>
                                        <th>Supplier</th>
                                        <th>Items</th>
                                        <th>Total</th>
                                        <th>Status</th>
                                        <th>Actions</th>
                                    </tr>
                                </thead>
                                <tbody id="moTableBody"></tbody>
                            </table>
                        </div>

                        <!-- Pagination -->
                        <div class="manage-orders-pagination" id="moPagination" style="display: none;">
                            <div class="mo-pagination-info">
                                <span>Showing <strong id="moPageStart">0</strong> to <strong id="moPageEnd">0</strong> of <strong id="moPageTotal">0</strong> orders</span>
                            </div>
                            <div class="mo-pagination-controls">
                                <button class="mo-page-btn" id="moFirstPage" disabled>
                                    <i class="fas fa-angle-double-left"></i>
                                </button>
                                <button class="mo-page-btn" id="moPrevPage" disabled>
                                    <i class="fas fa-angle-left"></i>
                                </button>
                                <div class="mo-page-numbers" id="moPageNumbers"></div>
                                <button class="mo-page-btn" id="moNextPage" disabled>
                                    <i class="fas fa-angle-right"></i>
                                </button>
                                <button class="mo-page-btn" id="moLastPage" disabled>
                                    <i class="fas fa-angle-double-right"></i>
                                </button>
                            </div>
                            <div class="mo-pagination-size">
                                <label>Show:</label>
                                <select id="moPageSize" class="mo-select">
                                    <option value="10">10</option>
                                    <option value="25">25</option>
                                    <option value="50">50</option>
                                    <option value="100">100</option>
                                </select>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Order Details Modal -->
                <div class="mo-modal" id="moDetailsModal" style="display: none;">
                    <div class="mo-modal-overlay"></div>
                    <div class="mo-modal-content">
                        <div class="mo-modal-header">
                            <h2>Order Details</h2>
                            <button class="mo-modal-close" id="moModalClose">
                                <i class="fas fa-times"></i>
                            </button>
                        </div>
                        <div class="mo-modal-body">
                            <div class="mo-modal-section">
                                <div class="mo-modal-row">
                                    <div class="mo-modal-field">
                                        <label>Order Number</label>
                                        <div id="moModalOrderNum" class="mo-modal-value"></div>
                                    </div>
                                    <div class="mo-modal-field">
                                        <label>Date</label>
                                        <div id="moModalOrderDate" class="mo-modal-value"></div>
                                    </div>
                                    <div class="mo-modal-field">
                                        <label>Status</label>
                                        <select id="moModalStatus" class="mo-select">
                                            <option value="pending">Pending</option>
                                            <option value="processing">Processing</option>
                                            <option value="completed">Completed</option>
                                            <option value="cancelled">Cancelled</option>
                                        </select>
                                    </div>
                                </div>
                            </div>
                            <div class="mo-modal-section">
                                <h3>Supplier Information</h3>
                                <div class="mo-modal-row">
                                    <div class="mo-modal-field">
                                        <label>Supplier Name</label>
                                        <div id="moModalSupplier" class="mo-modal-value"></div>
                                    </div>
                                    <div class="mo-modal-field">
                                        <label>Contact</label>
                                        <div id="moModalContact" class="mo-modal-value"></div>
                                    </div>
                                </div>
                            </div>
                            <div class="mo-modal-section">
                                <h3>Order Items</h3>
                                <table class="mo-modal-items-table">
                                    <thead>
                                        <tr>
                                            <th>Item Name</th>
                                            <th>Quantity</th>
                                            <th>Unit Price</th>
                                            <th>Subtotal</th>
                                        </tr>
                                    </thead>
                                    <tbody id="moModalItems"></tbody>
                                    <tfoot>
                                        <tr>
                                            <td colspan="3"><strong>Grand Total</strong></td>
                                            <td><strong id="moModalTotal"></strong></td>
                                        </tr>
                                    </tfoot>
                                </table>
                            </div>
                            <div class="mo-modal-section" id="moModalNotesSection" style="display: none;">
                                <h3>Notes</h3>
                                <div id="moModalNotes" class="mo-modal-notes"></div>
                            </div>
                        </div>
                        <div class="mo-modal-footer">
                            <button class="mo-btn mo-btn-secondary" id="moModalCloseBtn">Close</button>
                            <button class="mo-btn mo-btn-primary" id="moModalSaveBtn">Save Changes</button>
                        </div>
                    </div>
                </div>

                <!-- Supplier Module -->
                <div class="module-content" id="module-orders-supplier">
                    <div class="module-header">
                        <div>
                            <h1><i class="fas fa-truck"></i> Supplier Management</h1>
                            <p>Add and manage supplier information</p>
                        </div>
                        <div class="module-header-actions">
                            <button class="btn-module-action btn-create-order" data-module="orders-create">
                                <i class="fas fa-plus-circle"></i> Create Order
                            </button>
                            <button class="btn-module-action btn-view-orders" data-module="orders-view">
                                <i class="fas fa-list"></i> Manage Orders
                            </button>
                        </div>
                    </div>
                    <div class="module-body">
                        <!-- Add Supplier Form -->
                        <div class="supplier-form-section">
                            <h2 class="section-title">Add New Supplier</h2>
                            <form id="addSupplierForm" class="supplier-form">
                                <div class="supplier-form-grid">
                                    <div class="form-field">
                                        <label for="supplierName">Supplier Name *</label>
                                        <input type="text" id="supplierName" placeholder="Enter supplier name" required>
                                    </div>
                                    <div class="form-field">
                                        <label for="supplierContact">Contact Person</label>
                                        <input type="text" id="supplierContact" placeholder="Contact person name">
                                    </div>
                                    <div class="form-field">
                                        <label for="supplierPhone">Phone Number *</label>
                                        <input type="tel" id="supplierPhone" placeholder="+254 700 000000" required>
                                    </div>
                                    <div class="form-field">
                                        <label for="supplierEmail">Email Address</label>
                                        <input type="email" id="supplierEmail" placeholder="supplier@example.com">
                                    </div>
                                    <div class="form-field full-width">
                                        <label for="supplierAddress">Physical Address</label>
                                        <input type="text" id="supplierAddress" placeholder="Street, City, Country">
                                    </div>
                                    <div class="form-field">
                                        <label for="supplierCategory">Category</label>
                                        <select id="supplierCategory">
                                            <option value="">Select category</option>
                                            <option value="pharmaceuticals">Pharmaceuticals</option>
                                            <option value="medical-supplies">Medical Supplies</option>
                                            <option value="equipment">Equipment</option>
                                            <option value="wholesale">Wholesale</option>
                                            <option value="other">Other</option>
                                        </select>
                                    </div>
                                    <div class="form-field">
                                        <label for="supplierStatus">Status</label>
                                        <select id="supplierStatus">
                                            <option value="active">Active</option>
                                            <option value="inactive">Inactive</option>
                                        </select>
                                    </div>
                                </div>
                                <div class="form-actions">
                                    <button type="submit" class="btn-primary">
                                        <i class="fas fa-plus"></i> Add Supplier
                                    </button>
                                    <button type="reset" class="btn-secondary">
                                        <i class="fas fa-redo"></i> Reset
                                    </button>
                                </div>
                            </form>
                        </div>

                        <!-- Suppliers Table -->
                        <div class="supplier-table-section">
                            <div class="table-header">
                                <div class="table-header-left">
                                    <h2 class="section-title">Suppliers List</h2>
                                    <div class="supplier-stats-card">
                                        <i class="fas fa-truck"></i>
                                        <div class="stat-info">
                                            <span class="stat-label">Total Suppliers</span>
                                            <span class="stat-value" id="totalSuppliersCount">0</span>
                                        </div>
                                    </div>
                                </div>
                                <div class="table-actions">
                                    <div class="search-box">
                                        <i class="fas fa-search"></i>
                                        <input type="text" id="supplierSearchInput" placeholder="Search suppliers...">
                                    </div>
                                    <button class="btn-refresh" id="refreshSuppliersBtn">
                                        <i class="fas fa-sync-alt"></i>
                                    </button>
                                </div>
                            </div>

                            <div class="supplier-table-wrapper">
                                <!-- Loading State -->
                                <div class="table-loading" id="supplierTableLoading">
                                    <i class="fas fa-spinner fa-spin"></i>
                                    <p>Loading suppliers...</p>
                                </div>

                                <!-- Empty State -->
                                <div class="table-empty" id="supplierTableEmpty" style="display: none;">
                                    <i class="fas fa-truck"></i>
                                    <h3>No Suppliers Added</h3>
                                    <p>Add your first supplier using the form above</p>
                                </div>

                                <!-- Suppliers Table -->
                                <table class="supplier-table" id="supplierTable" style="display: none;">
                                    <thead>
                                        <tr>
                                            <th>Supplier Name</th>
                                            <th>Contact Person</th>
                                            <th>Phone</th>
                                            <th>Email</th>
                                            <th>Category</th>
                                            <th>Status</th>
                                            <th>Actions</th>
                                        </tr>
                                    </thead>
                                    <tbody id="supplierTableBody">
                                        <!-- Populated dynamically -->
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Wholesale Module -->
                <div class="module-content" id="module-wholesale">
                    <div class="module-header">
                        <h1>Wholesale</h1>
                        <p>Manage wholesale suppliers and purchases</p>
                    </div>
                    <div class="module-body">
                        <div class="placeholder-content">
                            <i class="fas fa-warehouse"></i>
                            <h2>Wholesale Module</h2>
                            <p>This module is ready for future implementation.</p>
                        </div>
                    </div>
                </div>

                <!-- Create Wholesale Module -->
                <div class="module-content" id="module-wholesale-create">
                    <div class="module-header">
                        <div>
                            <h1>Create Wholesale Sale</h1>
                            <p>Process bulk orders for wholesale customers</p>
                        </div>
                        <div class="module-header-actions">
                            <button class="btn-module-action" onclick="showModule('module-wholesale-manage')" style="background-color: #3b82f6; color: white;">
                                <i class="fas fa-list"></i> View Sales
                            </button>
                        </div>
                    </div>
                    <div class="module-body">
                        <div class="ws-container">
                            <!-- Left Panel - Product Selection -->
                            <div class="ws-left-panel">
                                <!-- Customer Selection -->
                                <div class="ws-section">
                                    <div class="ws-section-header">
                                        <h3><i class="fas fa-user"></i> Customer</h3>
                                        <button class="ws-add-btn" onclick="openAddCustomerModal()">
                                            <i class="fas fa-plus"></i> New
                                        </button>
                                    </div>
                                    <div class="ws-customer-search">
                                        <div class="ws-search-box">
                                            <i class="fas fa-search"></i>
                                            <input type="text" id="wsCustomerSearch" placeholder="Search customer by name or phone...">
                                        </div>
                                        <div class="ws-customer-results" id="wsCustomerResults"></div>
                                    </div>
                                    <div class="ws-selected-customer" id="wsSelectedCustomer">
                                        <p class="ws-no-customer">No customer selected (Walk-in)</p>
                                    </div>
                                </div>

                                <!-- Product Search -->
                                <div class="ws-section">
                                    <div class="ws-section-header">
                                        <h3><i class="fas fa-box"></i> Add Products</h3>
                                        <button class="ws-add-btn" onclick="openManualProductModal()">
                                            <i class="fas fa-plus"></i> Manual
                                        </button>
                                    </div>
                                    <div class="ws-product-search">
                                        <div class="ws-search-box">
                                            <i class="fas fa-search"></i>
                                            <input type="text" id="wsProductSearch" placeholder="Search products by name or code...">
                                        </div>
                                        <div class="ws-product-results" id="wsProductResults"></div>
                                    </div>
                                </div>

                                <!-- Quick Stats -->
                                <div class="ws-quick-stats">
                                    <div class="ws-quick-stat">
                                        <span class="ws-qs-label">Items in Cart</span>
                                        <span class="ws-qs-value" id="wsCartCount">0</span>
                                    </div>
                                    <div class="ws-quick-stat">
                                        <span class="ws-qs-label">Total Quantity</span>
                                        <span class="ws-qs-value" id="wsTotalQty">0</span>
                                    </div>
                                </div>
                            </div>

                            <!-- Right Panel - Cart & Checkout -->
                            <div class="ws-right-panel">
                                <!-- Cart Section -->
                                <div class="ws-cart-section">
                                    <div class="ws-cart-header">
                                        <h3><i class="fas fa-shopping-cart"></i> Cart</h3>
                                        <button class="ws-clear-btn" onclick="clearWholesaleCart()">
                                            <i class="fas fa-trash"></i> Clear
                                        </button>
                                    </div>
                                    <div class="ws-cart-table-container">
                                        <table class="ws-cart-table">
                                            <thead>
                                                <tr>
                                                    <th>Product</th>
                                                    <th>Price</th>
                                                    <th>Qty</th>
                                                    <th>Total</th>
                                                    <th></th>
                                                </tr>
                                            </thead>
                                            <tbody id="wsCartBody">
                                                <tr class="ws-cart-empty">
                                                    <td colspan="5">
                                                        <i class="fas fa-shopping-basket"></i>
                                                        <p>Cart is empty</p>
                                                    </td>
                                                </tr>
                                            </tbody>
                                        </table>
                                    </div>
                                </div>

                                <!-- Checkout Section -->
                                <div class="ws-checkout-section">
                                    <div class="ws-totals">
                                        <div class="ws-total-row">
                                            <span>Subtotal</span>
                                            <span id="wsSubtotal">Ksh 0.00</span>
                                        </div>
                                        <div class="ws-total-row ws-editable">
                                            <span>Discount</span>
                                            <div class="ws-discount-input">
                                                <span>Ksh</span>
                                                <input type="number" id="wsDiscountAmount" value="0" min="0" step="1">
                                            </div>
                                        </div>
                                        <div class="ws-total-row ws-editable">
                                            <span>Tax (VAT)</span>
                                            <div class="ws-tax-input">
                                                <input type="number" id="wsTaxPercent" value="0" min="0" max="100" step="0.1">
                                                <span>%</span>
                                                <span class="ws-tax-amount" id="wsTaxAmount">+ Ksh 0.00</span>
                                            </div>
                                        </div>
                                        <div class="ws-total-row ws-grand-total">
                                            <span>Grand Total</span>
                                            <span id="wsGrandTotal">Ksh 0.00</span>
                                        </div>
                                    </div>

                                    <!-- Payment Method -->
                                    <div class="ws-payment-section">
                                        <label>Payment Method</label>
                                        <div class="ws-payment-options">
                                            <label class="ws-payment-option">
                                                <input type="radio" name="wsPayment" value="cash" checked>
                                                <span><i class="fas fa-money-bill-wave"></i> Cash</span>
                                            </label>
                                            <label class="ws-payment-option">
                                                <input type="radio" name="wsPayment" value="mpesa">
                                                <span><i class="fas fa-mobile-alt"></i> M-Pesa</span>
                                            </label>
                                            <label class="ws-payment-option">
                                                <input type="radio" name="wsPayment" value="bank">
                                                <span><i class="fas fa-university"></i> Bank</span>
                                            </label>
                                            <label class="ws-payment-option">
                                                <input type="radio" name="wsPayment" value="credit">
                                                <span><i class="fas fa-credit-card"></i> Credit</span>
                                            </label>
                                        </div>
                                    </div>

                                    <!-- Notes -->
                                    <div class="ws-notes-section">
                                        <label>Order Notes</label>
                                        <textarea id="wsOrderNotes" placeholder="Add any notes for this order..."></textarea>
                                    </div>

                                    <!-- Action Buttons -->
                                    <div class="ws-action-buttons-grid">
                                        <button class="ws-btn-secondary" onclick="saveWholesaleDraft()">
                                            <i class="fas fa-save"></i> Save Draft
                                        </button>
                                        <button class="ws-btn-hold" onclick="holdWholesaleOrder()">
                                            <i class="fas fa-pause-circle"></i> Hold Order
                                        </button>
                                        <button class="ws-btn-primary" onclick="processWholesaleSale()">
                                            <i class="fas fa-check-circle"></i> Process Sale
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Add Customer Quick Modal -->
                    <div class="ws-modal-overlay" id="wsAddCustomerModal">
                        <div class="ws-modal">
                            <div class="ws-modal-header">
                                <h3><i class="fas fa-user-plus"></i> Quick Add Customer</h3>
                                <button class="ws-modal-close" onclick="closeAddCustomerModal()">
                                    <i class="fas fa-times"></i>
                                </button>
                            </div>
                            <div class="ws-modal-body">
                                <form id="wsQuickCustomerForm">
                                    <div class="ws-form-grid">
                                        <div class="ws-form-field">
                                            <label>Customer Name *</label>
                                            <input type="text" id="wsNewCustomerName" required>
                                        </div>
                                        <div class="ws-form-field">
                                            <label>Phone Number *</label>
                                            <input type="tel" id="wsNewCustomerPhone" required>
                                        </div>
                                        <div class="ws-form-field">
                                            <label>Email</label>
                                            <input type="email" id="wsNewCustomerEmail">
                                        </div>
                                        <div class="ws-form-field">
                                            <label>Business Name</label>
                                            <input type="text" id="wsNewCustomerBusiness">
                                        </div>
                                        <div class="ws-form-field full-width">
                                            <label>Address</label>
                                            <input type="text" id="wsNewCustomerAddress">
                                        </div>
                                    </div>
                                </form>
                            </div>
                            <div class="ws-modal-footer">
                                <button class="ws-btn-secondary" onclick="closeAddCustomerModal()">Cancel</button>
                                <button class="ws-btn-primary" onclick="saveQuickCustomer()">
                                    <i class="fas fa-save"></i> Save Customer
                                </button>
                            </div>
                        </div>
                    </div>

                    <!-- Manual Product Modal -->
                    <div class="ws-modal-overlay" id="wsManualProductModal">
                        <div class="ws-modal">
                            <div class="ws-modal-header">
                                <h3><i class="fas fa-plus-circle"></i> Add Manual Product</h3>
                                <button class="ws-modal-close" onclick="closeManualProductModal()">
                                    <i class="fas fa-times"></i>
                                </button>
                            </div>
                            <div class="ws-modal-body">
                                <form id="wsManualProductForm">
                                    <div class="ws-form-grid">
                                        <div class="ws-form-field full-width">
                                            <label>Product Name *</label>
                                            <input type="text" id="wsManualProductName" required>
                                        </div>
                                        <div class="ws-form-field">
                                            <label>Unit Price (Ksh) *</label>
                                            <input type="number" id="wsManualProductPrice" min="0" step="0.01" required>
                                        </div>
                                        <div class="ws-form-field">
                                            <label>Quantity *</label>
                                            <input type="number" id="wsManualProductQty" min="1" value="1" required>
                                        </div>
                                    </div>
                                </form>
                            </div>
                            <div class="ws-modal-footer">
                                <button class="ws-btn-secondary" onclick="closeManualProductModal()">Cancel</button>
                                <button class="ws-btn-primary" onclick="addManualProduct()">
                                    <i class="fas fa-cart-plus"></i> Add to Cart
                                </button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Manage Wholesale Module -->
                <div class="module-content" id="module-wholesale-manage">
                    <div class="module-header">
                        <div class="module-header-text">
                            <h1>Manage Wholesale</h1>
                            <p>View and manage wholesale orders and sales</p>
                        </div>
                        <div class="mw-quick-actions">
                            <button class="mw-action-btn mw-btn-create" onclick="showModule('wholesale-create')">
                                <i class="fas fa-plus"></i> New Sale
                            </button>
                            <button class="mw-action-btn mw-btn-export" onclick="exportWholesalePDF()">
                                <i class="fas fa-file-pdf"></i> Export PDF
                            </button>
                        </div>
                    </div>
                    <div class="module-body">
                        <!-- Stats Cards -->
                        <div class="mw-stats">
                            <div class="mw-stat-card">
                                <div class="mw-stat-icon mw-icon-total">
                                    <i class="fas fa-receipt"></i>
                                </div>
                                <div class="mw-stat-info">
                                    <span class="mw-stat-value" id="mwTotalOrders">0</span>
                                    <span class="mw-stat-label">Total Orders</span>
                                </div>
                            </div>
                            <div class="mw-stat-card">
                                <div class="mw-stat-icon mw-icon-revenue">
                                    <i class="fas fa-coins"></i>
                                </div>
                                <div class="mw-stat-info">
                                    <span class="mw-stat-value" id="mwTotalRevenue">Ksh 0</span>
                                    <span class="mw-stat-label">Total Revenue</span>
                                </div>
                            </div>
                            <div class="mw-stat-card">
                                <div class="mw-stat-icon mw-icon-today">
                                    <i class="fas fa-calendar-day"></i>
                                </div>
                                <div class="mw-stat-info">
                                    <span class="mw-stat-value" id="mwTodaySales">Ksh 0</span>
                                    <span class="mw-stat-label">Today's Sales</span>
                                </div>
                            </div>
                            <div class="mw-stat-card">
                                <div class="mw-stat-icon mw-icon-pending">
                                    <i class="fas fa-clock"></i>
                                </div>
                                <div class="mw-stat-info">
                                    <span class="mw-stat-value" id="mwPendingOrders">0</span>
                                    <span class="mw-stat-label">Drafts/Pending</span>
                                </div>
                            </div>
                        </div>

                        <!-- Filters Section -->
                        <div class="mw-filters">
                            <div class="mw-search-box">
                                <i class="fas fa-search"></i>
                                <input type="text" id="mwSearchInput" placeholder="Search by customer, order ID...">
                            </div>
                            <div class="mw-filter-group">
                                <select id="mwStatusFilter">
                                    <option value="">All Status</option>
                                    <option value="completed">Completed</option>
                                    <option value="draft">Draft</option>
                                    <option value="cancelled">Cancelled</option>
                                </select>
                                <select id="mwPaymentFilter">
                                    <option value="">All Payments</option>
                                    <option value="cash">Cash</option>
                                    <option value="mpesa">M-Pesa</option>
                                    <option value="bank">Bank Transfer</option>
                                    <option value="credit">Credit</option>
                                </select>
                                <input type="date" id="mwDateFrom" title="From Date">
                                <input type="date" id="mwDateTo" title="To Date">
                                <button class="mw-filter-btn" onclick="resetWholesaleFilters()">
                                    <i class="fas fa-redo"></i> Reset
                                </button>
                            </div>
                        </div>

                        <!-- Orders Table -->
                        <div class="mw-table-container">
                            <table class="mw-table">
                                <thead>
                                    <tr>
                                        <th>Order ID</th>
                                        <th>Date</th>
                                        <th>Customer</th>
                                        <th>Items</th>
                                        <th>Total</th>
                                        <th>Payment</th>
                                        <th>Status</th>
                                        <th>Actions</th>
                                    </tr>
                                </thead>
                                <tbody id="mwTableBody">
                                    <tr class="mw-empty-row">
                                        <td colspan="8">
                                            <div class="mw-empty-state">
                                                <i class="fas fa-inbox"></i>
                                                <p>No wholesale orders found</p>
                                            </div>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>

                        <!-- Pagination -->
                        <div class="mw-pagination">
                            <span class="mw-page-info" id="mwPageInfo">Showing 0 of 0 orders</span>
                            <div class="mw-page-controls">
                                <button class="mw-page-btn" id="mwPrevBtn" onclick="prevWholesalePage()" disabled>
                                    <i class="fas fa-chevron-left"></i> Previous
                                </button>
                                <button class="mw-page-btn" id="mwNextBtn" onclick="nextWholesalePage()" disabled>
                                    Next <i class="fas fa-chevron-right"></i>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- View Wholesale Order Modal -->
                <div class="mw-modal-overlay" id="mwViewModal">
                    <div class="mw-modal">
                        <div class="mw-modal-header">
                            <h3><i class="fas fa-eye"></i> Order Details</h3>
                            <button class="mw-modal-close" onclick="closeWholesaleViewModal()">&times;</button>
                        </div>
                        <div class="mw-modal-body" id="mwViewContent">
                            <!-- Content loaded dynamically -->
                        </div>
                        <div class="mw-modal-footer">
                            <button class="mw-btn-secondary" onclick="closeWholesaleViewModal()">Close</button>
                            <button class="mw-btn-primary" onclick="printWholesaleOrder()">
                                <i class="fas fa-print"></i> Print
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Edit Wholesale Order Modal -->
                <div class="mw-modal-overlay" id="mwEditModal">
                    <div class="mw-modal mw-modal-large">
                        <div class="mw-modal-header">
                            <h3><i class="fas fa-edit"></i> Edit Order</h3>
                            <button class="mw-modal-close" onclick="closeWholesaleEditModal()">&times;</button>
                        </div>
                        <div class="mw-modal-body">
                            <div class="mw-edit-content">
                                <!-- Order Info -->
                                <div class="mw-edit-section">
                                    <h4>Order Information</h4>
                                    <div class="mw-edit-grid">
                                        <div class="mw-edit-field">
                                            <label>Order ID</label>
                                            <input type="text" id="mwEditOrderId" readonly>
                                        </div>
                                        <div class="mw-edit-field">
                                            <label>Status</label>
                                            <select id="mwEditStatus">
                                                <option value="completed">Completed</option>
                                                <option value="draft">Draft</option>
                                                <option value="cancelled">Cancelled</option>
                                            </select>
                                        </div>
                                        <div class="mw-edit-field">
                                            <label>Payment Method</label>
                                            <select id="mwEditPayment">
                                                <option value="cash">Cash</option>
                                                <option value="mpesa">M-Pesa</option>
                                                <option value="bank">Bank Transfer</option>
                                                <option value="credit">Credit</option>
                                            </select>
                                        </div>
                                        <div class="mw-edit-field">
                                            <label>Customer</label>
                                            <input type="text" id="mwEditCustomer" placeholder="Customer name">
                                        </div>
                                    </div>
                                </div>

                                <!-- Items Section -->
                                <div class="mw-edit-section">
                                    <div class="mw-edit-section-header">
                                        <h4>Order Items</h4>
                                        <button class="mw-add-item-btn" onclick="addEditOrderItem()">
                                            <i class="fas fa-plus"></i> Add Item
                                        </button>
                                    </div>
                                    <div class="mw-edit-items-table">
                                        <table>
                                            <thead>
                                                <tr>
                                                    <th>Product</th>
                                                    <th>Price</th>
                                                    <th>Qty</th>
                                                    <th>Total</th>
                                                    <th></th>
                                                </tr>
                                            </thead>
                                            <tbody id="mwEditItemsBody">
                                                <!-- Items loaded dynamically -->
                                            </tbody>
                                        </table>
                                    </div>
                                </div>

                                <!-- Summary -->
                                <div class="mw-edit-section">
                                    <h4>Summary</h4>
                                    <div class="mw-edit-summary">
                                        <div class="mw-edit-summary-row">
                                            <span>Subtotal</span>
                                            <span id="mwEditSubtotal">Ksh 0.00</span>
                                        </div>
                                        <div class="mw-edit-summary-row">
                                            <span>Discount (Ksh)</span>
                                            <input type="number" id="mwEditDiscount" value="0" min="0" onchange="recalculateEditTotals()">
                                        </div>
                                        <div class="mw-edit-summary-row">
                                            <span>Tax (%)</span>
                                            <input type="number" id="mwEditTax" value="0" min="0" max="100" onchange="recalculateEditTotals()">
                                        </div>
                                        <div class="mw-edit-summary-row mw-edit-grand-total">
                                            <span>Grand Total</span>
                                            <span id="mwEditGrandTotal">Ksh 0.00</span>
                                        </div>
                                    </div>
                                </div>

                                <!-- Notes -->
                                <div class="mw-edit-section">
                                    <h4>Notes</h4>
                                    <textarea id="mwEditNotes" placeholder="Order notes..."></textarea>
                                </div>
                            </div>
                        </div>
                        <div class="mw-modal-footer">
                            <button class="mw-btn-secondary" onclick="closeWholesaleEditModal()">Cancel</button>
                            <button class="mw-btn-primary" onclick="saveWholesaleOrderEdit()">
                                <i class="fas fa-save"></i> Save Changes
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Customers Module -->
                <div class="module-content" id="module-customers">
                    <div class="module-header">
                        <h1>Customers</h1>
                        <p>Manage customer information and history</p>
                    </div>
                    <div class="module-body">
                        <div class="placeholder-content">
                            <i class="fas fa-users"></i>
                            <h2>Customers Module</h2>
                            <p>This module is ready for future implementation.</p>
                        </div>
                    </div>
                </div>

                <!-- Add Customer Module -->
                <div class="module-content" id="module-customers-add">
                    <div class="module-header">
                        <div>
                            <h1>Add Customer</h1>
                            <p>Add a new customer to the system</p>
                        </div>
                        <div class="module-header-actions">
                            <button class="btn-module-action btn-view-orders" data-module="customers-manage">
                                <i class="fas fa-users"></i> Manage Customers
                            </button>
                        </div>
                    </div>
                    <div class="module-body">
                        <div class="customer-form-container">
                            <form id="addCustomerForm" class="customer-form">
                                <div class="form-section">
                                    <h2 class="section-title"><i class="fas fa-user"></i> Customer Information</h2>
                                    <div class="form-grid">
                                        <div class="form-field">
                                            <label for="customerName">Full Name *</label>
                                            <input type="text" id="customerName" placeholder="Enter customer name" required>
                                        </div>
                                        <div class="form-field">
                                            <label for="customerPhone">Phone Number *</label>
                                            <input type="tel" id="customerPhone" placeholder="e.g., +254712345678" required>
                                        </div>
                                        <div class="form-field">
                                            <label for="customerEmail">Email Address</label>
                                            <input type="email" id="customerEmail" placeholder="customer@email.com">
                                        </div>
                                        <div class="form-field">
                                            <label for="customerAddress">Address</label>
                                            <input type="text" id="customerAddress" placeholder="Enter address">
                                        </div>
                                        <div class="form-field full-width">
                                            <label for="customerNotes">Notes</label>
                                            <textarea id="customerNotes" rows="3" placeholder="Additional notes about the customer (allergies, preferences, etc.)"></textarea>
                                        </div>
                                    </div>
                                </div>
                                <div class="form-actions">
                                    <button type="submit" class="btn-primary">
                                        <i class="fas fa-save"></i> Save Customer
                                    </button>
                                    <button type="reset" class="btn-secondary">
                                        <i class="fas fa-times"></i> Clear Form
                                    </button>
                                </div>
                            </form>
                        </div>
                    </div>
                </div>

                <!-- Manage Customers Module -->
                <div class="module-content" id="module-customers-manage">
                    <div class="module-header">
                        <div>
                            <h1>Manage Customers</h1>
                            <p>View and manage all customers</p>
                        </div>
                        <div class="module-header-actions">
                            <button class="btn-module-action" onclick="showModule('module-customers-add')" style="background-color: #28a745; color: white;">
                                <i class="fas fa-plus"></i> Add Customer
                            </button>
                            <button class="mc-action-btn mc-btn-edit" id="mcEditCustomer" disabled>
                                <i class="fas fa-edit"></i> Edit
                            </button>
                            <button class="mc-action-btn mc-btn-delete" id="mcDeleteCustomer" disabled>
                                <i class="fas fa-trash"></i> Delete
                            </button>
                        </div>
                    </div>
                    <div class="module-body">
                        <!-- Stats Cards -->
                        <div class="manage-customers-stats">
                            <div class="mc-stat-card">
                                <div class="mc-stat-icon" style="background-color: #e3f2fd;">
                                    <i class="fas fa-users" style="color: #2196f3;"></i>
                                </div>
                                <div class="mc-stat-details">
                                    <span class="mc-stat-label">Total Customers</span>
                                    <span class="mc-stat-value" id="mcTotalCustomers">0</span>
                                </div>
                            </div>
                            <div class="mc-stat-card">
                                <div class="mc-stat-icon" style="background-color: #e8f5e9;">
                                    <i class="fas fa-user-check" style="color: #4caf50;"></i>
                                </div>
                                <div class="mc-stat-details">
                                    <span class="mc-stat-label">Active Customers</span>
                                    <span class="mc-stat-value" id="mcActiveCustomers">0</span>
                                </div>
                            </div>
                            <div class="mc-stat-card">
                                <div class="mc-stat-icon" style="background-color: #fff3e0;">
                                    <i class="fas fa-clock" style="color: #ff9800;"></i>
                                </div>
                                <div class="mc-stat-details">
                                    <span class="mc-stat-label">New This Month</span>
                                    <span class="mc-stat-value" id="mcNewCustomers">0</span>
                                </div>
                            </div>
                            <div class="mc-stat-card">
                                <div class="mc-stat-icon" style="background-color: #f3e5f5;">
                                    <i class="fas fa-shopping-cart" style="color: #9c27b0;"></i>
                                </div>
                                <div class="mc-stat-details">
                                    <span class="mc-stat-label">Total Purchases</span>
                                    <span class="mc-stat-value" id="mcTotalPurchases">Ksh 0</span>
                                </div>
                            </div>
                        </div>

                        <!-- Controls -->
                        <div class="manage-customers-controls">
                            <div class="mc-controls-left">
                                <div class="mc-filter-group">
                                    <label for="mcStatusFilter">Status:</label>
                                    <select id="mcStatusFilter" class="mc-filter-select">
                                        <option value="all">All Customers</option>
                                        <option value="active">Active</option>
                                        <option value="inactive">Inactive</option>
                                    </select>
                                </div>
                                <div class="mc-search-group">
                                    <i class="fas fa-search mc-search-icon"></i>
                                    <input type="text" id="mcSearchInput" class="mc-search-input" placeholder="Search by name, phone, or email...">
                                </div>
                            </div>
                            <div class="mc-controls-right">
                                <button class="mc-btn mc-btn-refresh" id="mcRefreshBtn">
                                    <i class="fas fa-sync-alt"></i> Refresh
                                </button>
                            </div>
                        </div>

                        <!-- Customers Table -->
                        <div class="manage-customers-table-container">
                            <table class="manage-customers-table">
                                <thead>
                                    <tr>
                                        <th><input type="checkbox" id="mcSelectAll"></th>
                                        <th>ID</th>
                                        <th>Name</th>
                                        <th>Phone</th>
                                        <th>Email</th>
                                        <th>Address</th>
                                        <th>Status</th>
                                        <th>Actions</th>
                                    </tr>
                                </thead>
                                <tbody id="mcCustomersTableBody">
                                    <tr>
                                        <td colspan="8" class="mc-loading">
                                            <i class="fas fa-spinner fa-spin"></i> Loading customers...
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>

                        <!-- Pagination -->
                        <div class="manage-customers-pagination">
                            <div class="mc-pagination-info">
                                Showing <span id="mcShowingStart">0</span> to <span id="mcShowingEnd">0</span> of <span id="mcTotalRecords">0</span> customers
                            </div>
                            <div class="mc-pagination-controls">
                                <button class="mc-btn-page" id="mcPrevPage" disabled>
                                    <i class="fas fa-chevron-left"></i> Previous
                                </button>
                                <span class="mc-page-info">Page <span id="mcCurrentPage">1</span> of <span id="mcTotalPages">1</span></span>
                                <button class="mc-btn-page" id="mcNextPage" disabled>
                                    Next <i class="fas fa-chevron-right"></i>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- View Customer Modal -->
                <div class="mc-modal-overlay" id="mcViewModal">
                    <div class="mc-modal">
                        <div class="mc-modal-header">
                            <h2><i class="fas fa-user"></i> Customer Details</h2>
                            <button class="mc-modal-close" onclick="window.manageCustomersModule.closeViewModal()">
                                <i class="fas fa-times"></i>
                            </button>
                        </div>
                        <div class="mc-modal-body">
                            <div class="mc-view-grid">
                                <div class="mc-view-field">
                                    <label>Customer ID</label>
                                    <span id="mcViewId">-</span>
                                </div>
                                <div class="mc-view-field">
                                    <label>Full Name</label>
                                    <span id="mcViewName">-</span>
                                </div>
                                <div class="mc-view-field">
                                    <label>Phone Number</label>
                                    <span id="mcViewPhone">-</span>
                                </div>
                                <div class="mc-view-field">
                                    <label>Email Address</label>
                                    <span id="mcViewEmail">-</span>
                                </div>
                                <div class="mc-view-field">
                                    <label>Address</label>
                                    <span id="mcViewAddress">-</span>
                                </div>
                                <div class="mc-view-field">
                                    <label>Status</label>
                                    <span id="mcViewStatus">-</span>
                                </div>
                                <div class="mc-view-field full-width">
                                    <label>Notes</label>
                                    <span id="mcViewNotes">-</span>
                                </div>
                                <div class="mc-view-field">
                                    <label>Created</label>
                                    <span id="mcViewCreated">-</span>
                                </div>
                                <div class="mc-view-field">
                                    <label>Last Updated</label>
                                    <span id="mcViewUpdated">-</span>
                                </div>
                            </div>
                        </div>
                        <div class="mc-modal-footer">
                            <button class="mc-modal-btn mc-btn-secondary" onclick="window.manageCustomersModule.closeViewModal()">
                                Close
                            </button>
                            <button class="mc-modal-btn mc-btn-primary" onclick="window.manageCustomersModule.openEditFromView()">
                                <i class="fas fa-edit"></i> Edit Customer
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Edit Customer Modal -->
                <div class="mc-modal-overlay" id="mcEditModal">
                    <div class="mc-modal">
                        <div class="mc-modal-header">
                            <h2><i class="fas fa-edit"></i> Edit Customer</h2>
                            <button class="mc-modal-close" onclick="window.manageCustomersModule.closeEditModal()">
                                <i class="fas fa-times"></i>
                            </button>
                        </div>
                        <form id="mcEditForm">
                            <div class="mc-modal-body">
                                <input type="hidden" id="mcEditId">
                                <div class="mc-edit-grid">
                                    <div class="mc-edit-field">
                                        <label for="mcEditName">Full Name *</label>
                                        <input type="text" id="mcEditName" required>
                                    </div>
                                    <div class="mc-edit-field">
                                        <label for="mcEditPhone">Phone Number *</label>
                                        <input type="tel" id="mcEditPhone" required>
                                    </div>
                                    <div class="mc-edit-field">
                                        <label for="mcEditEmail">Email Address</label>
                                        <input type="email" id="mcEditEmail">
                                    </div>
                                    <div class="mc-edit-field">
                                        <label for="mcEditAddress">Address</label>
                                        <input type="text" id="mcEditAddress">
                                    </div>
                                    <div class="mc-edit-field">
                                        <label for="mcEditStatus">Status</label>
                                        <select id="mcEditStatus">
                                            <option value="active">Active</option>
                                            <option value="inactive">Inactive</option>
                                        </select>
                                    </div>
                                    <div class="mc-edit-field full-width">
                                        <label for="mcEditNotes">Notes</label>
                                        <textarea id="mcEditNotes" rows="3"></textarea>
                                    </div>
                                </div>
                            </div>
                            <div class="mc-modal-footer">
                                <button type="button" class="mc-modal-btn mc-btn-secondary" onclick="window.manageCustomersModule.closeEditModal()">
                                    Cancel
                                </button>
                                <button type="submit" class="mc-modal-btn mc-btn-primary" id="mcEditSaveBtn">
                                    <i class="fas fa-save"></i> Save Changes
                                </button>
                            </div>
                        </form>
                    </div>
                </div>

                <!-- Expenses Module -->
                <div class="module-content" id="module-expenses">
                    <div class="module-header">
                        <h1>Expenses</h1>
                        <p>Track and manage pharmacy expenses</p>
                    </div>
                    <div class="module-body">
                        <div class="placeholder-content">
                            <i class="fas fa-money-bill-wave"></i>
                            <h2>Expenses Module</h2>
                            <p>This module is ready for future implementation.</p>
                        </div>
                    </div>
                </div>

                <!-- Add Expense Module -->
                <div class="module-content" id="module-expenses-add">
                    <div class="module-header">
                        <div>
                            <h1>Add Expense</h1>
                            <p>Record a new expense</p>
                        </div>
                        <div class="module-header-actions">
                            <button class="btn-module-action" onclick="showModule('module-expenses-manage')" style="background-color: #3b82f6; color: white;">
                                <i class="fas fa-list"></i> View Expenses
                            </button>
                        </div>
                    </div>
                    <div class="module-body">
                        <div class="expense-form-container">
                            <form id="addExpenseForm" class="expense-form">
                                <div class="form-section">
                                    <h2 class="section-title"><i class="fas fa-receipt"></i> Expense Details</h2>
                                    <div class="form-grid">
                                        <div class="form-field">
                                            <label for="expenseCategory">Category *</label>
                                            <select id="expenseCategory" required>
                                                <option value="">Select Category</option>
                                                <option value="utilities">Utilities</option>
                                                <option value="rent">Rent</option>
                                                <option value="salaries">Salaries</option>
                                                <option value="supplies">Supplies</option>
                                                <option value="maintenance">Maintenance</option>
                                                <option value="transport">Transport</option>
                                                <option value="marketing">Marketing</option>
                                                <option value="insurance">Insurance</option>
                                                <option value="taxes">Taxes</option>
                                                <option value="other">Other</option>
                                            </select>
                                        </div>
                                        <div class="form-field">
                                            <label for="expenseAmount">Amount (Ksh) *</label>
                                            <input type="number" id="expenseAmount" placeholder="0.00" min="0" step="0.01" required>
                                        </div>
                                        <div class="form-field">
                                            <label for="expenseDate">Date *</label>
                                            <input type="date" id="expenseDate" required>
                                        </div>
                                        <div class="form-field">
                                            <label for="expensePaymentMethod">Payment Method</label>
                                            <select id="expensePaymentMethod">
                                                <option value="cash">Cash</option>
                                                <option value="mpesa">M-Pesa</option>
                                                <option value="bank">Bank Transfer</option>
                                                <option value="cheque">Cheque</option>
                                            </select>
                                        </div>
                                        <div class="form-field full-width">
                                            <label for="expenseDescription">Description *</label>
                                            <input type="text" id="expenseDescription" placeholder="Brief description of the expense" required>
                                        </div>
                                        <div class="form-field full-width">
                                            <label for="expenseNotes">Additional Notes</label>
                                            <textarea id="expenseNotes" rows="3" placeholder="Any additional details or reference numbers..."></textarea>
                                        </div>
                                    </div>
                                </div>
                                <div class="form-actions">
                                    <button type="submit" class="btn-primary" style="background-color: #10b981; color: white; border: none;">
                                        <i class="fas fa-save"></i> Save Expense
                                    </button>
                                    <button type="reset" class="btn-secondary" style="background-color: #ef4444; color: white; border: none;">
                                        <i class="fas fa-times"></i> Clear Form
                                    </button>
                                </div>
                            </form>
                        </div>
                    </div>
                </div>

                <!-- Manage Expenses Module -->
                <div class="module-content" id="module-expenses-manage">
                    <div class="module-header">
                        <div>
                            <h1>Manage Expenses</h1>
                            <p>View and manage all expenses</p>
                        </div>
                        <div class="module-header-actions">
                            <button class="btn-module-action" onclick="exportExpensesPDF()" style="background-color: #ef4444; color: white;">
                                <i class="fas fa-file-pdf"></i> Export PDF
                            </button>
                            <button class="btn-module-action" onclick="showModule('module-expenses-add')" style="background-color: #10b981; color: white;">
                                <i class="fas fa-plus"></i> Add Expense
                            </button>
                        </div>
                    </div>
                    <div class="module-body">
                        <!-- Stats Cards -->
                        <div class="me-stats">
                            <div class="me-stat-card">
                                <div class="me-stat-icon" style="background-color: rgba(239, 68, 68, 0.1); color: #ef4444;">
                                    <i class="fas fa-money-bill-wave"></i>
                                </div>
                                <div class="me-stat-info">
                                    <span class="me-stat-value" id="meTotalExpenses">Ksh 0</span>
                                    <span class="me-stat-label">Total Expenses</span>
                                </div>
                            </div>
                            <div class="me-stat-card">
                                <div class="me-stat-icon" style="background-color: rgba(59, 130, 246, 0.1); color: #3b82f6;">
                                    <i class="fas fa-calendar-day"></i>
                                </div>
                                <div class="me-stat-info">
                                    <span class="me-stat-value" id="meTodayExpenses">Ksh 0</span>
                                    <span class="me-stat-label">Today's Expenses</span>
                                </div>
                            </div>
                            <div class="me-stat-card">
                                <div class="me-stat-icon" style="background-color: rgba(16, 185, 129, 0.1); color: #10b981;">
                                    <i class="fas fa-receipt"></i>
                                </div>
                                <div class="me-stat-info">
                                    <span class="me-stat-value" id="meExpenseCount">0</span>
                                    <span class="me-stat-label">Total Records</span>
                                </div>
                            </div>
                            <div class="me-stat-card">
                                <div class="me-stat-icon" style="background-color: rgba(139, 92, 246, 0.1); color: #8b5cf6;">
                                    <i class="fas fa-chart-line"></i>
                                </div>
                                <div class="me-stat-info">
                                    <span class="me-stat-value" id="meMonthExpenses">Ksh 0</span>
                                    <span class="me-stat-label">This Month</span>
                                </div>
                            </div>
                        </div>

                        <!-- Filters and Search -->
                        <div class="me-filters">
                            <div class="me-search-box">
                                <i class="fas fa-search"></i>
                                <input type="text" id="meSearchInput" placeholder="Search expenses...">
                            </div>
                            <div class="me-filter-group">
                                <select id="meCategoryFilter">
                                    <option value="">All Categories</option>
                                    <option value="utilities">Utilities</option>
                                    <option value="rent">Rent</option>
                                    <option value="salaries">Salaries</option>
                                    <option value="supplies">Supplies</option>
                                    <option value="maintenance">Maintenance</option>
                                    <option value="transport">Transport</option>
                                    <option value="marketing">Marketing</option>
                                    <option value="insurance">Insurance</option>
                                    <option value="taxes">Taxes</option>
                                    <option value="other">Other</option>
                                </select>
                                <select id="mePaymentFilter">
                                    <option value="">All Payment Methods</option>
                                    <option value="cash">Cash</option>
                                    <option value="mpesa">M-Pesa</option>
                                    <option value="bank">Bank Transfer</option>
                                    <option value="cheque">Cheque</option>
                                </select>
                                <select id="meStatusFilter">
                                    <option value="">All Status</option>
                                    <option value="pending">Pending</option>
                                    <option value="approved">Approved</option>
                                    <option value="cancelled">Cancelled</option>
                                </select>
                                <input type="date" id="meDateFilter" title="Filter by date">
                            </div>
                        </div>

                        <!-- Expenses Table -->
                        <div class="me-table-container">
                            <table class="me-table">
                                <thead>
                                    <tr>
                                        <th>Date</th>
                                        <th>Category</th>
                                        <th>Description</th>
                                        <th>Payment Method</th>
                                        <th>Amount</th>
                                        <th>Status</th>
                                        <th>Actions</th>
                                    </tr>
                                </thead>
                                <tbody id="meTableBody">
                                    <tr>
                                        <td colspan="7" class="me-loading">
                                            <i class="fas fa-spinner fa-spin"></i> Loading expenses...
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>

                        <!-- Pagination -->
                        <div class="me-pagination">
                            <div class="me-pagination-info">
                                Showing <span id="meShowingStart">0</span> - <span id="meShowingEnd">0</span> of <span id="meTotalRecords">0</span> expenses
                            </div>
                            <div class="me-pagination-controls">
                                <button id="mePrevBtn" class="me-page-btn" disabled>
                                    <i class="fas fa-chevron-left"></i> Previous
                                </button>
                                <span class="me-page-number">Page <span id="meCurrentPage">1</span></span>
                                <button id="meNextBtn" class="me-page-btn">
                                    Next <i class="fas fa-chevron-right"></i>
                                </button>
                            </div>
                        </div>
                    </div>

                    <!-- View Expense Modal -->
                    <div class="me-modal-overlay" id="meViewModal">
                        <div class="me-modal">
                            <div class="me-modal-header">
                                <h2><i class="fas fa-receipt"></i> Expense Details</h2>
                                <button class="me-modal-close" onclick="closeViewExpenseModal()">
                                    <i class="fas fa-times"></i>
                                </button>
                            </div>
                            <div class="me-modal-body">
                                <div class="me-view-grid" id="meViewContent">
                                    <!-- Content populated by JS -->
                                </div>
                            </div>
                            <div class="me-modal-footer">
                                <button class="me-modal-btn me-btn-secondary" onclick="closeViewExpenseModal()">
                                    <i class="fas fa-times"></i> Close
                                </button>
                            </div>
                        </div>
                    </div>

                    <!-- Edit Expense Modal -->
                    <div class="me-modal-overlay" id="meEditModal">
                        <div class="me-modal">
                            <div class="me-modal-header">
                                <h2><i class="fas fa-edit"></i> Edit Expense</h2>
                                <button class="me-modal-close" onclick="closeEditExpenseModal()">
                                    <i class="fas fa-times"></i>
                                </button>
                            </div>
                            <div class="me-modal-body">
                                <form id="meEditForm" class="me-edit-form">
                                    <input type="hidden" id="meEditId">
                                    <div class="me-edit-grid">
                                        <div class="me-form-field">
                                            <label for="meEditCategory">Category *</label>
                                            <select id="meEditCategory" required>
                                                <option value="">Select Category</option>
                                                <option value="utilities">Utilities</option>
                                                <option value="rent">Rent</option>
                                                <option value="salaries">Salaries</option>
                                                <option value="supplies">Supplies</option>
                                                <option value="maintenance">Maintenance</option>
                                                <option value="transport">Transport</option>
                                                <option value="marketing">Marketing</option>
                                                <option value="insurance">Insurance</option>
                                                <option value="taxes">Taxes</option>
                                                <option value="other">Other</option>
                                            </select>
                                        </div>
                                        <div class="me-form-field">
                                            <label for="meEditAmount">Amount (Ksh) *</label>
                                            <input type="number" id="meEditAmount" min="0" step="0.01" required>
                                        </div>
                                        <div class="me-form-field">
                                            <label for="meEditDate">Date *</label>
                                            <input type="date" id="meEditDate" required>
                                        </div>
                                        <div class="me-form-field">
                                            <label for="meEditPayment">Payment Method</label>
                                            <select id="meEditPayment">
                                                <option value="cash">Cash</option>
                                                <option value="mpesa">M-Pesa</option>
                                                <option value="bank">Bank Transfer</option>
                                                <option value="cheque">Cheque</option>
                                            </select>
                                        </div>
                                        <div class="me-form-field full-width">
                                            <label for="meEditDescription">Description *</label>
                                            <input type="text" id="meEditDescription" required>
                                        </div>
                                        <div class="me-form-field full-width">
                                            <label for="meEditNotes">Notes</label>
                                            <textarea id="meEditNotes" rows="3"></textarea>
                                        </div>
                                    </div>
                                </form>
                            </div>
                            <div class="me-modal-footer">
                                <button class="me-modal-btn me-btn-secondary" onclick="closeEditExpenseModal()">
                                    <i class="fas fa-times"></i> Cancel
                                </button>
                                <button class="me-modal-btn me-btn-primary" onclick="saveEditedExpense()">
                                    <i class="fas fa-save"></i> Save Changes
                                </button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Reports Module -->
                <div class="module-content" id="module-reports">
                    <div class="module-header">
                        <h1>Reports</h1>
                        <p>View sales, inventory and financial reports</p>
                    </div>
                    <div class="module-body">
                        <div class="placeholder-content">
                            <i class="fas fa-chart-bar"></i>
                            <h2>Reports Module</h2>
                            <p>This module is ready for future implementation.</p>
                        </div>
                    </div>
                </div>

                <!-- Generate Report Module -->
                <div class="module-content" id="module-reports-generate">
                    <div class="module-header">
                        <div class="rpt-header-text">
                            <h1>Generate Report</h1>
                            <p>Create comprehensive reports across all modules</p>
                        </div>
                        <div class="rpt-header-actions">
                            <button class="rpt-action-btn rpt-btn-refresh" onclick="refreshReportData()">
                                <i class="fas fa-sync-alt"></i> Refresh Data
                            </button>
                        </div>
                    </div>
                    <div class="module-body">
                        <!-- Real-time Analytics Cards -->
                        <div class="rpt-analytics-section">
                            <div class="rpt-section-title">
                                <i class="fas fa-chart-line"></i>
                                <span>Real-time Analytics</span>
                                <span class="rpt-live-badge"><i class="fas fa-circle"></i> Live</span>
                            </div>
                            <div class="rpt-analytics-grid">
                                <div class="rpt-analytics-card rpt-card-green">
                                    <div class="rpt-card-icon"><i class="fas fa-coins"></i></div>
                                    <div class="rpt-card-data">
                                        <span class="rpt-card-value" id="rptTotalRevenue">Ksh 0.00</span>
                                        <span class="rpt-card-label">Total Revenue</span>
                                    </div>
                                </div>
                                <div class="rpt-analytics-card rpt-card-blue">
                                    <div class="rpt-card-icon"><i class="fas fa-shopping-cart"></i></div>
                                    <div class="rpt-card-data">
                                        <span class="rpt-card-value" id="rptTotalSales">0</span>
                                        <span class="rpt-card-label">Total Sales</span>
                                    </div>
                                </div>
                                <div class="rpt-analytics-card rpt-card-purple">
                                    <div class="rpt-card-icon"><i class="fas fa-boxes"></i></div>
                                    <div class="rpt-card-data">
                                        <span class="rpt-card-value" id="rptTotalInventory">0</span>
                                        <span class="rpt-card-label">Inventory Items</span>
                                    </div>
                                </div>
                                <div class="rpt-analytics-card rpt-card-amber">
                                    <div class="rpt-card-icon"><i class="fas fa-users"></i></div>
                                    <div class="rpt-card-data">
                                        <span class="rpt-card-value" id="rptTotalCustomers">0</span>
                                        <span class="rpt-card-label">Customers</span>
                                    </div>
                                </div>
                                <div class="rpt-analytics-card rpt-card-cyan">
                                    <div class="rpt-card-icon"><i class="fas fa-truck"></i></div>
                                    <div class="rpt-card-data">
                                        <span class="rpt-card-value" id="rptTotalSuppliers">0</span>
                                        <span class="rpt-card-label">Suppliers</span>
                                    </div>
                                </div>
                                <div class="rpt-analytics-card rpt-card-rose">
                                    <div class="rpt-card-icon"><i class="fas fa-receipt"></i></div>
                                    <div class="rpt-card-data">
                                        <span class="rpt-card-value" id="rptTotalExpenses">Ksh 0.00</span>
                                        <span class="rpt-card-label">Total Expenses</span>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Report Generator -->
                        <div class="rpt-generator-section">
                            <div class="rpt-section-title">
                                <i class="fas fa-file-alt"></i>
                                <span>Report Generator</span>
                            </div>
                            <div class="rpt-generator-grid">
                                <!-- Report Type Selection -->
                                <div class="rpt-form-panel">
                                    <h4>Select Report Type</h4>
                                    <div class="rpt-type-grid">
                                        <label class="rpt-type-option">
                                            <input type="radio" name="reportType" value="sales" checked>
                                            <div class="rpt-type-card">
                                                <i class="fas fa-shopping-bag"></i>
                                                <span>Sales Report</span>
                                            </div>
                                        </label>
                                        <label class="rpt-type-option">
                                            <input type="radio" name="reportType" value="inventory">
                                            <div class="rpt-type-card">
                                                <i class="fas fa-boxes"></i>
                                                <span>Inventory Report</span>
                                            </div>
                                        </label>
                                        <label class="rpt-type-option">
                                            <input type="radio" name="reportType" value="wholesale">
                                            <div class="rpt-type-card">
                                                <i class="fas fa-truck-loading"></i>
                                                <span>Wholesale Report</span>
                                            </div>
                                        </label>
                                        <label class="rpt-type-option">
                                            <input type="radio" name="reportType" value="expenses">
                                            <div class="rpt-type-card">
                                                <i class="fas fa-money-bill-wave"></i>
                                                <span>Expense Report</span>
                                            </div>
                                        </label>
                                        <label class="rpt-type-option">
                                            <input type="radio" name="reportType" value="customers">
                                            <div class="rpt-type-card">
                                                <i class="fas fa-users"></i>
                                                <span>Customer Report</span>
                                            </div>
                                        </label>
                                        <label class="rpt-type-option">
                                            <input type="radio" name="reportType" value="suppliers">
                                            <div class="rpt-type-card">
                                                <i class="fas fa-truck"></i>
                                                <span>Supplier Report</span>
                                            </div>
                                        </label>
                                        <label class="rpt-type-option">
                                            <input type="radio" name="reportType" value="profit">
                                            <div class="rpt-type-card">
                                                <i class="fas fa-chart-pie"></i>
                                                <span>Profit & Loss</span>
                                            </div>
                                        </label>
                                        <label class="rpt-type-option">
                                            <input type="radio" name="reportType" value="comprehensive">
                                            <div class="rpt-type-card">
                                                <i class="fas fa-file-invoice"></i>
                                                <span>Full Report</span>
                                            </div>
                                        </label>
                                    </div>
                                </div>

                                <!-- Report Filters -->
                                <div class="rpt-form-panel">
                                    <h4>Report Filters</h4>
                                    <div class="rpt-filters-form">
                                        <div class="rpt-form-row">
                                            <div class="rpt-form-group">
                                                <label>Date Range</label>
                                                <select id="rptDateRange">
                                                    <option value="today">Today</option>
                                                    <option value="yesterday">Yesterday</option>
                                                    <option value="week">This Week</option>
                                                    <option value="month" selected>This Month</option>
                                                    <option value="quarter">This Quarter</option>
                                                    <option value="year">This Year</option>
                                                    <option value="all">All Time</option>
                                                    <option value="custom">Custom Range</option>
                                                </select>
                                            </div>
                                            <div class="rpt-form-group">
                                                <label>Status Filter</label>
                                                <select id="rptStatusFilter">
                                                    <option value="all">All Status</option>
                                                    <option value="completed">Completed</option>
                                                    <option value="pending">Pending</option>
                                                    <option value="cancelled">Cancelled</option>
                                                </select>
                                            </div>
                                        </div>
                                        <div class="rpt-form-row rpt-custom-dates" id="rptCustomDates" style="display: none;">
                                            <div class="rpt-form-group">
                                                <label>Start Date</label>
                                                <input type="date" id="rptStartDate">
                                            </div>
                                            <div class="rpt-form-group">
                                                <label>End Date</label>
                                                <input type="date" id="rptEndDate">
                                            </div>
                                        </div>
                                        <div class="rpt-form-row">
                                            <div class="rpt-form-group">
                                                <label>Payment Method</label>
                                                <select id="rptPaymentFilter">
                                                    <option value="all">All Methods</option>
                                                    <option value="cash">Cash</option>
                                                    <option value="mpesa">M-Pesa</option>
                                                    <option value="bank">Bank Transfer</option>
                                                    <option value="credit">Credit</option>
                                                </select>
                                            </div>
                                            <div class="rpt-form-group">
                                                <label>Sort By</label>
                                                <select id="rptSortBy">
                                                    <option value="date-desc">Date (Newest)</option>
                                                    <option value="date-asc">Date (Oldest)</option>
                                                    <option value="amount-desc">Amount (High-Low)</option>
                                                    <option value="amount-asc">Amount (Low-High)</option>
                                                </select>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="rpt-generate-actions">
                                        <button class="rpt-btn-preview" onclick="previewReport()">
                                            <i class="fas fa-eye"></i> Preview Report
                                        </button>
                                        <button class="rpt-btn-generate" onclick="generateReport()">
                                            <i class="fas fa-file-pdf"></i> Generate & Print
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Quick Reports -->
                        <div class="rpt-quick-section">
                            <div class="rpt-section-title">
                                <i class="fas fa-bolt"></i>
                                <span>Quick Reports</span>
                            </div>
                            <div class="rpt-quick-grid">
                                <button class="rpt-quick-card" onclick="generateQuickReport('daily-sales')">
                                    <div class="rpt-quick-icon" style="background-color: #22c55e;"><i class="fas fa-calendar-day"></i></div>
                                    <span>Daily Sales</span>
                                </button>
                                <button class="rpt-quick-card" onclick="generateQuickReport('weekly-sales')">
                                    <div class="rpt-quick-icon" style="background-color: #3b82f6;"><i class="fas fa-calendar-week"></i></div>
                                    <span>Weekly Sales</span>
                                </button>
                                <button class="rpt-quick-card" onclick="generateQuickReport('monthly-summary')">
                                    <div class="rpt-quick-icon" style="background-color: #8b5cf6;"><i class="fas fa-calendar-alt"></i></div>
                                    <span>Monthly Summary</span>
                                </button>
                                <button class="rpt-quick-card" onclick="generateQuickReport('low-stock')">
                                    <div class="rpt-quick-icon" style="background-color: #f59e0b;"><i class="fas fa-exclamation-triangle"></i></div>
                                    <span>Low Stock Alert</span>
                                </button>
                                <button class="rpt-quick-card" onclick="generateQuickReport('expiring-items')">
                                    <div class="rpt-quick-icon" style="background-color: #f43f5e;"><i class="fas fa-clock"></i></div>
                                    <span>Expiring Items</span>
                                </button>
                                <button class="rpt-quick-card" onclick="generateQuickReport('profit-loss')">
                                    <div class="rpt-quick-icon" style="background-color: #06b6d4;"><i class="fas fa-balance-scale"></i></div>
                                    <span>Profit & Loss</span>
                                </button>
                            </div>
                        </div>

                        <!-- Report Preview Area -->
                        <div class="rpt-preview-section" id="rptPreviewSection" style="display: none;">
                            <div class="rpt-section-title">
                                <i class="fas fa-file-alt"></i>
                                <span>Report Preview</span>
                                <div class="rpt-preview-actions">
                                    <button class="rpt-preview-btn" onclick="printReportPreview()">
                                        <i class="fas fa-print"></i> Print
                                    </button>
                                    <button class="rpt-preview-btn rpt-close-preview" onclick="closeReportPreview()">
                                        <i class="fas fa-times"></i> Close
                                    </button>
                                </div>
                            </div>
                            <div class="rpt-preview-container" id="rptPreviewContainer">
                                <!-- Report preview will be rendered here -->
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Accounts Module -->
                <div class="module-content" id="module-reports-accounts">
                    <div class="module-header">
                        <div class="acc-header-text">
                            <h1>Accounts</h1>
                            <p>Financial reconciliation and revenue tracking</p>
                        </div>
                        <div class="acc-header-actions">
                            <button class="acc-refresh-btn" onclick="refreshAccountsData()">
                                <i class="fas fa-sync-alt"></i> Refresh
                            </button>
                            <button class="acc-export-btn" onclick="exportAccountsReport()">
                                <i class="fas fa-file-pdf"></i> Export PDF
                            </button>
                        </div>
                    </div>
                    <div class="module-body">
                        <!-- Revenue Overview Cards -->
                        <div class="acc-revenue-cards">
                            <div class="acc-revenue-card acc-card-green">
                                <div class="acc-card-icon">
                                    <i class="fas fa-coins"></i>
                                </div>
                                <div class="acc-card-content">
                                    <span class="acc-card-value" id="accTotalRevenue">Ksh 0.00</span>
                                    <span class="acc-card-label">Total Revenue</span>
                                </div>
                                <div class="acc-card-trend acc-trend-up">
                                    <i class="fas fa-arrow-up"></i>
                                    <span id="accRevenueTrend">0%</span>
                                </div>
                            </div>
                            <div class="acc-revenue-card acc-card-blue">
                                <div class="acc-card-icon">
                                    <i class="fas fa-shopping-cart"></i>
                                </div>
                                <div class="acc-card-content">
                                    <span class="acc-card-value" id="accRetailSales">Ksh 0.00</span>
                                    <span class="acc-card-label">Retail Sales</span>
                                </div>
                                <div class="acc-card-badge">POS</div>
                            </div>
                            <div class="acc-revenue-card acc-card-purple">
                                <div class="acc-card-icon">
                                    <i class="fas fa-truck"></i>
                                </div>
                                <div class="acc-card-content">
                                    <span class="acc-card-value" id="accWholesaleSales">Ksh 0.00</span>
                                    <span class="acc-card-label">Wholesale Sales</span>
                                </div>
                                <div class="acc-card-badge">WHOLESALE</div>
                            </div>
                            <div class="acc-revenue-card acc-card-red">
                                <div class="acc-card-icon">
                                    <i class="fas fa-receipt"></i>
                                </div>
                                <div class="acc-card-content">
                                    <span class="acc-card-value" id="accTotalExpenses">Ksh 0.00</span>
                                    <span class="acc-card-label">Total Expenses</span>
                                </div>
                                <div class="acc-card-badge">APPROVED</div>
                            </div>
                            <div class="acc-revenue-card acc-card-amber">
                                <div class="acc-card-icon">
                                    <i class="fas fa-balance-scale"></i>
                                </div>
                                <div class="acc-card-content">
                                    <span class="acc-card-value" id="accNetProfit">Ksh 0.00</span>
                                    <span class="acc-card-label">Net Profit</span>
                                </div>
                                <div class="acc-card-trend acc-trend-up" id="accProfitTrend">
                                    <i class="fas fa-arrow-up"></i>
                                    <span>Profit</span>
                                </div>
                            </div>
                        </div>

                        <!-- Reconciliation Section -->
                        <div class="acc-reconciliation">
                            <div class="acc-section-header">
                                <h3><i class="fas fa-check-double"></i> Account Reconciliation</h3>
                                <span class="acc-live-badge"><i class="fas fa-circle"></i> Live</span>
                            </div>
                            
                            <div class="acc-recon-grid">
                                <!-- Income Breakdown -->
                                <div class="acc-recon-panel">
                                    <h4>Income Breakdown</h4>
                                    <div class="acc-recon-list">
                                        <div class="acc-recon-item">
                                            <span class="acc-recon-label">
                                                <i class="fas fa-cash-register" style="color: #22c55e;"></i>
                                                Cash Payments
                                            </span>
                                            <span class="acc-recon-value" id="accCashIncome">Ksh 0.00</span>
                                        </div>
                                        <div class="acc-recon-item">
                                            <span class="acc-recon-label">
                                                <i class="fas fa-mobile-alt" style="color: #3b82f6;"></i>
                                                M-Pesa Payments
                                            </span>
                                            <span class="acc-recon-value" id="accMpesaIncome">Ksh 0.00</span>
                                        </div>
                                        <div class="acc-recon-item">
                                            <span class="acc-recon-label">
                                                <i class="fas fa-university" style="color: #f59e0b;"></i>
                                                Bank Transfers
                                            </span>
                                            <span class="acc-recon-value" id="accBankIncome">Ksh 0.00</span>
                                        </div>
                                        <div class="acc-recon-item">
                                            <span class="acc-recon-label">
                                                <i class="fas fa-credit-card" style="color: #ec4899;"></i>
                                                Credit Sales
                                            </span>
                                            <span class="acc-recon-value" id="accCreditIncome">Ksh 0.00</span>
                                        </div>
                                        <div class="acc-recon-total">
                                            <span>Total Income</span>
                                            <span id="accTotalIncome">Ksh 0.00</span>
                                        </div>
                                    </div>
                                </div>

                                <!-- Expense Breakdown -->
                                <div class="acc-recon-panel">
                                    <h4>Expense Breakdown</h4>
                                    <div class="acc-recon-list">
                                        <div class="acc-recon-item">
                                            <span class="acc-recon-label">
                                                <i class="fas fa-boxes" style="color: #8b5cf6;"></i>
                                                Inventory/Stock
                                            </span>
                                            <span class="acc-recon-value acc-expense" id="accInventoryExpense">Ksh 0.00</span>
                                        </div>
                                        <div class="acc-recon-item">
                                            <span class="acc-recon-label">
                                                <i class="fas fa-lightbulb" style="color: #f59e0b;"></i>
                                                Utilities
                                            </span>
                                            <span class="acc-recon-value acc-expense" id="accUtilitiesExpense">Ksh 0.00</span>
                                        </div>
                                        <div class="acc-recon-item">
                                            <span class="acc-recon-label">
                                                <i class="fas fa-users" style="color: #06b6d4;"></i>
                                                Salaries
                                            </span>
                                            <span class="acc-recon-value acc-expense" id="accSalariesExpense">Ksh 0.00</span>
                                        </div>
                                        <div class="acc-recon-item">
                                            <span class="acc-recon-label">
                                                <i class="fas fa-ellipsis-h" style="color: #6b7280;"></i>
                                                Other Expenses
                                            </span>
                                            <span class="acc-recon-value acc-expense" id="accOtherExpense">Ksh 0.00</span>
                                        </div>
                                        <div class="acc-recon-total acc-expense-total">
                                            <span>Total Expenses</span>
                                            <span id="accTotalExpensesRecon">Ksh 0.00</span>
                                        </div>
                                    </div>
                                </div>

                                <!-- Summary Panel -->
                                <div class="acc-recon-panel acc-summary-panel">
                                    <h4>Profit & Loss Summary</h4>
                                    <div class="acc-summary-content">
                                        <div class="acc-summary-item acc-income-item">
                                            <span>Total Income</span>
                                            <span id="accSummaryIncome">Ksh 0.00</span>
                                        </div>
                                        <div class="acc-summary-item acc-expense-item">
                                            <span>Total Expenses</span>
                                            <span id="accSummaryExpense">Ksh 0.00</span>
                                        </div>
                                        <div class="acc-summary-divider"></div>
                                        <div class="acc-summary-item acc-profit-item" id="accProfitLossRow">
                                            <span>Net Profit</span>
                                            <span id="accSummaryProfit">Ksh 0.00</span>
                                        </div>
                                        <div class="acc-profit-indicator" id="accProfitIndicator">
                                            <i class="fas fa-check-circle"></i>
                                            <span>Healthy Finances</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Today's Transactions -->
                        <div class="acc-transactions">
                            <div class="acc-section-header">
                                <h3><i class="fas fa-clock"></i> Today's Transactions</h3>
                                <span class="acc-date-badge" id="accTodayDate">Nov 28, 2025</span>
                            </div>
                            <div class="acc-trans-grid">
                                <div class="acc-trans-card acc-trans-sales">
                                    <div class="acc-trans-icon"><i class="fas fa-shopping-bag"></i></div>
                                    <div class="acc-trans-info">
                                        <span class="acc-trans-count" id="accTodaySalesCount">0</span>
                                        <span class="acc-trans-label">Sales Today</span>
                                    </div>
                                    <span class="acc-trans-amount" id="accTodaySalesAmount">Ksh 0.00</span>
                                </div>
                                <div class="acc-trans-card acc-trans-wholesale">
                                    <div class="acc-trans-icon"><i class="fas fa-truck-loading"></i></div>
                                    <div class="acc-trans-info">
                                        <span class="acc-trans-count" id="accTodayWholesaleCount">0</span>
                                        <span class="acc-trans-label">Wholesale Orders</span>
                                    </div>
                                    <span class="acc-trans-amount" id="accTodayWholesaleAmount">Ksh 0.00</span>
                                </div>
                                <div class="acc-trans-card acc-trans-expenses">
                                    <div class="acc-trans-icon"><i class="fas fa-money-bill-wave"></i></div>
                                    <div class="acc-trans-info">
                                        <span class="acc-trans-count" id="accTodayExpenseCount">0</span>
                                        <span class="acc-trans-label">Expenses Logged</span>
                                    </div>
                                    <span class="acc-trans-amount acc-expense" id="accTodayExpenseAmount">Ksh 0.00</span>
                                </div>
                                <div class="acc-trans-card acc-trans-profit">
                                    <div class="acc-trans-icon"><i class="fas fa-chart-line"></i></div>
                                    <div class="acc-trans-info">
                                        <span class="acc-trans-count" id="accTodayProfitPercent">0%</span>
                                        <span class="acc-trans-label">Profit Margin</span>
                                    </div>
                                    <span class="acc-trans-amount" id="accTodayNetProfit">Ksh 0.00</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Admin Module -->
                <div class="module-content" id="module-admin">
                    <div class="module-header">
                        <div class="admin-header-content">
                            <div>
                                <h1><i class="fas fa-user-shield"></i> Admin Panel</h1>
                                <p>System administration, user management & audit trail</p>
                            </div>
                            <div class="admin-header-actions">
                                <button class="admin-btn admin-btn-primary" onclick="AdminPanel.openAddUserModal()">
                                    <i class="fas fa-user-plus"></i> Add User
                                </button>
                                <button class="admin-btn admin-btn-secondary" onclick="AdminPanel.openAddBranchModal()">
                                    <i class="fas fa-building"></i> Add Branch
                                </button>
                            </div>
                        </div>
                    </div>
                    <div class="module-body">
                        <!-- Admin Stats Cards -->
                        <div class="admin-stats-grid">
                            <div class="admin-stat-card">
                                <div class="admin-stat-icon" style="background-color: #3b82f6;">
                                    <i class="fas fa-users"></i>
                                </div>
                                <div class="admin-stat-info">
                                    <span class="admin-stat-label">Total Users</span>
                                    <h3 class="admin-stat-value" id="adminTotalUsers">0</h3>
                                </div>
                            </div>
                            <div class="admin-stat-card">
                                <div class="admin-stat-icon" style="background-color: #10b981;">
                                    <i class="fas fa-user-check"></i>
                                </div>
                                <div class="admin-stat-info">
                                    <span class="admin-stat-label">Active Users</span>
                                    <h3 class="admin-stat-value" id="adminActiveUsers">0</h3>
                                </div>
                            </div>
                            <div class="admin-stat-card">
                                <div class="admin-stat-icon" style="background-color: #8b5cf6;">
                                    <i class="fas fa-building"></i>
                                </div>
                                <div class="admin-stat-info">
                                    <span class="admin-stat-label">Branches</span>
                                    <h3 class="admin-stat-value" id="adminTotalBranches">1</h3>
                                </div>
                            </div>
                            <div class="admin-stat-card">
                                <div class="admin-stat-icon" style="background-color: #f59e0b;">
                                    <i class="fas fa-history"></i>
                                </div>
                                <div class="admin-stat-info">
                                    <span class="admin-stat-label">Today's Activities</span>
                                    <h3 class="admin-stat-value" id="adminTodayActivities">0</h3>
                                </div>
                            </div>
                        </div>

                        <!-- Admin Tabs -->
                        <div class="admin-tabs">
                            <button class="admin-tab active" data-tab="users" onclick="AdminPanel.switchTab('users')">
                                <i class="fas fa-users"></i> Users
                            </button>
                            <button class="admin-tab" data-tab="branches" onclick="AdminPanel.switchTab('branches')">
                                <i class="fas fa-building"></i> Branches
                            </button>
                            <button class="admin-tab" data-tab="roles" onclick="AdminPanel.switchTab('roles')">
                                <i class="fas fa-user-tag"></i> Roles & Permissions
                            </button>
                            <button class="admin-tab" data-tab="audit" onclick="AdminPanel.switchTab('audit')">
                                <i class="fas fa-clipboard-list"></i> Audit Trail
                            </button>
                            <button class="admin-tab" data-tab="sessions" onclick="AdminPanel.switchTab('sessions')">
                                <i class="fas fa-sign-in-alt"></i> Login Sessions
                            </button>
                        </div>

                        <!-- Users Tab Content -->
                        <div class="admin-tab-content active" id="admin-tab-users">
                            <div class="admin-section-header">
                                <div class="admin-search-box">
                                    <i class="fas fa-search"></i>
                                    <input type="text" id="adminUserSearch" placeholder="Search users..." oninput="AdminPanel.filterUsers()">
                                </div>
                                <div class="admin-filter-group">
                                    <select id="adminUserRoleFilter" onchange="AdminPanel.filterUsers()">
                                        <option value="">All Roles</option>
                                        <option value="superadmin">Super Admin</option>
                                        <option value="admin">Admin</option>
                                        <option value="staff">Staff</option>
                                    </select>
                                    <select id="adminUserStatusFilter" onchange="AdminPanel.filterUsers()">
                                        <option value="">All Status</option>
                                        <option value="active">Active</option>
                                        <option value="inactive">Inactive</option>
                                    </select>
                                </div>
                            </div>
                            <div class="admin-table-wrapper">
                                <table class="admin-table">
                                    <thead>
                                        <tr>
                                            <th>User</th>
                                            <th>Email</th>
                                            <th>Role</th>
                                            <th>Branch</th>
                                            <th>Status</th>
                                            <th>Last Login</th>
                                            <th>Actions</th>
                                        </tr>
                                    </thead>
                                    <tbody id="adminUsersTableBody">
                                        <tr class="admin-loading-row">
                                            <td colspan="7">
                                                <i class="fas fa-spinner fa-spin"></i> Loading users...
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>

                        <!-- Branches Tab Content -->
                        <div class="admin-tab-content" id="admin-tab-branches">
                            <div class="admin-section-header">
                                <div class="admin-search-box">
                                    <i class="fas fa-search"></i>
                                    <input type="text" id="adminBranchSearch" placeholder="Search branches..." oninput="AdminPanel.filterBranches()">
                                </div>
                            </div>
                            <div class="admin-branches-grid" id="adminBranchesGrid">
                                <!-- Branches loaded dynamically -->
                            </div>
                        </div>

                        <!-- Roles & Permissions Tab Content -->
                        <div class="admin-tab-content" id="admin-tab-roles">
                            <div class="admin-roles-container">
                                <div class="admin-roles-list">
                                    <h3><i class="fas fa-user-tag"></i> System Roles</h3>
                                    <div class="admin-role-card" data-role="superadmin">
                                        <div class="admin-role-header">
                                            <div class="admin-role-icon" style="background-color: #ef4444;">
                                                <i class="fas fa-crown"></i>
                                            </div>
                                            <div class="admin-role-info">
                                                <h4>Super Admin</h4>
                                                <p>Full system access</p>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="admin-role-card" data-role="admin">
                                        <div class="admin-role-header">
                                            <div class="admin-role-icon" style="background-color: #3b82f6;">
                                                <i class="fas fa-user-shield"></i>
                                            </div>
                                            <div class="admin-role-info">
                                                <h4>Admin</h4>
                                                <p>Manage users & operations</p>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="admin-role-card" data-role="staff">
                                        <div class="admin-role-header">
                                            <div class="admin-role-icon" style="background-color: #10b981;">
                                                <i class="fas fa-user"></i>
                                            </div>
                                            <div class="admin-role-info">
                                                <h4>Staff</h4>
                                                <p>Limited access based on permissions</p>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="admin-permissions-panel">
                                    <h3><i class="fas fa-lock"></i> Module Permissions</h3>
                                    <p class="admin-permissions-note">Permissions matrix for each role</p>
                                    <div class="admin-permissions-table-wrapper">
                                        <table class="admin-permissions-table">
                                            <thead>
                                                <tr>
                                                    <th>Module</th>
                                                    <th>Super Admin</th>
                                                    <th>Admin</th>
                                                    <th>Staff</th>
                                                </tr>
                                            </thead>
                                            <tbody id="adminPermissionsTableBody">
                                                <!-- Permissions loaded dynamically -->
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Audit Trail Tab Content -->
                        <div class="admin-tab-content" id="admin-tab-audit">
                            <div class="admin-section-header">
                                <div class="admin-search-box">
                                    <i class="fas fa-search"></i>
                                    <input type="text" id="adminAuditSearch" placeholder="Search activities..." oninput="AdminPanel.filterAudit()">
                                </div>
                                <div class="admin-filter-group">
                                    <select id="adminAuditTypeFilter" onchange="AdminPanel.filterAudit()">
                                        <option value="">All Types</option>
                                        <option value="login">Login</option>
                                        <option value="logout">Logout</option>
                                        <option value="create">Create</option>
                                        <option value="update">Update</option>
                                        <option value="delete">Delete</option>
                                        <option value="view">View</option>
                                    </select>
                                    <select id="adminAuditModuleFilter" onchange="AdminPanel.filterAudit()">
                                        <option value="">All Modules</option>
                                        <option value="inventory">Inventory</option>
                                        <option value="sales">Sales</option>
                                        <option value="pos">POS</option>
                                        <option value="customers">Customers</option>
                                        <option value="orders">Orders</option>
                                        <option value="expenses">Expenses</option>
                                        <option value="users">Users</option>
                                    </select>
                                    <input type="date" id="adminAuditDateFilter" onchange="AdminPanel.filterAudit()">
                                </div>
                                <button class="admin-btn admin-btn-secondary" onclick="AdminPanel.exportAuditLog()">
                                    <i class="fas fa-download"></i> Export
                                </button>
                            </div>
                            <div class="admin-table-wrapper">
                                <table class="admin-table">
                                    <thead>
                                        <tr>
                                            <th>Timestamp</th>
                                            <th>User</th>
                                            <th>Action</th>
                                            <th>Module</th>
                                            <th>Details</th>
                                            <th>IP Address</th>
                                        </tr>
                                    </thead>
                                    <tbody id="adminAuditTableBody">
                                        <tr class="admin-loading-row">
                                            <td colspan="6">
                                                <i class="fas fa-spinner fa-spin"></i> Loading audit trail...
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                            <div class="admin-pagination" id="adminAuditPagination">
                                <!-- Pagination controls -->
                            </div>
                        </div>

                        <!-- Login Sessions Tab Content -->
                        <div class="admin-tab-content" id="admin-tab-sessions">
                            <div class="admin-section-header">
                                <div class="admin-search-box">
                                    <i class="fas fa-search"></i>
                                    <input type="text" id="adminSessionSearch" placeholder="Search sessions..." oninput="AdminPanel.filterSessions()">
                                </div>
                                <div class="admin-filter-group">
                                    <select id="adminSessionStatusFilter" onchange="AdminPanel.filterSessions()">
                                        <option value="">All Sessions</option>
                                        <option value="active">Active</option>
                                        <option value="expired">Expired</option>
                                    </select>
                                </div>
                            </div>
                            <div class="admin-table-wrapper">
                                <table class="admin-table">
                                    <thead>
                                        <tr>
                                            <th>User</th>
                                            <th>Login Time</th>
                                            <th>Logout Time</th>
                                            <th>Duration</th>
                                            <th>IP Address</th>
                                            <th>Device</th>
                                            <th>Status</th>
                                        </tr>
                                    </thead>
                                    <tbody id="adminSessionsTableBody">
                                        <tr class="admin-loading-row">
                                            <td colspan="7">
                                                <i class="fas fa-spinner fa-spin"></i> Loading sessions...
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Add/Edit User Modal -->
                <div class="admin-modal" id="adminUserModal">
                    <div class="admin-modal-content">
                        <div class="admin-modal-header">
                            <h3 id="adminUserModalTitle"><i class="fas fa-user-plus"></i> Add New User</h3>
                            <button class="admin-modal-close" onclick="AdminPanel.closeUserModal()">&times;</button>
                        </div>
                        <div class="admin-modal-body">
                            <form id="adminUserForm" onsubmit="AdminPanel.saveUser(event)">
                                <input type="hidden" id="adminUserId">
                                <div class="admin-form-row">
                                    <div class="admin-form-group">
                                        <label>First Name *</label>
                                        <input type="text" id="adminUserFirstName" required placeholder="Enter first name">
                                    </div>
                                    <div class="admin-form-group">
                                        <label>Last Name *</label>
                                        <input type="text" id="adminUserLastName" required placeholder="Enter last name">
                                    </div>
                                </div>
                                <div class="admin-form-row">
                                    <div class="admin-form-group">
                                        <label>Email Address *</label>
                                        <input type="email" id="adminUserEmail" required placeholder="Enter email">
                                    </div>
                                    <div class="admin-form-group">
                                        <label>Phone Number</label>
                                        <input type="tel" id="adminUserPhone" placeholder="Enter phone number">
                                    </div>
                                </div>
                                <div class="admin-form-row">
                                    <div class="admin-form-group">
                                        <label>Password *</label>
                                        <input type="password" id="adminUserPassword" placeholder="Enter password" minlength="6">
                                        <small class="admin-form-hint" id="adminPasswordHint">Minimum 6 characters</small>
                                    </div>
                                    <div class="admin-form-group">
                                        <label>Branch *</label>
                                        <select id="adminUserBranch" required>
                                            <option value="">Select Branch</option>
                                        </select>
                                    </div>
                                </div>
                                <div class="admin-form-row">
                                    <div class="admin-form-group">
                                        <label>Role *</label>
                                        <select id="adminUserRole" required onchange="AdminPanel.onRoleChange()">
                                            <option value="">Select Role</option>
                                            <option value="admin">Admin</option>
                                            <option value="staff">Staff</option>
                                        </select>
                                    </div>
                                    <div class="admin-form-group">
                                        <label>Status</label>
                                        <select id="adminUserStatus">
                                            <option value="active">Active</option>
                                            <option value="inactive">Inactive</option>
                                        </select>
                                    </div>
                                </div>

                                <!-- Module Permissions -->
                                <div class="admin-permissions-section" id="adminPermissionsSection">
                                    <h4><i class="fas fa-lock"></i> Module Permissions</h4>
                                    <p class="admin-permissions-desc">Select which modules this user can access</p>
                                    <div class="admin-permissions-grid" id="adminUserPermissions">
                                        <!-- Permissions checkboxes loaded dynamically -->
                                    </div>
                                </div>
                            </form>
                        </div>
                        <div class="admin-modal-footer">
                            <button type="button" class="admin-btn admin-btn-cancel" onclick="AdminPanel.closeUserModal()">Cancel</button>
                            <button type="submit" form="adminUserForm" class="admin-btn admin-btn-primary" id="adminUserSubmitBtn">
                                <i class="fas fa-save"></i> Save User
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Add/Edit Branch Modal -->
                <div class="admin-modal" id="adminBranchModal">
                    <div class="admin-modal-content admin-modal-sm">
                        <div class="admin-modal-header">
                            <h3 id="adminBranchModalTitle"><i class="fas fa-building"></i> Add New Branch</h3>
                            <button class="admin-modal-close" onclick="AdminPanel.closeBranchModal()">&times;</button>
                        </div>
                        <div class="admin-modal-body">
                            <form id="adminBranchForm" onsubmit="AdminPanel.saveBranch(event)">
                                <input type="hidden" id="adminBranchId">
                                <div class="admin-form-group">
                                    <label>Branch Name *</label>
                                    <input type="text" id="adminBranchName" required placeholder="Enter branch name">
                                </div>
                                <div class="admin-form-group">
                                    <label>Location *</label>
                                    <input type="text" id="adminBranchLocation" required placeholder="Enter location/address">
                                </div>
                                <div class="admin-form-group">
                                    <label>Phone Number</label>
                                    <input type="tel" id="adminBranchPhone" placeholder="Enter phone number">
                                </div>
                                <div class="admin-form-group">
                                    <label>Status</label>
                                    <select id="adminBranchStatus">
                                        <option value="active">Active</option>
                                        <option value="inactive">Inactive</option>
                                    </select>
                                </div>
                            </form>
                        </div>
                        <div class="admin-modal-footer">
                            <button type="button" class="admin-btn admin-btn-cancel" onclick="AdminPanel.closeBranchModal()">Cancel</button>
                            <button type="submit" form="adminBranchForm" class="admin-btn admin-btn-primary">
                                <i class="fas fa-save"></i> Save Branch
                            </button>
                        </div>
                    </div>
                </div>

                <!-- View User Details Modal -->
                <div class="admin-modal" id="adminViewUserModal">
                    <div class="admin-modal-content">
                        <div class="admin-modal-header">
                            <h3><i class="fas fa-user"></i> User Details</h3>
                            <button class="admin-modal-close" onclick="AdminPanel.closeViewUserModal()">&times;</button>
                        </div>
                        <div class="admin-modal-body" id="adminViewUserContent">
                            <!-- User details loaded dynamically -->
                        </div>
                        <div class="admin-modal-footer">
                            <button type="button" class="admin-btn admin-btn-cancel" onclick="AdminPanel.closeViewUserModal()">Close</button>
                        </div>
                    </div>
                </div>

                <!-- Confirm Delete Modal -->
                <div class="admin-modal" id="adminConfirmModal">
                    <div class="admin-modal-content admin-modal-sm">
                        <div class="admin-modal-header admin-modal-header-danger">
                            <h3><i class="fas fa-exclamation-triangle"></i> Confirm Delete</h3>
                            <button class="admin-modal-close" onclick="AdminPanel.closeConfirmModal()">&times;</button>
                        </div>
                        <div class="admin-modal-body">
                            <p id="adminConfirmMessage">Are you sure you want to delete this item? This action cannot be undone.</p>
                        </div>
                        <div class="admin-modal-footer">
                            <button type="button" class="admin-btn admin-btn-cancel" onclick="AdminPanel.closeConfirmModal()">Cancel</button>
                            <button type="button" class="admin-btn admin-btn-danger" id="adminConfirmDeleteBtn">
                                <i class="fas fa-trash"></i> Delete
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Manage Users Module -->
                <div class="module-content" id="module-admin-users">
                    <div class="module-header">
                        <div class="admin-header-content">
                            <div>
                                <h1><i class="fas fa-users-cog"></i> Manage Users</h1>
                                <p>Add, edit and manage system users</p>
                            </div>
                            <div class="admin-header-actions">
                                <button class="admin-btn admin-btn-primary" onclick="AdminPanel.openAddUserModal()">
                                    <i class="fas fa-user-plus"></i> Add User
                                </button>
                            </div>
                        </div>
                    </div>
                    <div class="module-body">
                        <!-- User Management Section -->
                        <div class="admin-section-header">
                            <div class="admin-search-box">
                                <i class="fas fa-search"></i>
                                <input type="text" id="usersModuleSearch" placeholder="Search users..." oninput="AdminPanel.filterUsers()">
                            </div>
                            <div class="admin-filter-group">
                                <select id="usersModuleRoleFilter" onchange="AdminPanel.filterUsers()">
                                    <option value="">All Roles</option>
                                    <option value="superadmin">Super Admin</option>
                                    <option value="admin">Admin</option>
                                    <option value="staff">Staff</option>
                                </select>
                                <select id="usersModuleStatusFilter" onchange="AdminPanel.filterUsers()">
                                    <option value="">All Status</option>
                                    <option value="active">Active</option>
                                    <option value="inactive">Inactive</option>
                                </select>
                            </div>
                        </div>
                        <div class="admin-table-wrapper">
                            <table class="admin-table">
                                <thead>
                                    <tr>
                                        <th>User</th>
                                        <th>Email</th>
                                        <th>Role</th>
                                        <th>Branch</th>
                                        <th>Status</th>
                                        <th>Last Login</th>
                                        <th>Actions</th>
                                    </tr>
                                </thead>
                                <tbody id="usersModuleTableBody">
                                    <tr class="admin-loading-row">
                                        <td colspan="7">
                                            <i class="fas fa-spinner fa-spin"></i> Loading users...
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>

                <!-- Settings Module -->
                <div class="module-content" id="module-settings">
                    <div class="module-header">
                        <div class="set-header-text">
                            <h1>Settings</h1>
                            <p>Configure your profile and system preferences</p>
                        </div>
                        <div class="set-header-actions">
                            <button class="set-save-btn" onclick="saveAllSettings()">
                                <i class="fas fa-save"></i> Save Changes
                            </button>
                        </div>
                    </div>
                    <div class="module-body">
                        <div class="set-layout">
                            <!-- Settings Sidebar -->
                            <div class="set-sidebar">
                                <nav class="set-nav">
                                    <button class="set-nav-item active" data-section="profile" onclick="showSettingsSection('profile')">
                                        <i class="fas fa-user-circle"></i>
                                        <span>My Profile</span>
                                    </button>
                                    <button class="set-nav-item" data-section="account" onclick="showSettingsSection('account')">
                                        <i class="fas fa-cog"></i>
                                        <span>Account Settings</span>
                                    </button>
                                    <button class="set-nav-item" data-section="security" onclick="showSettingsSection('security')">
                                        <i class="fas fa-shield-alt"></i>
                                        <span>Security</span>
                                    </button>
                                    <button class="set-nav-item" data-section="notifications" onclick="showSettingsSection('notifications')">
                                        <i class="fas fa-bell"></i>
                                        <span>Notifications</span>
                                    </button>
                                    <button class="set-nav-item" data-section="appearance" onclick="showSettingsSection('appearance')">
                                        <i class="fas fa-palette"></i>
                                        <span>Appearance</span>
                                    </button>
                                    <button class="set-nav-item" data-section="business" onclick="showSettingsSection('business')">
                                        <i class="fas fa-store"></i>
                                        <span>Business Info</span>
                                    </button>
                                    <button class="set-nav-item" data-section="system" onclick="showSettingsSection('system')">
                                        <i class="fas fa-server"></i>
                                        <span>System</span>
                                    </button>
                                </nav>
                            </div>

                            <!-- Settings Content -->
                            <div class="set-content">
                                <!-- Profile Section -->
                                <div class="set-section active" id="set-profile">
                                    <div class="set-section-header">
                                        <h2><i class="fas fa-user-circle"></i> My Profile</h2>
                                        <p>Manage your personal information</p>
                                    </div>
                                    <div class="set-card">
                                        <div class="set-profile-header">
                                            <div class="set-avatar-wrapper">
                                                <div class="set-avatar">
                                                    <i class="fas fa-user"></i>
                                                </div>
                                                <button class="set-avatar-edit">
                                                    <i class="fas fa-camera"></i>
                                                </button>
                                                <input type="file" id="setAvatarInput" accept="image/*" hidden>
                                            </div>
                                            <div class="set-profile-info">
                                                <h3 id="setProfileName">Administrator</h3>
                                                <p id="setProfileRole">System Admin</p>
                                            </div>
                                        </div>
                                        <div class="set-form-grid">
                                            <div class="set-form-group">
                                                <label>First Name</label>
                                                <input type="text" id="setFirstName" value="Admin" placeholder="Enter first name">
                                            </div>
                                            <div class="set-form-group">
                                                <label>Last Name</label>
                                                <input type="text" id="setLastName" value="User" placeholder="Enter last name">
                                            </div>
                                            <div class="set-form-group">
                                                <label>Email Address</label>
                                                <input type="email" id="setEmail" value="admin@pharmaflow.com" placeholder="Enter email">
                                            </div>
                                            <div class="set-form-group">
                                                <label>Phone Number</label>
                                                <input type="tel" id="setPhone" value="+254 700 000 000" placeholder="Enter phone">
                                            </div>
                                            <div class="set-form-group set-full-width">
                                                <label>Bio</label>
                                                <textarea id="setBio" rows="3" placeholder="Tell us about yourself">PharmFlow System Administrator</textarea>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <!-- Account Settings Section -->
                                <div class="set-section" id="set-account">
                                    <div class="set-section-header">
                                        <h2><i class="fas fa-cog"></i> Account Settings</h2>
                                        <p>Manage your account preferences</p>
                                    </div>
                                    <div class="set-card">
                                        <h4>Account Information</h4>
                                        <div class="set-form-grid">
                                            <div class="set-form-group">
                                                <label>Username</label>
                                                <input type="text" id="setUsername" value="admin" placeholder="Username">
                                            </div>
                                            <div class="set-form-group">
                                                <label>Role</label>
                                                <select id="setRole">
                                                    <option value="admin" selected>Administrator</option>
                                                    <option value="manager">Manager</option>
                                                    <option value="pharmacist">Pharmacist</option>
                                                    <option value="cashier">Cashier</option>
                                                </select>
                                            </div>
                                            <div class="set-form-group">
                                                <label>Language</label>
                                                <select id="setLanguage">
                                                    <option value="en" selected>English</option>
                                                    <option value="sw">Swahili</option>
                                                </select>
                                            </div>
                                            <div class="set-form-group">
                                                <label>Timezone</label>
                                                <select id="setTimezone">
                                                    <option value="Africa/Nairobi" selected>East Africa Time (EAT)</option>
                                                    <option value="UTC">UTC</option>
                                                </select>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="set-card set-danger-zone">
                                        <h4>Danger Zone</h4>
                                        <p>Irreversible actions</p>
                                        <div class="set-danger-actions">
                                            <button class="set-danger-btn" onclick="deactivateAccount()">
                                                <i class="fas fa-user-slash"></i> Deactivate Account
                                            </button>
                                        </div>
                                    </div>
                                </div>

                                <!-- Security Section -->
                                <div class="set-section" id="set-security">
                                    <div class="set-section-header">
                                        <h2><i class="fas fa-shield-alt"></i> Security</h2>
                                        <p>Manage password and security settings</p>
                                    </div>
                                    <div class="set-card">
                                        <h4>Change Password</h4>
                                        <div class="set-form-stack">
                                            <div class="set-form-group">
                                                <label>Current Password</label>
                                                <div class="set-password-input">
                                                    <input type="password" id="setCurrentPassword" placeholder="Enter current password">
                                                    <button type="button" class="set-toggle-password" onclick="togglePasswordVisibility(this)">
                                                        <i class="fas fa-eye"></i>
                                                    </button>
                                                </div>
                                            </div>
                                            <div class="set-form-group">
                                                <label>New Password</label>
                                                <div class="set-password-input">
                                                    <input type="password" id="setNewPassword" placeholder="Enter new password">
                                                    <button type="button" class="set-toggle-password" onclick="togglePasswordVisibility(this)">
                                                        <i class="fas fa-eye"></i>
                                                    </button>
                                                </div>
                                                <div class="set-password-strength" id="setPasswordStrength"></div>
                                            </div>
                                            <div class="set-form-group">
                                                <label>Confirm New Password</label>
                                                <div class="set-password-input">
                                                    <input type="password" id="setConfirmPassword" placeholder="Confirm new password">
                                                    <button type="button" class="set-toggle-password" onclick="togglePasswordVisibility(this)">
                                                        <i class="fas fa-eye"></i>
                                                    </button>
                                                </div>
                                            </div>
                                            <button class="set-btn-primary" onclick="changePassword()">
                                                <i class="fas fa-key"></i> Update Password
                                            </button>
                                        </div>
                                    </div>
                                    <div class="set-card">
                                        <h4>Two-Factor Authentication</h4>
                                        <div class="set-toggle-row">
                                            <div class="set-toggle-info">
                                                <span>Enable 2FA</span>
                                                <p>Add an extra layer of security to your account</p>
                                            </div>
                                            <label class="set-toggle">
                                                <input type="checkbox" id="set2FA">
                                                <span class="set-toggle-slider"></span>
                                            </label>
                                        </div>
                                    </div>
                                    <div class="set-card">
                                        <h4>Login Sessions</h4>
                                        <div class="set-session-list">
                                            <div class="set-session-item set-current">
                                                <div class="set-session-icon">
                                                    <i class="fas fa-desktop"></i>
                                                </div>
                                                <div class="set-session-info">
                                                    <span>Current Session</span>
                                                    <p>Windows  Chrome  Nairobi, Kenya</p>
                                                </div>
                                                <span class="set-session-badge">Active</span>
                                            </div>
                                        </div>
                                        <button class="set-btn-outline" onclick="logoutAllSessions()">
                                            <i class="fas fa-sign-out-alt"></i> Logout All Other Sessions
                                        </button>
                                    </div>
                                </div>

                                <!-- Notifications Section -->
                                <div class="set-section" id="set-notifications">
                                    <div class="set-section-header">
                                        <h2><i class="fas fa-bell"></i> Notifications</h2>
                                        <p>Configure how you receive notifications</p>
                                    </div>
                                    <div class="set-card">
                                        <h4>Email Notifications</h4>
                                        <div class="set-toggle-list">
                                            <div class="set-toggle-row">
                                                <div class="set-toggle-info">
                                                    <span>Low Stock Alerts</span>
                                                    <p>Get notified when inventory is running low</p>
                                                </div>
                                                <label class="set-toggle">
                                                    <input type="checkbox" id="setNotifyLowStock" checked>
                                                    <span class="set-toggle-slider"></span>
                                                </label>
                                            </div>
                                            <div class="set-toggle-row">
                                                <div class="set-toggle-info">
                                                    <span>Expiry Alerts</span>
                                                    <p>Get notified about expiring products</p>
                                                </div>
                                                <label class="set-toggle">
                                                    <input type="checkbox" id="setNotifyExpiry" checked>
                                                    <span class="set-toggle-slider"></span>
                                                </label>
                                            </div>
                                            <div class="set-toggle-row">
                                                <div class="set-toggle-info">
                                                    <span>Daily Sales Summary</span>
                                                    <p>Receive daily sales report via email</p>
                                                </div>
                                                <label class="set-toggle">
                                                    <input type="checkbox" id="setNotifySales">
                                                    <span class="set-toggle-slider"></span>
                                                </label>
                                            </div>
                                            <div class="set-toggle-row">
                                                <div class="set-toggle-info">
                                                    <span>New Orders</span>
                                                    <p>Get notified about new wholesale orders</p>
                                                </div>
                                                <label class="set-toggle">
                                                    <input type="checkbox" id="setNotifyOrders" checked>
                                                    <span class="set-toggle-slider"></span>
                                                </label>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="set-card">
                                        <h4>System Notifications</h4>
                                        <div class="set-toggle-list">
                                            <div class="set-toggle-row">
                                                <div class="set-toggle-info">
                                                    <span>Sound Alerts</span>
                                                    <p>Play sound for important notifications</p>
                                                </div>
                                                <label class="set-toggle">
                                                    <input type="checkbox" id="setNotifySound" checked>
                                                    <span class="set-toggle-slider"></span>
                                                </label>
                                            </div>
                                            <div class="set-toggle-row">
                                                <div class="set-toggle-info">
                                                    <span>Desktop Notifications</span>
                                                    <p>Show browser notifications</p>
                                                </div>
                                                <label class="set-toggle">
                                                    <input type="checkbox" id="setNotifyDesktop">
                                                    <span class="set-toggle-slider"></span>
                                                </label>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <!-- Appearance Section -->
                                <div class="set-section" id="set-appearance">
                                    <div class="set-section-header">
                                        <h2><i class="fas fa-palette"></i> Appearance</h2>
                                        <p>Customize how PharmFlow looks</p>
                                    </div>
                                    <div class="set-card">
                                        <h4>Theme</h4>
                                        <div class="set-theme-options">
                                            <label class="set-theme-option">
                                                <input type="radio" name="theme" value="light" checked>
                                                <div class="set-theme-card set-theme-light">
                                                    <div class="set-theme-preview">
                                                        <div class="set-theme-sidebar"></div>
                                                        <div class="set-theme-content"></div>
                                                    </div>
                                                    <span>Light</span>
                                                </div>
                                            </label>
                                            <label class="set-theme-option">
                                                <input type="radio" name="theme" value="dark">
                                                <div class="set-theme-card set-theme-dark">
                                                    <div class="set-theme-preview">
                                                        <div class="set-theme-sidebar"></div>
                                                        <div class="set-theme-content"></div>
                                                    </div>
                                                    <span>Dark</span>
                                                </div>
                                            </label>
                                            <label class="set-theme-option">
                                                <input type="radio" name="theme" value="system">
                                                <div class="set-theme-card set-theme-system">
                                                    <div class="set-theme-preview">
                                                        <div class="set-theme-sidebar"></div>
                                                        <div class="set-theme-content"></div>
                                                    </div>
                                                    <span>System</span>
                                                </div>
                                            </label>
                                        </div>
                                    </div>
                                    <div class="set-card">
                                        <h4>Display Options</h4>
                                        <div class="set-toggle-list">
                                            <div class="set-toggle-row">
                                                <div class="set-toggle-info">
                                                    <span>Compact Mode</span>
                                                    <p>Reduce spacing for more content</p>
                                                </div>
                                                <label class="set-toggle">
                                                    <input type="checkbox" id="setCompactMode">
                                                    <span class="set-toggle-slider"></span>
                                                </label>
                                            </div>
                                            <div class="set-toggle-row">
                                                <div class="set-toggle-info">
                                                    <span>Sidebar Collapsed</span>
                                                    <p>Start with collapsed sidebar</p>
                                                </div>
                                                <label class="set-toggle">
                                                    <input type="checkbox" id="setSidebarCollapsed">
                                                    <span class="set-toggle-slider"></span>
                                                </label>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <!-- Business Info Section -->
                                <div class="set-section" id="set-business">
                                    <div class="set-section-header">
                                        <h2><i class="fas fa-store"></i> Business Information</h2>
                                        <p>Configure your pharmacy details</p>
                                    </div>
                                    <div class="set-card">
                                        <h4>Pharmacy Details</h4>
                                        <div class="set-form-grid">
                                            <div class="set-form-group set-full-width">
                                                <label>Pharmacy Name</label>
                                                <input type="text" id="setBizName" value="PharmFlow Pharmacy" placeholder="Pharmacy name">
                                            </div>
                                            <div class="set-form-group">
                                                <label>Phone Number</label>
                                                <input type="tel" id="setBizPhone" value="+254 700 000 000" placeholder="Business phone">
                                            </div>
                                            <div class="set-form-group">
                                                <label>Email</label>
                                                <input type="email" id="setBizEmail" value="info@pharmaflow.com" placeholder="Business email">
                                            </div>
                                            <div class="set-form-group set-full-width">
                                                <label>Address</label>
                                                <textarea id="setBizAddress" rows="2" placeholder="Physical address">Nairobi, Kenya</textarea>
                                            </div>
                                            <div class="set-form-group">
                                                <label>Registration Number</label>
                                                <input type="text" id="setBizRegNo" placeholder="Business reg. number">
                                            </div>
                                            <div class="set-form-group">
                                                <label>Tax PIN</label>
                                                <input type="text" id="setBizTaxPin" placeholder="KRA PIN">
                                            </div>
                                        </div>
                                    </div>
                                    <div class="set-card">
                                        <h4>Receipt Settings</h4>
                                        <div class="set-form-grid">
                                            <div class="set-form-group set-full-width">
                                                <label>Receipt Header</label>
                                                <input type="text" id="setReceiptHeader" value="Thank you for shopping with us!" placeholder="Receipt header message">
                                            </div>
                                            <div class="set-form-group set-full-width">
                                                <label>Receipt Footer</label>
                                                <input type="text" id="setReceiptFooter" value="Visit us again!" placeholder="Receipt footer message">
                                            </div>
                                        </div>
                                        <div class="set-toggle-row">
                                            <div class="set-toggle-info">
                                                <span>Print Logo on Receipt</span>
                                                <p>Include pharmacy logo on printed receipts</p>
                                            </div>
                                            <label class="set-toggle">
                                                <input type="checkbox" id="setReceiptLogo" checked>
                                                <span class="set-toggle-slider"></span>
                                            </label>
                                        </div>
                                    </div>
                                </div>

                                <!-- System Section -->
                                <div class="set-section" id="set-system">
                                    <div class="set-section-header">
                                        <h2><i class="fas fa-server"></i> System</h2>
                                        <p>System information and maintenance</p>
                                    </div>
                                    <div class="set-card">
                                        <h4>System Information</h4>
                                        <div class="set-info-grid">
                                            <div class="set-info-item">
                                                <span class="set-info-label">Version</span>
                                                <span class="set-info-value">PharmFlow v1.0.0</span>
                                            </div>
                                            <div class="set-info-item">
                                                <span class="set-info-label">Database</span>
                                                <span class="set-info-value">Firebase Firestore</span>
                                            </div>
                                            <div class="set-info-item">
                                                <span class="set-info-label">Last Sync</span>
                                                <span class="set-info-value" id="setLastSync">Just now</span>
                                            </div>
                                            <div class="set-info-item">
                                                <span class="set-info-label">Status</span>
                                                <span class="set-info-value set-status-online"><i class="fas fa-circle"></i> Online</span>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="set-card">
                                        <h4>Data Management</h4>
                                        <div class="set-action-buttons">
                                            <button class="set-btn-secondary" onclick="exportData()">
                                                <i class="fas fa-download"></i> Export Data
                                            </button>
                                            <button class="set-btn-secondary" onclick="importData()">
                                                <i class="fas fa-upload"></i> Import Data
                                            </button>
                                            <button class="set-btn-outline" onclick="clearCache()">
                                                <i class="fas fa-broom"></i> Clear Cache
                                            </button>
                                        </div>
                                    </div>
                                    <div class="set-card set-danger-zone">
                                        <h4>Reset System</h4>
                                        <p>This will reset all settings to default values</p>
                                        <button class="set-danger-btn" onclick="resetSettings()">
                                            <i class="fas fa-undo"></i> Reset to Defaults
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </main>
        </div>
    </div>

    <!-- Barcode Print Modal -->
    <div class="sales-modal" id="barcodePrintModal">
        <div class="sales-modal-content barcode-modal">
            <div class="sales-modal-header">
                <h3>
                    <i class="fas fa-barcode"></i>
                    Print Barcode
                </h3>
                <button class="sales-modal-close" id="closeBarcodeModal">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="sales-modal-body">
                <!-- Barcode Preview -->
                <div class="barcode-preview-section">
                    <div class="barcode-preview-container">
                        <div class="barcode-label-preview">
                            <div class="barcode-product-name" id="barcodeProductName">Product Name</div>
                            <svg id="barcodePreviewSvg"></svg>
                            <div class="barcode-price-tag" id="barcodePriceTag">KSH 0.00</div>
                        </div>
                    </div>
                </div>

                <!-- Print Settings -->
                <div class="barcode-settings">
                    <h4 class="settings-title">
                        <i class="fas fa-cog"></i>
                        Print Settings
                    </h4>
                    <div class="setting-row">
                        <div class="setting-group">
                            <label for="barcodeCopies">Number of Copies</label>
                            <input type="number" id="barcodeCopies" value="1" min="1" max="100">
                        </div>
                        <div class="setting-group">
                            <label for="barcodeSize">Label Size</label>
                            <select id="barcodeSize">
                                <option value="small">Small (50mm x 25mm)</option>
                                <option value="medium" selected>Medium (60mm x 30mm)</option>
                                <option value="large">Large (80mm x 40mm)</option>
                            </select>
                        </div>
                    </div>
                    <div class="setting-row checkbox-row">
                        <label class="checkbox-label setting-checkbox">
                            <input type="checkbox" id="showProductName" checked>
                            <span class="checkbox-custom"></span>
                            <span>Show Product Name</span>
                        </label>
                        <label class="checkbox-label setting-checkbox">
                            <input type="checkbox" id="showPrice" checked>
                            <span class="checkbox-custom"></span>
                            <span>Show Price</span>
                        </label>
                    </div>
                </div>
            </div>
            <div class="barcode-modal-footer">
                <button class="barcode-btn barcode-btn-cancel" id="cancelBarcodePrint">
                    <i class="fas fa-times"></i>
                    <span>Cancel</span>
                </button>
                <button class="barcode-btn barcode-btn-print" id="confirmBarcodePrint">
                    <i class="fas fa-print"></i>
                    <span>Print Barcode</span>
                </button>
            </div>
        </div>
    </div>

    <!-- Barcode Scanner Modal -->
    <div class="sales-modal" id="barcodeScanModal">
        <div class="sales-modal-content barcode-modal">
            <div class="sales-modal-header">
                <h3>
                    <i class="fas fa-qrcode"></i>
                    Scan Barcode
                </h3>
                <button class="sales-modal-close" id="closeScanModal">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="sales-modal-body">
                <!-- Scanner Input Section -->
                <div class="scanner-input-section">
                    <div class="scanner-icon">
                        <i class="fas fa-barcode"></i>
                    </div>
                    <p class="scanner-instruction">Scan a barcode or enter it manually below</p>
                    <div class="scanner-input-wrapper">
                        <input type="text" 
                               id="scanBarcodeInput" 
                               class="scanner-input" 
                               placeholder="Enter or scan barcode..."
                               autofocus>
                        <button type="button" id="searchBarcodeBtn" class="scanner-search-btn">
                            <i class="fas fa-search"></i>
                        </button>
                    </div>
                </div>

                <!-- Scan Result -->
                <div class="scan-result" id="scanResult" style="display: none;">
                    <div class="scan-result-found" id="scanResultFound" style="display: none;">
                        <div class="scan-result-icon success">
                            <i class="fas fa-check-circle"></i>
                        </div>
                        <h4>Product Found!</h4>
                        <div class="found-product-details">
                            <p><strong>Name:</strong> <span id="foundProductName">-</span></p>
                            <p><strong>Barcode:</strong> <span id="foundProductBarcode">-</span></p>
                            <p><strong>Stock:</strong> <span id="foundProductStock">-</span></p>
                        </div>
                        <button type="button" id="editFoundProduct" class="scan-action-btn edit-btn">
                            <i class="fas fa-edit"></i>
                            Edit Product
                        </button>
                    </div>
                    <div class="scan-result-notfound" id="scanResultNotFound" style="display: none;">
                        <div class="scan-result-icon warning">
                            <i class="fas fa-exclamation-circle"></i>
                        </div>
                        <h4>Product Not Found</h4>
                        <p>No product with this barcode exists in inventory.</p>
                        <button type="button" id="addNewWithBarcode" class="scan-action-btn add-btn">
                            <i class="fas fa-plus"></i>
                            Add as New Product
                        </button>
                    </div>
                </div>
            </div>
            <div class="barcode-modal-footer">
                <button class="barcode-btn barcode-btn-cancel" id="cancelScan">
                    <i class="fas fa-times"></i>
                    <span>Close</span>
                </button>
            </div>
        </div>
    </div>

    <!-- Bulk Import Modal -->
    <div class="sales-modal" id="bulkImportModal">
        <div class="sales-modal-content import-modal">
            <div class="sales-modal-header">
                <h3>
                    <i class="fas fa-upload"></i>
                    Bulk Import Inventory
                </h3>
                <button class="sales-modal-close" id="closeImportModal">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="sales-modal-body">
                <!-- Upload Section -->
                <div class="import-upload-section" id="importUploadSection">
                    <div class="import-dropzone" id="importDropzone">
                        <i class="fas fa-cloud-upload-alt"></i>
                        <h4>Drop Excel or CSV file here</h4>
                        <p>or click to browse</p>
                        <input type="file" id="importFileInput" accept=".csv,.xlsx,.xls" hidden>
                    </div>
                    <div class="import-template">
                        <p>Need a template?</p>
                        <button type="button" id="downloadTemplate">
                            <i class="fas fa-download"></i>
                            Download CSV Template
                        </button>
                    </div>
                    <div class="import-instructions">
                        <h5>File Format Requirements:</h5>
                        <ul>
                            <li><strong>Supported formats:</strong> Excel (.xlsx, .xls) or CSV (.csv)</li>
                            <li><strong>Required columns:</strong> name, category, quantity, costPrice, sellingPrice</li>
                            <li><strong>Optional columns:</strong> genericName, dosageForm, strength, manufacturer, unit, reorderLevel, batchNumber, expiryDate, manufactureDate, barcode, location, supplier, description, prescriptionRequired</li>
                            <li>Date format: YYYY-MM-DD (e.g., 2025-12-31)</li>
                            <li>First row must be column headers</li>
                        </ul>
                    </div>
                </div>

                <!-- Preview Section -->
                <div class="import-preview-section" id="importPreviewSection" style="display: none;">
                    <div class="import-summary">
                        <div class="summary-item valid">
                            <i class="fas fa-check-circle"></i>
                            <span id="validCount">0</span> Valid
                        </div>
                        <div class="summary-item errors">
                            <i class="fas fa-exclamation-circle"></i>
                            <span id="errorCount">0</span> Errors
                        </div>
                        <div class="summary-item total">
                            <i class="fas fa-list"></i>
                            <span id="totalCount">0</span> Total
                        </div>
                    </div>
                    <div class="import-preview-table-container">
                        <table class="import-preview-table">
                            <thead id="importPreviewHead"></thead>
                            <tbody id="importPreviewBody"></tbody>
                        </table>
                    </div>
                    <div class="import-error-list" id="importErrorList" style="display: none;">
                        <h5><i class="fas fa-exclamation-triangle"></i> Errors Found:</h5>
                        <ul id="errorListItems"></ul>
                    </div>
                </div>

                <!-- Progress Section -->
                <div class="import-progress-section" id="importProgressSection" style="display: none;">
                    <div class="progress-icon">
                        <i class="fas fa-spinner fa-spin"></i>
                    </div>
                    <h4>Importing...</h4>
                    <div class="progress-bar-container">
                        <div class="progress-bar" id="importProgressBar"></div>
                    </div>
                    <p class="progress-text"><span id="importedCount">0</span> of <span id="totalImportCount">0</span> items imported</p>
                </div>

                <!-- Success Section -->
                <div class="import-success-section" id="importSuccessSection" style="display: none;">
                    <div class="success-icon">
                        <i class="fas fa-check-circle"></i>
                    </div>
                    <h4>Import Complete!</h4>
                    <p><span id="successCount">0</span> items successfully imported</p>
                </div>
            </div>
            <div class="import-modal-footer" id="importModalFooter">
                <button class="import-btn import-btn-cancel" id="cancelImport">
                    Cancel
                </button>
                <button class="import-btn import-btn-back" id="backToUpload" style="display: none;">
                    <i class="fas fa-arrow-left"></i>
                    Back
                </button>
                <button class="import-btn import-btn-import" id="startImport" style="display: none;" disabled>
                    <i class="fas fa-upload"></i>
                    Import <span id="importBtnCount">0</span> Items
                </button>
                <button class="import-btn import-btn-done" id="doneImport" style="display: none;">
                    Done
                </button>
            </div>
        </div>
    </div>

    <!-- View Item Modal -->
    <div class="inventory-modal" id="viewItemModal">
        <div class="inventory-modal-content">
            <div class="inventory-modal-header">
                <h3><i class="fas fa-eye"></i> Item Details</h3>
                <button class="inventory-modal-close" id="closeViewModal">&times;</button>
            </div>
            <div class="inventory-modal-body" id="viewItemBody">
                <!-- Content populated dynamically -->
            </div>
            <div class="inventory-modal-footer">
                <button class="modal-btn modal-btn-secondary" id="closeViewBtn">Close</button>
                <button class="modal-btn modal-btn-primary" id="editFromViewBtn">
                    <i class="fas fa-edit"></i> Edit Item
                </button>
            </div>
        </div>
    </div>

    <!-- Edit Item Modal -->
    <div class="inventory-modal" id="editItemModal">
        <div class="inventory-modal-content inventory-modal-large">
            <div class="inventory-modal-header">
                <h3><i class="fas fa-edit"></i> Edit Item</h3>
                <button class="inventory-modal-close" id="closeEditModal">&times;</button>
            </div>
            <div class="inventory-modal-body">
                <form id="editItemForm" class="edit-item-form">
                    <input type="hidden" id="editItemId">
                    
                    <div class="edit-form-grid">
                        <!-- Basic Info -->
                        <div class="edit-form-section">
                            <h4>Basic Information</h4>
                            <div class="edit-form-row">
                                <div class="edit-form-group">
                                    <label for="editName">Product Name <span class="required">*</span></label>
                                    <input type="text" id="editName" required>
                                </div>
                                <div class="edit-form-group">
                                    <label for="editGenericName">Generic Name</label>
                                    <input type="text" id="editGenericName">
                                </div>
                            </div>
                            <div class="edit-form-row">
                                <div class="edit-form-group">
                                    <label for="editCategory">Category <span class="required">*</span></label>
                                    <select id="editCategory" required>
                                        <option value="">Select Category</option>
                                        <option value="tablets">Tablets</option>
                                        <option value="capsules">Capsules</option>
                                        <option value="syrups">Syrups</option>
                                        <option value="injections">Injections</option>
                                        <option value="ointments">Ointments</option>
                                        <option value="drops">Drops</option>
                                        <option value="medical-devices">Medical Devices</option>
                                        <option value="supplements">Supplements</option>
                                        <option value="first-aid">First Aid</option>
                                        <option value="personal-care">Personal Care</option>
                                        <option value="baby-care">Baby Care</option>
                                        <option value="other">Other</option>
                                    </select>
                                </div>
                                <div class="edit-form-group">
                                    <label for="editDosageForm">Dosage Form</label>
                                    <select id="editDosageForm">
                                        <option value="">Select Form</option>
                                        <option value="tablet">Tablet</option>
                                        <option value="capsule">Capsule</option>
                                        <option value="syrup">Syrup</option>
                                        <option value="injection">Injection</option>
                                        <option value="cream">Cream</option>
                                        <option value="ointment">Ointment</option>
                                        <option value="gel">Gel</option>
                                        <option value="drops">Drops</option>
                                        <option value="inhaler">Inhaler</option>
                                        <option value="powder">Powder</option>
                                        <option value="suspension">Suspension</option>
                                        <option value="suppository">Suppository</option>
                                        <option value="patch">Patch</option>
                                        <option value="device">Device</option>
                                        <option value="other">Other</option>
                                    </select>
                                </div>
                            </div>
                            <div class="edit-form-row">
                                <div class="edit-form-group">
                                    <label for="editStrength">Strength</label>
                                    <input type="text" id="editStrength" placeholder="e.g., 500mg">
                                </div>
                                <div class="edit-form-group">
                                    <label for="editManufacturer">Manufacturer</label>
                                    <input type="text" id="editManufacturer">
                                </div>
                            </div>
                        </div>

                        <!-- Stock & Pricing -->
                        <div class="edit-form-section">
                            <h4>Stock & Pricing</h4>
                            <div class="edit-form-row">
                                <div class="edit-form-group">
                                    <label for="editQuantity">Quantity <span class="required">*</span></label>
                                    <input type="number" id="editQuantity" min="0" required>
                                </div>
                                <div class="edit-form-group">
                                    <label for="editUnit">Unit</label>
                                    <select id="editUnit">
                                        <option value="pieces">Pieces</option>
                                        <option value="boxes">Boxes</option>
                                        <option value="strips">Strips</option>
                                        <option value="bottles">Bottles</option>
                                        <option value="tubes">Tubes</option>
                                        <option value="vials">Vials</option>
                                        <option value="packets">Packets</option>
                                    </select>
                                </div>
                            </div>
                            <div class="edit-form-row">
                                <div class="edit-form-group">
                                    <label for="editCostPrice">Cost Price <span class="required">*</span></label>
                                    <input type="number" id="editCostPrice" min="0" step="0.01" required>
                                </div>
                                <div class="edit-form-group">
                                    <label for="editSellingPrice">Selling Price <span class="required">*</span></label>
                                    <input type="number" id="editSellingPrice" min="0" step="0.01" required>
                                </div>
                            </div>
                            <div class="edit-form-row">
                                <div class="edit-form-group">
                                    <label for="editReorderLevel">Reorder Level</label>
                                    <input type="number" id="editReorderLevel" min="0" value="10">
                                </div>
                                <div class="edit-form-group">
                                    <label for="editBarcode">Barcode</label>
                                    <input type="text" id="editBarcode" readonly>
                                </div>
                            </div>
                        </div>

                        <!-- Batch & Expiry -->
                        <div class="edit-form-section">
                            <h4>Batch & Expiry</h4>
                            <div class="edit-form-row">
                                <div class="edit-form-group">
                                    <label for="editBatchNumber">Batch Number</label>
                                    <input type="text" id="editBatchNumber">
                                </div>
                                <div class="edit-form-group">
                                    <label for="editExpiryDate">Expiry Date <span class="required">*</span></label>
                                    <input type="date" id="editExpiryDate" required>
                                </div>
                            </div>
                            <div class="edit-form-row">
                                <div class="edit-form-group">
                                    <label for="editManufactureDate">Manufacture Date</label>
                                    <input type="date" id="editManufactureDate">
                                </div>
                                <div class="edit-form-group">
                                    <label for="editLocation">Storage Location</label>
                                    <input type="text" id="editLocation" placeholder="e.g., Shelf A1">
                                </div>
                            </div>
                        </div>

                        <!-- Additional Info -->
                        <div class="edit-form-section">
                            <h4>Additional Information</h4>
                            <div class="edit-form-row">
                                <div class="edit-form-group">
                                    <label for="editSupplier">Supplier</label>
                                    <input type="text" id="editSupplier">
                                </div>
                                <div class="edit-form-group edit-form-checkbox">
                                    <label>
                                        <input type="checkbox" id="editPrescriptionRequired">
                                        Prescription Required
                                    </label>
                                </div>
                            </div>
                            <div class="edit-form-row">
                                <div class="edit-form-group full-width">
                                    <label for="editDescription">Description/Notes</label>
                                    <textarea id="editDescription" rows="2" placeholder="Additional notes..."></textarea>
                                </div>
                            </div>
                        </div>
                    </div>
                </form>
            </div>
            <div class="inventory-modal-footer">
                <button class="modal-btn modal-btn-secondary" id="cancelEditBtn">Cancel</button>
                <button class="modal-btn modal-btn-primary" id="saveEditBtn">
                    <i class="fas fa-save"></i> Save Changes
                </button>
            </div>
        </div>
    </div>

    <!-- Compose Message Modal -->
    <div class="msg-modal-overlay" id="composeMessageModal">
        <div class="msg-modal">
            <div class="msg-modal-header">
                <h3><i class="fas fa-paper-plane"></i> Compose Message</h3>
                <button class="msg-modal-close" id="closeComposeModal">&times;</button>
            </div>
            <div class="msg-modal-body">
                <div class="msg-form-group">
                    <label for="messageContent">Message</label>
                    <textarea id="messageContent" rows="4" placeholder="Type your message here..." maxlength="500"></textarea>
                    <span class="msg-char-count"><span id="charCount">0</span>/500</span>
                </div>
            </div>
            <div class="msg-modal-footer">
                <button class="msg-btn msg-btn-cancel" id="cancelComposeBtn">Cancel</button>
                <button class="msg-btn msg-btn-send" id="sendMessageBtn">
                    <i class="fas fa-paper-plane"></i> Send to All
                </button>
            </div>
        </div>
    </div>

    <!-- Firebase SDK -->
    <script type="module" src="js/firebase-config.js"></script>
    <script type="module" src="js/messages.js"></script>
    <script type="module" src="js/notifications.js"></script>
    <script type="module" src="js/all-activities.js"></script>
    <script type="module" src="js/dashboard.js"></script>
    <script type="module" src="js/sales.js"></script>
    <script type="module" src="js/all-sales.js"></script>
    <script type="module" src="js/pos-module.js"></script>
    <script type="module" src="js/prescription.js"></script>
    <script type="module" src="js/inventory.js"></script>
    <script type="module" src="js/inventory-view.js"></script>
    <script type="module" src="js/supplier.js"></script>
    <script type="module" src="js/order.js"></script>
    <script type="module" src="js/manage-orders.js"></script>
    <script type="module" src="js/customer.js"></script>
    <script type="module" src="js/manage-customers.js"></script>
    <script type="module" src="js/expense.js"></script>
    <script type="module" src="js/manage-expenses.js"></script>
    <script type="module" src="js/wholesale.js"></script>
    <script type="module" src="js/manage-wholesale.js"></script>
    <script type="module" src="js/accounts.js"></script>
    <script type="module" src="js/reports.js"></script>
    <script type="module" src="js/settings.js"></script>
    <script type="module" src="js/admin-panel.js"></script>
    <script src="js/app.js"></script>
</body>
</html>
